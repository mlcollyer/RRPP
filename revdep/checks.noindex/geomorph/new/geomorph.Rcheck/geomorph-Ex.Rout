
R version 4.3.2 (2023-10-31) -- "Eye Holes"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> pkgname <- "geomorph"
> source(file.path(R.home("share"), "R", "examples-header.R"))
> options(warn = 1)
> library('geomorph')
Loading required package: RRPP
Loading required package: rgl
Loading required package: Matrix
> 
> base::assign(".oldSearch", base::search(), pos = 'CheckExEnv')
> base::assign(".old_wd", base::getwd(), pos = 'CheckExEnv')
> cleanEx()
> nameEx("arrayspecs")
> ### * arrayspecs
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: arrayspecs
> ### Title: Convert landmark data matrix into array (p x k x n)
> ### Aliases: arrayspecs
> ### Keywords: utilities
> 
> ### ** Examples
> 
> x<-matrix(rnorm(18),nrow=3)  # Random triangles (all coordinates on same 
>  # row for each triangle)
> arrayspecs(x,3,2) 
, , 1

           [,1]        [,2]
[1,] -0.6264538  1.59528080
[2,]  0.4874291 -0.30538839
[3,] -0.6212406 -0.04493361

, , 2

           [,1]        [,2]
[1,]  0.1836433  0.32950777
[2,]  0.7383247  1.51178117
[3,] -2.2146999 -0.01619026

, , 3

           [,1]       [,2]
[1,] -0.8356286 -0.8204684
[2,]  0.5757814  0.3898432
[3,]  1.1249309  0.9438362

>  
> x2<-matrix(rnorm(18),ncol=2) # Random triangles (each landmark on its 
> # own row)
> arrayspecs(x2,3,2)
, , 1

          [,1]       [,2]
[1,] 0.8212212 -1.4707524
[2,] 0.5939013 -0.4781501
[3,] 0.9189774  0.4179416

, , 2

            [,1]       [,2]
[1,]  0.78213630  1.3586796
[2,]  0.07456498 -0.1027877
[3,] -1.98935170  0.3876716

, , 3

            [,1]        [,2]
[1,]  0.61982575 -0.05380504
[2,] -0.05612874 -1.37705956
[3,] -0.15579551 -0.41499456

> 
> 
> 
> cleanEx()
> nameEx("bilat.symmetry")
> ### * bilat.symmetry
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: bilat.symmetry
> ### Title: Analysis of bilateral symmetry
> ### Aliases: bilat.symmetry
> ### Keywords: analysis
> 
> ### ** Examples
> 
> #Example of matching symmetry
> # NOT RUN
> # data(mosquito)
> # gdf <- geomorph.data.frame(wingshape = mosquito$wingshape, 
> # ind=mosquito$ind, 
> # side=mosquito$side,
> # replicate=mosquito$replicate)
> # mosquito.sym <- bilat.symmetry(A = wingshape, ind = ind, side = side,
> # replicate = replicate, object.sym = FALSE, RRPP = TRUE, iter = 149, 
> # data = gdf)
> # summary(mosquito.sym)
> # plot(mosquito.sym, warpgrids = TRUE)
> # mosquito.sym$shape.anova # extract just the anova table on shape
> 
> # Previous example, performing GPA first
> # Y.gpa <- gpagen(mosquito$wingshape)
> # mosquito.sym2 <- bilat.symmetry(A = Y.gpa, ind = ind, side = side,
> # replicate = replicate, object.sym = FALSE, RRPP = TRUE, iter = 149, 
> # data = gdf)
> # summary(mosquito.sym2)
> # summary(mosquito.sym) # same results
> 
> #Example of object symmetry
> 
> # data(lizards)
> # gdf <- geomorph.data.frame(shape = lizards$coords, 
> # ind = lizards$ind, 
> # replicate = lizards$rep)
> # liz.sym <- bilat.symmetry(A = shape, ind = ind, rep = rep, 
> # object.sym = TRUE, 
> # land.pairs = lizards$lm.pairs, data = gdf, RRPP = TRUE, iter = 149)
> # summary(liz.sym)
> 
> # Example of object symmetry in 3D and including semilandmarks
> 
> # data(scallops)
> # gdf <- geomorph.data.frame(shape = scallops$coorddata, 
> # ind = scallops$ind)
> # scallop.sym <- bilat.symmetry(A = shape, ind = ind, 
> # object.sym = TRUE, 
> # curves= scallops$curvslide, surfaces = scallops$surfslide,
> # land.pairs=scallops$land.pairs, data = gdf, RRPP = TRUE, iter = 149)
> # summary(scallop.sym)
> # NOTE one can also: plot(scallop.sym, warpgrids = TRUE, mesh = NULL)
> # NOTE one can also: scallop.sym$data.type # recall the symmetry type
> 
> 
> 
> cleanEx()
> nameEx("combine.subsets")
> ### * combine.subsets
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: combine.subsets
> ### Title: Combine separate landmark configurations
> ### Aliases: combine.subsets
> ### Keywords: utilities
> 
> ### ** Examples
> 
> # NOT RUN
> # data(larvalMorph) 
> # head.gpa <- gpagen(larvalMorph$headcoords, 
> #   curves = larvalMorph$head.sliders)
> # tail.gpa <- gpagen(larvalMorph$tailcoords, 
>  # curves = larvalMorph$tail.sliders)
> 
> # Combine original data without GPA (plot to see relative size of  
> # heads and tails)
> 
>  # all.lm <- combine.subsets(head = larvalMorph$headcoords,
>  # tail = larvalMorph$tailcoords, gpa = FALSE, CS.sets = NULL)
>  # plotAllSpecimens((all.lm$coords))
>  
>  # Combine with GPA and relative centroid size
>  
> # comb.lm <- combine.subsets(head = head.gpa, tail = tail.gpa, gpa = TRUE)
> # summary(comb.lm)
> 
> # (configurations are actual relative size)
> # comb.lm$coords[,,1]
> 
> # Plot all specimens and just first specimen and color code landmarks 
> # par(mfrow = c(1,2))
> # plotAllSpecimens(comb.lm$coords)
> # plot(comb.lm$coords[,,1], pch = 21, bg = c(rep(1,26), 
> # rep(2,64)), asp = 1)
> 
> # Override relative centroid size
> 
> # comb.lm <- combine.subsets(head = head.gpa$coords, 
> # tail = tail.gpa$coords, gpa = FALSE, CS.sets = NULL)
> # par(mfrow = c(1,2))
> # plotAllSpecimens(comb.lm$coords)
> # plot(comb.lm$coords[,,1], pch = 21, bg = c(rep(1,26), 
> # rep(2,64)), asp = 1)
> 
> # Note the head is as large as the tail, which is quite unnatural.
> 
> ## Normalizing centroid size
> 
> # comb.lm <- combine.subsets(head = head.gpa, 
> # tail = tail.gpa, gpa = TRUE, norm.CS = TRUE)
> # summary(comb.lm)
> # par(mfrow = c(1,2))
> # plotAllSpecimens(comb.lm$coords)
> # plot(comb.lm$coords[,,1], pch = 21, bg = c(rep(1,26), 
> # rep(2,64)), asp = 1)
> # par(mfrow = c(1,1))
> 
> # Note that the head is too large, compared to a real specimen.  
> # This option focuses on average distance of points to centroid, 
> # but ignores the number of landmarks.  
> # Consequently,the density of landmarks in the head and tail are 
> # irrelevant and the head size is inflated because of the fewer 
> # landmarks in the configuration.
> 
> ## Weighting centroid size
> 
> # comb.lm <- combine.subsets(head = head.gpa, 
> # tail = tail.gpa, gpa = TRUE, norm.CS = FALSE, weights = c(0.3, 0.7))
> # summary(comb.lm)
> # par(mfrow = c(1,2))
> # plotAllSpecimens(comb.lm$coords)
> # plot(comb.lm$coords[,,1], pch = 21, bg = c(rep(1,26), 
> # rep(2,64)), asp = 1)
> # par(mfrow = c(1,1))
> 
> # Note that the head is way too small, compared to a real specimen.  
> # This option allows one to dictate the relative sizes of subsets
> #  as portions of the combined set.  An option like this should be 
> # used with caution, but can help overcome issues caused by landmark 
> # density.
> 
> 
> 
> cleanEx()
> nameEx("compare.CR")
> ### * compare.CR
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: compare.CR
> ### Title: Comparisons of Effect Sizes from Modularity Analyses
> ### Aliases: compare.CR
> ### Keywords: analysis
> 
> ### ** Examples
> 
> 
> #NOT RUN
> # Example 1: Compare modular signal across datasets
>  
> # data(pupfish) 
> # Y.gpa<-gpagen(pupfish$coords, print.progress = FALSE)    #GPA-alignment   
>  
> ## landmarks on the body and operculum
> # land.gps<-rep('a',56); land.gps[39:48]<-'b'
> 
> # group <- factor(paste(pupfish$Pop, pupfish$Sex, sep = "."))
> # levels(group)
> 
> # coords.gp <- coords.subset(Y.gpa$coords, group)
> 
> # modul.tests <- Map(function(x) modularity.test(x, land.gps,iter=999, 
> # print.progress = FALSE), coords.gp) 
>          
> # the map function performs the integration test on each 3D array 
> # in the lists provided
> 
> #  modul.tests$Marsh.F
> #  modul.tests$Marsh.M
> #  modul.tests$Sinkhole.F
> #  modul.tests$Sinkhole.M
> 
> # group.Z <- compare.CR(modul.tests, CR.null = FALSE)
> # summary(group.Z)
> 
> # Example 2: Compare alternative modular hypotheses
> 
> # 3 module hypothesis (tail now a module)
> # land.gps3 <- rep('a',56); land.gps3[39:48]<-'b'; 
> # land.gps3[c(6:9,28:38)] <- 'c' 
>    
> # 4 module hypothesis (eye now a module)
> # land.gps4 <- rep('a',56); land.gps4[39:48]<-'b'; 
> # land.gps4[c(6:9,28:38)] <- 'c'; 
> #  land.gps4[c(10,49:56)] <- 'd'  
> 
> # m3.test <- modularity.test(coords.gp$Marsh.F,land.gps3, iter = 499, 
> # print.progress = FALSE)
> # m4.test <- modularity.test(coords.gp$Marsh.F,land.gps4, iter = 499, 
> # print.progress = FALSE)
> 
> # model.Z <- compare.CR(modul.tests$Marsh.F,m3.test,m4.test, 
> # CR.null = TRUE)
> # summary(model.Z)
> 
> 
> 
> 
> cleanEx()
> nameEx("compare.ZVrel")
> ### * compare.ZVrel
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: compare.ZVrel
> ### Title: Comparisons of Effect Sizes from Overall Integration Analyses
> ### Aliases: compare.ZVrel
> ### Keywords: analysis
> 
> ### ** Examples
> 
>  
>  data("plethodon")
>  Y.gpa <- gpagen(plethodon$land)

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
>  
>  coords.gp <- coords.subset(Y.gpa$coords, plethodon$species)
>  Vrel.gp <- Map(function(x) integration.Vrel(x), coords.gp) 
>  
>  out <- compare.ZVrel(Vrel.gp$Jord, Vrel.gp$Teyah)
>  
>  summary(out)

Effect sizes

 Vrel.gp$Jord Vrel.gp$Teyah 
   -0.2978931    -0.2642648 

Effect sizes for pairwise differences in rel.eig effect size

              Vrel.gp$Jord Vrel.gp$Teyah
Vrel.gp$Jord    0.00000000    0.09804249
Vrel.gp$Teyah   0.09804249    0.00000000

P-values

              Vrel.gp$Jord Vrel.gp$Teyah
Vrel.gp$Jord     1.0000000     0.9218986
Vrel.gp$Teyah    0.9218986     1.0000000
>  
> 
> 
> 
> cleanEx()
> nameEx("compare.evol.rates")
> ### * compare.evol.rates
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: compare.evol.rates
> ### Title: Comparing net rates of shape evolution on phylogenies
> ### Aliases: compare.evol.rates
> ### Keywords: analysis
> 
> ### ** Examples
> 
> data(plethspecies) 
> Y.gpa<-gpagen(plethspecies$land)    #GPA-alignment    

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
>  gp.end<-factor(c(0,0,1,0,0,1,1,0,0))  #endangered species vs. rest
>  names(gp.end)<-plethspecies$phy$tip
> 
> ER<-compare.evol.rates(A=Y.gpa$coords, phy=plethspecies$phy,
+   method="simulation",gp=gp.end,iter=999)
  |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%
> summary(ER)

Call:


Observed Rate Ratio: 1.8372

P-value: 0.124

Effect Size: 1.2768

Based on 1000 random permutations

The rate for group 0 is 1.79641730182344e-06  

The rate for group 1 is 3.30041132572866e-06 > plot(ER)
> 
> 
> 
> cleanEx()
> nameEx("compare.multi.evol.rates")
> ### * compare.multi.evol.rates
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: compare.multi.evol.rates
> ### Title: Comparing net rates of evolution among traits on phylogenies
> ### Aliases: compare.multi.evol.rates
> ### Keywords: analysis
> 
> ### ** Examples
> 
> 
> data(plethspecies) 
> Y.gpa<-gpagen(plethspecies$land)    #GPA-alignment    

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> land.gp<-c("A","A","A","A","A","B","B","B","B","B","B")  
>     #mandible and cranium subsets
> 
> EMR<-compare.multi.evol.rates(A=Y.gpa$coords,gp=land.gp, 
+     Subset=TRUE, phy= plethspecies$phy,iter=999)
  |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%
> summary(EMR)

Call:


Observed Rate Ratio: 1.2997

P-value: 0.471

Effect Size: 0.0986

Based on 1000 random permutations

The rate for group A is 1.97486252507009e-06  

The rate for group B is 2.5668204081711e-06 > plot(EMR)
> 
> 
> 
> cleanEx()
> nameEx("compare.physignal.z")
> ### * compare.physignal.z
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: compare.physignal.z
> ### Title: Comparisons of Phylogenetic Signal Effect Sizes
> ### Aliases: compare.physignal.z
> ### Keywords: analysis
> 
> ### ** Examples
> 
> 
> # Example: Compare phylogenetic signal of head components in Plethodon
> 
> data(plethspecies) 
> Y.gpa<-gpagen(plethspecies$land)    #GPA-alignment

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> 
> ## landmarks of the jaw and cranium
> jaw <- 1:5
> cranium <- 6:11
> 
> PS.jaw <- physignal.z(A = Y.gpa$coords[jaw,,], phy = plethspecies$phy, 
+ lambda = "front", PAC.no = 7, iter=999)
> 
> PS.cranium <- physignal.z(A = Y.gpa$coords[cranium,,], phy = plethspecies$phy, 
+ lambda = "front", PAC.no = 7, iter=999)
> 
> PS.list <-list(PS.jaw, PS.cranium)
> names(PS.list) <- c("jaw", "cranium")
> 
> PS.Z <- compare.physignal.z(PS.list)
> summary(PS.Z)

Effect sizes (Z-scores)

     jaw  cranium 
1.624806 1.684868 

Effect sizes for pairwise differences in phylogenetic signal.

              jaw   cranium
jaw     0.0000000 0.2890467
cranium 0.2890467 0.0000000

P-values

              jaw   cranium
jaw     1.0000000 0.7725457
cranium 0.7725457 1.0000000
> 
> 
> 
> 
> cleanEx()
> nameEx("compare.pls")
> ### * compare.pls
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: compare.pls
> ### Title: Comparisons of Effect Sizes from Partial Least Squares
> ### Aliases: compare.pls
> ### Keywords: analysis
> 
> ### ** Examples
> 
> # Example of comparative morphological integration between pupfish head 
> # and body shapes
> 
>  data(pupfish) # GPA previously performed
>   
>  group <- factor(paste(pupfish$Pop, pupfish$Sex, sep = "."))
>  levels(group)
[1] "Marsh.F"    "Marsh.M"    "Sinkhole.F" "Sinkhole.M"
>   
>  tail.LM <- c(1:3, 5:9, 18:38)
>  head.LM <- (1:56)[-tail.LM]
> 
>  tail.coords <- pupfish$coords[tail.LM,,]
>  head.coords <- pupfish$coords[head.LM,,]
>  
>  # Subset 3D array by group, returning a list of 3D arrays
>  tail.coords.gp <- coords.subset(tail.coords, group)
>  head.coords.gp <- coords.subset(head.coords, group)
> 
>  integ.tests <- Map(function(x,y) integration.test(x, y, iter=499, 
+  print.progress = FALSE), head.coords.gp, tail.coords.gp)
> # the map function performs the integration test on each 3D array in 
> # the lists provided
> 
>  integ.tests$Marsh.F

Call:
integration.test(A = x, A2 = y, iter = 499, print.progress = FALSE) 



r-PLS: 0.92

Effect Size (Z): 3.141

P-value: 0.002

Based on 500 random permutations
>  integ.tests$Marsh.M

Call:
integration.test(A = x, A2 = y, iter = 499, print.progress = FALSE) 



r-PLS: 0.79

Effect Size (Z): 1.513

P-value: 0.07

Based on 500 random permutations
>  integ.tests$Sinkhole.F

Call:
integration.test(A = x, A2 = y, iter = 499, print.progress = FALSE) 



r-PLS: 0.76

Effect Size (Z): 0.743

P-value: 0.252

Based on 500 random permutations
>  integ.tests$Sinkhole.M

Call:
integration.test(A = x, A2 = y, iter = 499, print.progress = FALSE) 



r-PLS: 0.91

Effect Size (Z): 2.716

P-value: 0.004

Based on 500 random permutations
> 
>  group.Z <- compare.pls(integ.tests)
>  summary(group.Z)

Effect sizes

   Marsh.F    Marsh.M Sinkhole.F Sinkhole.M 
 3.1410345  1.5130737  0.7429882  2.7156556 

Effect sizes for pairwise differences in PLS effect size

             Marsh.F   Marsh.M Sinkhole.F Sinkhole.M
Marsh.F    0.0000000 0.6586628  1.9027247  0.7518767
Marsh.M    0.6586628 0.0000000  0.8778808  1.1927859
Sinkhole.F 1.9027247 0.8778808  0.0000000  2.0927712
Sinkhole.M 0.7518767 1.1927859  2.0927712  0.0000000

P-values

              Marsh.F   Marsh.M Sinkhole.F Sinkhole.M
Marsh.F    1.00000000 0.5101123 0.05707647 0.45212519
Marsh.M    0.51011230 1.0000000 0.38000838 0.23295324
Sinkhole.F 0.05707647 0.3800084 1.00000000 0.03636958
Sinkhole.M 0.45212519 0.2329532 0.03636958 1.00000000
> 
>  # Sexual dimorphism in morphological integration in one population
>  # but not the other
> 
>  # can also list different PLS analyses, separately
> 
>  compare.pls(MF = integ.tests$Marsh.F, MM = integ.tests$Marsh.M)

Effect sizes

      MF       MM 
3.141035 1.513074 

Effect sizes for pairwise differences in PLS effect size

          MF        MM
MF 0.0000000 0.6586628
MM 0.6586628 0.0000000

P-values

          MF        MM
MF 1.0000000 0.5101123
MM 0.5101123 1.0000000
> 
> 
> 
> 
> cleanEx()
> nameEx("coords.subset")
> ### * coords.subset
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: coords.subset
> ### Title: Subset landmark coordinates via a factor
> ### Aliases: coords.subset
> ### Keywords: utilities
> 
> ### ** Examples
> 
> data(pupfish) 
> group <- factor(paste(pupfish$Pop, pupfish$Sex))
> levels(group)
[1] "Marsh F"    "Marsh M"    "Sinkhole F" "Sinkhole M"
> new.coords <- coords.subset(A = pupfish$coords, group = group)
> names(new.coords) # see the list levels
[1] "Marsh F"    "Marsh M"    "Sinkhole F" "Sinkhole M"
> # group shape means
> lapply(new.coords, mshape)
$`Marsh F`
              [,1]          [,2]
 [1,] -0.036294242 -0.0679443538
 [2,] -0.039057429 -0.0371420901
 [3,]  0.099048079 -0.0661928367
 [4,] -0.175052108  0.0004715517
 [5,]  0.040550735  0.0536580991
 [6,]  0.165215338  0.0273059678
 [7,]  0.229413406  0.0209667222
 [8,]  0.229474512 -0.0456403969
 [9,]  0.140600252 -0.0516313039
[10,] -0.132042793 -0.0005377255
[11,] -0.161025824  0.0098325777
[12,] -0.148521266  0.0174386459
[13,] -0.134697146  0.0246232213
[14,] -0.120026613  0.0302320132
[15,] -0.105181295  0.0357705108
[16,] -0.090332161  0.0405299636
[17,] -0.074441844  0.0448550689
[18,] -0.058525213  0.0488412238
[19,] -0.042328220  0.0516584634
[20,] -0.025581231  0.0535344070
[21,] -0.007739643  0.0546775621
[22,]  0.010220163  0.0547472017
[23,]  0.027637034  0.0543976831
[24,]  0.058003001  0.0487634355
[25,]  0.073357959  0.0444630550
[26,]  0.088547401  0.0403269567
[27,]  0.103545745  0.0366035510
[28,]  0.118560287  0.0331896213
[29,]  0.133797806  0.0304638582
[30,]  0.149168525  0.0288294049
[31,]  0.179789810  0.0255634204
[32,]  0.195154219  0.0234704261
[33,]  0.211072744  0.0215813806
[34,]  0.214292835 -0.0447358628
[35,]  0.200727571 -0.0453307066
[36,]  0.187055467 -0.0469827994
[37,]  0.172480844 -0.0486877147
[38,]  0.157363865 -0.0503692422
[39,] -0.053524002 -0.0014091053
[40,] -0.050638962 -0.0129003723
[41,] -0.052061459 -0.0261393219
[42,] -0.058340207 -0.0391886168
[43,] -0.066055301 -0.0505509016
[44,] -0.075163878 -0.0597236155
[45,] -0.085500622 -0.0666617077
[46,] -0.096516316 -0.0689598451
[47,] -0.108280599 -0.0676359900
[48,] -0.131157880 -0.0587747433
[49,] -0.132076186  0.0168880338
[50,] -0.119563586  0.0148077415
[51,] -0.111312137  0.0032175483
[52,] -0.116183449 -0.0123691722
[53,] -0.133092190 -0.0207459089
[54,] -0.148340936 -0.0144955519
[55,] -0.152537000  0.0005088135
[56,] -0.143885856  0.0125317550
attr(,"class")
[1] "mshape" "matrix"

$`Marsh M`
              [,1]          [,2]
 [1,] -0.044248596 -7.475344e-02
 [2,] -0.043708947 -4.269744e-02
 [3,]  0.094303465 -7.552006e-02
 [4,] -0.171655454 -1.886440e-03
 [5,]  0.035024268  6.312421e-02
 [6,]  0.162667473  2.883184e-02
 [7,]  0.226387124  1.933801e-02
 [8,]  0.221424345 -5.204006e-02
 [9,]  0.137620021 -5.787681e-02
[10,] -0.131437368 -3.316185e-04
[11,] -0.159057340  7.315518e-03
[12,] -0.146787421  1.484839e-02
[13,] -0.133215379  2.189256e-02
[14,] -0.119458519  2.899678e-02
[15,] -0.105031625  3.519940e-02
[16,] -0.090722899  4.117041e-02
[17,] -0.075351767  4.723056e-02
[18,] -0.059886129  5.272400e-02
[19,] -0.044014539  5.791889e-02
[20,] -0.026984315  6.141967e-02
[21,] -0.008635649  6.397797e-02
[22,]  0.009876092  6.438998e-02
[23,]  0.027549214  6.374402e-02
[24,]  0.059726657  5.735201e-02
[25,]  0.075089351  5.271969e-02
[26,]  0.090052052  4.798612e-02
[27,]  0.104552138  4.310567e-02
[28,]  0.119137681  3.875404e-02
[29,]  0.133833469  3.478374e-02
[30,]  0.148720926  3.153929e-02
[31,]  0.178790417  2.568338e-02
[32,]  0.193936332  2.285566e-02
[33,]  0.209793420  2.048980e-02
[34,]  0.212819844 -5.129412e-02
[35,]  0.199848186 -5.132875e-02
[36,]  0.186509337 -5.214971e-02
[37,]  0.172009644 -5.357741e-02
[38,]  0.157046235 -5.492588e-02
[39,] -0.051510893 -7.070229e-03
[40,] -0.050204778 -1.291109e-02
[41,] -0.050997481 -2.630158e-02
[42,] -0.057268924 -3.959702e-02
[43,] -0.064374107 -5.125926e-02
[44,] -0.072541970 -6.208066e-02
[45,] -0.083915991 -6.968693e-02
[46,] -0.096107964 -7.319920e-02
[47,] -0.109192980 -7.150773e-02
[48,] -0.111777628 -6.964715e-02
[49,] -0.131495358  1.679980e-02
[50,] -0.119945854  1.379317e-02
[51,] -0.111518595  3.183050e-03
[52,] -0.116592979 -1.182340e-02
[53,] -0.132940987 -1.743677e-02
[54,] -0.145074496 -1.190629e-02
[55,] -0.148382983  8.054127e-05
[56,] -0.142677776  1.156085e-02
attr(,"class")
[1] "mshape" "matrix"

$`Sinkhole F`
              [,1]          [,2]
 [1,] -0.037319740 -0.0664464081
 [2,] -0.040863874 -0.0307782727
 [3,]  0.102366795 -0.0684260588
 [4,] -0.175741201 -0.0058317009
 [5,]  0.046478836  0.0562935594
 [6,]  0.165384484  0.0242702866
 [7,]  0.229782475  0.0167585792
 [8,]  0.227131787 -0.0452311577
 [9,]  0.138394944 -0.0493907014
[10,] -0.135193085 -0.0005326953
[11,] -0.158929700  0.0082455786
[12,] -0.147224433  0.0167519682
[13,] -0.133321717  0.0232946814
[14,] -0.118938488  0.0291947801
[15,] -0.103931356  0.0341884057
[16,] -0.089049563  0.0386431797
[17,] -0.073372482  0.0437037536
[18,] -0.057584949  0.0477324615
[19,] -0.041567080  0.0511321349
[20,] -0.024844879  0.0537609112
[21,] -0.007060716  0.0565417426
[22,]  0.010852936  0.0577347062
[23,]  0.028286768  0.0577438868
[24,]  0.059412347  0.0526009986
[25,]  0.074530683  0.0474055533
[26,]  0.089480867  0.0425393038
[27,]  0.104274694  0.0379996130
[28,]  0.118974323  0.0337035248
[29,]  0.133959288  0.0297233284
[30,]  0.149200742  0.0269140286
[31,]  0.179502582  0.0217285200
[32,]  0.194784576  0.0191539803
[33,]  0.210946132  0.0168161228
[34,]  0.214501968 -0.0444817162
[35,]  0.200996188 -0.0445732052
[36,]  0.187265705 -0.0451861463
[37,]  0.172608678 -0.0461269016
[38,]  0.157392569 -0.0474189259
[39,] -0.059787113 -0.0008709143
[40,] -0.057676492 -0.0129230964
[41,] -0.059179943 -0.0238238901
[42,] -0.064057581 -0.0359959179
[43,] -0.070023056 -0.0476631604
[44,] -0.076631013 -0.0578755423
[45,] -0.085537338 -0.0658013897
[46,] -0.095972766 -0.0701037580
[47,] -0.108468834 -0.0704812080
[48,] -0.112050582 -0.0687498126
[49,] -0.130549479  0.0185423654
[50,] -0.119949522  0.0140312836
[51,] -0.113821651  0.0030193801
[52,] -0.116698811 -0.0110467534
[53,] -0.132425366 -0.0202119930
[54,] -0.149846390 -0.0163209229
[55,] -0.154044081  0.0012654669
[56,] -0.144847085  0.0148581636
attr(,"class")
[1] "mshape" "matrix"

$`Sinkhole M`
              [,1]          [,2]
 [1,] -0.040623602 -0.0734975345
 [2,] -0.042737365 -0.0373902050
 [3,]  0.101456221 -0.0726947839
 [4,] -0.173644115 -0.0055967069
 [5,]  0.043053820  0.0611183513
 [6,]  0.162205160  0.0260398540
 [7,]  0.229761463  0.0144959751
 [8,]  0.225636069 -0.0494633874
 [9,]  0.140904622 -0.0511558056
[10,] -0.131481254  0.0006833620
[11,] -0.158599621  0.0064927096
[12,] -0.147036687  0.0150657768
[13,] -0.133845194  0.0226741843
[14,] -0.119264017  0.0276094073
[15,] -0.104274873  0.0325407714
[16,] -0.089505889  0.0373931488
[17,] -0.074111411  0.0432853044
[18,] -0.058843890  0.0488913697
[19,] -0.043058350  0.0536451711
[20,] -0.026555153  0.0576891589
[21,] -0.008656063  0.0615361415
[22,]  0.009792012  0.0626320903
[23,]  0.027500832  0.0621575391
[24,]  0.059809374  0.0573769290
[25,]  0.075095756  0.0521964850
[26,]  0.089841467  0.0470711215
[27,]  0.104213838  0.0417696381
[28,]  0.118707226  0.0370920762
[29,]  0.133418277  0.0328093817
[30,]  0.148292417  0.0290830558
[31,]  0.178288821  0.0229988192
[32,]  0.193277323  0.0193224250
[33,]  0.209275002  0.0162024708
[34,]  0.213021032 -0.0488565349
[35,]  0.199824787 -0.0483970178
[36,]  0.186279563 -0.0486409461
[37,]  0.171757499 -0.0489564679
[38,]  0.156672788 -0.0496775197
[39,] -0.056100304 -0.0005509176
[40,] -0.053953229 -0.0130494623
[41,] -0.055802111 -0.0248851687
[42,] -0.061530263 -0.0373980515
[43,] -0.068336247 -0.0489808743
[44,] -0.075737290 -0.0592281541
[45,] -0.085086818 -0.0675852844
[46,] -0.096147803 -0.0722754376
[47,] -0.109190921 -0.0713809836
[48,] -0.111267679 -0.0695152943
[49,] -0.132214800  0.0195788132
[50,] -0.117386518  0.0174956293
[51,] -0.109643939  0.0031360308
[52,] -0.116418867 -0.0122428497
[53,] -0.133045220 -0.0189746429
[54,] -0.147161160 -0.0136407175
[55,] -0.151734490  0.0003045998
[56,] -0.145090230  0.0136469575
attr(,"class")
[1] "mshape" "matrix"

> 
> 
> 
> 
> cleanEx()
> nameEx("define.sliders")
> ### * define.sliders
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: define.sliders
> ### Title: Select points to "slide" along curves
> ### Aliases: define.sliders
> ### Keywords: utilities
> 
> ### ** Examples
> 
>  
> ## (not run) Use interactive function in rgl window
>  # data(scallops)
>  # define.sliders(scallops$coorddata[,,1], nsliders=11,
>  #   surfsliders = scallops$surfslide) 
>  # here the first specimen is used for plotting purposes only
>  
> ## Examples of AUTO mode 
>  ## 1 curve of sliding semilandmark
>  # Define sliders for scallopdata
>  #sliders = define.sliders(c(5:16,1))
> 
>  ## 2 curves of sliding semilandmarks
>  # Define sliders for 10 landmarks, where LMs 1, 5, and 10 fixed
>  # 2, 3, and 4 are along a curve between 1 and 5
>  # and 6, 7, 8, and 9 are along a curve between 5 and 10.
>  #sliders = rbind(define.sliders(1:5), define.sliders(5:10)) 
> 
> 
> 
> cleanEx()
> nameEx("estimate.missing")
> ### * estimate.missing
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: estimate.missing
> ### Title: Estimate locations of missing landmarks
> ### Aliases: estimate.missing
> ### Keywords: utilities
> 
> ### ** Examples
> 
> data(plethodon)
> plethland<-plethodon$land
>   plethland[3,,2]<-plethland[8,,2]<-NA  #create missing landmarks
>   plethland[3,,5]<-plethland[8,,5]<-plethland[9,,5]<-NA  
>   plethland[3,,10]<-NA  
>   
> estimate.missing(plethland,method="TPS")
, , 1

          [,1]     [,2]
 [1,]  8.89372 53.77644
 [2,]  9.26840 52.77072
 [3,]  5.56104 54.21028
 [4,]  1.87340 52.75100
 [5,]  1.28180 53.18484
 [6,]  1.24236 53.32288
 [7,]  0.84796 54.70328
 [8,]  3.35240 55.76816
 [9,]  6.29068 55.70900
[10,]  8.87400 55.25544
[11,] 10.74740 55.43292
[12,] 14.39560 52.75100

, , 2

           [,1]     [,2]
 [1,]  8.679762 54.57819
 [2,]  8.935628 53.83027
 [3,]  5.710713 54.47421
 [4,]  1.987882 52.68871
 [5,]  1.515514 53.02331
 [6,]  1.338376 53.22013
 [7,]  1.239966 54.44041
 [8,]  2.971883 55.68053
 [9,]  6.219512 55.99529
[10,]  8.758490 56.01497
[11,] 10.903828 55.83783
[12,] 14.033266 53.86963

, , 3

           [,1]     [,2]
 [1,]  9.805328 56.06903
 [2,] 10.137712 55.27961
 [3,]  6.647680 55.73664
 [4,]  3.448484 53.86698
 [5,]  3.012230 54.34478
 [6,]  2.825264 54.57330
 [7,]  2.721394 55.73664
 [8,]  4.549506 56.79612
 [9,]  7.520188 57.35701
[10,]  9.846876 57.25314
[11,] 11.986598 57.23237
[12,] 14.749540 55.11342

, , 4

           [,1]     [,2]
 [1,]  9.637164 58.03294
 [2,]  9.952104 56.77318
 [3,]  6.109836 57.94896
 [4,]  2.645496 55.89135
 [5,]  2.015616 56.62621
 [6,]  1.721672 57.21410
 [7,]  1.868644 58.51585
 [8,]  3.632308 59.48167
 [9,]  6.865692 59.92258
[10,]  9.763140 59.56565
[11,] 11.883736 59.46067
[12,] 15.369072 56.56322

, , 5

           [,1]     [,2]
 [1,] 11.035692 58.75009
 [2,] 11.335110 57.85183
 [3,]  8.470849 58.86529
 [4,]  4.555431 57.46687
 [5,]  3.956595 58.08709
 [6,]  3.871047 58.40790
 [7,]  3.871047 59.58418
 [8,]  5.828429 60.47664
 [9,]  9.198300 60.35732
[10,] 11.420658 59.94776
[11,] 12.768039 59.88360
[12,] 15.847767 57.46687

, , 6

           [,1]     [,2]
 [1,]  7.946625 55.71114
 [2,]  8.476400 54.82112
 [3,]  4.979885 54.90588
 [4,]  2.479347 52.85035
 [5,]  2.076718 53.10465
 [6,]  1.737662 53.14703
 [7,]  1.335033 54.20658
 [8,]  2.712448 55.54161
 [9,]  5.382514 56.60116
[10,]  7.861861 56.96141
[11,]  9.663096 57.49118
[12,] 13.138420 55.75352

, , 7

           [,1]     [,2]
 [1,]  8.849841 58.66961
 [2,]  9.396387 57.82877
 [3,]  5.990985 58.31225
 [4,]  2.501499 56.84078
 [5,]  2.102100 57.28223
 [6,]  1.933932 57.47141
 [7,]  1.975974 58.43838
 [8,]  3.741738 59.34228
 [9,]  6.642636 59.72066
[10,]  8.849841 59.82577
[11,] 10.951941 59.48943
[12,] 13.579566 57.89183

, , 8

           [,1]     [,2]
 [1,]  9.331504 56.36904
 [2,] 10.154872 55.31344
 [3,]  6.671392 56.62238
 [4,]  2.195648 55.08121
 [5,]  1.688960 55.79902
 [6,]  1.520064 56.28459
 [7,]  1.583400 57.34019
 [8,]  3.715712 58.22690
 [9,]  7.241416 58.26912
[10,]  9.774856 57.88910
[11,] 11.949392 57.59354
[12,] 15.432872 54.70119

, , 9

           [,1]     [,2]
 [1,]  9.840795 58.49453
 [2,] 10.179403 57.37289
 [3,]  6.031455 58.49453
 [4,]  2.624212 57.05545
 [5,]  2.137463 57.35173
 [6,]  1.566062 57.71150
 [7,]  1.693040 58.98128
 [8,]  3.745851 60.06059
 [9,]  7.110768 60.14525
[10,] 10.073588 60.12408
[11,] 11.787791 59.89129
[12,] 15.131545 57.41522

, , 10

           [,1]     [,2]
 [1,]  9.563510 56.51739
 [2,]  9.900550 55.50627
 [3,]  6.128195 56.33379
 [4,]  1.811590 54.45303
 [5,]  1.369225 55.02178
 [6,]  1.221770 55.54841
 [7,]  1.200705 56.87550
 [8,]  3.265075 57.88662
 [9,]  6.551215 58.05514
[10,]  9.437120 57.97088
[11,] 11.627880 57.52851
[12,] 15.419580 55.08497

, , 11

           [,1]     [,2]
 [1,]  8.211782 57.04143
 [2,]  8.337794 55.52929
 [3,]  4.830460 59.47766
 [4,]  0.336032 60.90580
 [5,]  0.462044 61.68287
 [6,]  0.378036 62.18692
 [7,]  1.176112 63.19502
 [8,]  4.053386 62.58596
 [9,]  6.993666 60.56977
[10,]  9.765930 58.61658
[11,] 11.803124 57.29346
[12,] 15.016430 53.55510

, , 12

           [,1]     [,2]
 [1,]  8.691998 54.71960
 [2,]  9.660114 53.56207
 [3,]  5.240454 55.43516
 [4,]  1.641588 54.76169
 [5,]  0.926024 55.37203
 [6,]  0.610334 55.85608
 [7,]  0.926024 57.09780
 [8,]  3.220038 57.72918
 [9,]  6.503214 57.11884
[10,]  9.533838 56.46642
[11,] 11.449024 56.48746
[12,] 15.889730 54.13031

, , 13

           [,1]     [,2]
 [1,] 10.707338 61.44578
 [2,] 11.724882 60.26636
 [3,]  7.030304 61.28390
 [4,]  2.890750 59.13318
 [5,]  2.220096 59.78071
 [6,]  2.058214 60.10447
 [7,]  2.127592 61.49203
 [8,]  4.393940 62.85647
 [9,]  7.932218 63.11085
[10,] 11.216110 63.29586
[11,] 13.228072 63.85089
[12,] 18.500800 63.06460

, , 14

           [,1]     [,2]
 [1,]  8.470779 53.32874
 [2,]  9.155484 52.66360
 [3,]  6.397101 53.21136
 [4,]  4.460364 52.42884
 [5,]  4.166919 52.76141
 [6,]  3.990852 53.21136
 [7,]  4.264734 54.07213
 [8,]  5.164632 54.50252
 [9,]  7.453503 54.32645
[10,]  8.842476 54.34601
[11,]  9.820626 54.26776
[12,] 12.735513 53.48524

, , 15

           [,1]     [,2]
 [1,] 11.532672 74.42845
 [2,] 12.226768 72.61312
 [3,]  7.635056 75.04246
 [4,]  2.776384 73.92122
 [5,]  2.322552 74.32166
 [6,]  1.681848 74.82889
 [7,]  2.215768 76.40395
 [8,]  4.965456 77.36501
 [9,]  9.396992 76.99126
[10,] 12.280160 76.59082
[11,] 14.389144 76.27047
[12,] 19.488080 73.89453

, , 16

           [,1]     [,2]
 [1,]  8.919900 55.17745
 [2,]  9.675468 53.01569
 [3,]  5.561820 55.57622
 [4,]  0.797544 54.17003
 [5,]  0.482724 54.98856
 [6,]  0.272844 55.49227
 [7,]  0.524700 56.81452
 [8,]  3.022272 57.63305
 [9,]  6.737148 57.27625
[10,]  9.864360 56.98242
[11,] 11.984148 56.45772
[12,] 16.454592 54.75769

, , 17

           [,1]     [,2]
 [1,]  9.914553 55.94491
 [2,] 10.459539 55.16935
 [3,]  7.524999 55.94491
 [4,]  5.009679 55.10647
 [5,]  4.716225 55.48377
 [6,]  4.527576 55.86107
 [7,]  4.527576 56.55278
 [8,]  5.743314 57.43314
 [9,]  8.405361 57.34930
[10,] 10.124163 57.22353
[11,] 11.738160 57.22353
[12,] 14.484051 56.04971

, , 18

           [,1]     [,2]
 [1,] 10.661782 62.89986
 [2,] 11.616221 61.66607
 [3,]  6.867305 63.76118
 [4,]  2.677085 62.24805
 [5,]  2.025273 62.80674
 [6,]  1.489856 63.36544
 [7,]  1.839041 64.78546
 [8,]  4.283336 65.83301
 [9,]  8.566672 65.55366
[10,] 11.616221 64.92513
[11,] 13.874284 64.76218
[12,] 18.623200 62.87658

, , 19

           [,1]     [,2]
 [1,]  8.313908 51.34480
 [2,]  9.735764 50.02168
 [3,]  4.838260 51.38430
 [4,]  1.303368 49.98219
 [5,]  0.710928 50.57463
 [6,]  0.572692 51.04858
 [7,]  0.829416 52.23346
 [8,]  2.784468 53.28010
 [9,]  6.516840 53.35910
[10,]  9.419796 53.26036
[11,] 11.098376 53.14187
[12,] 15.818148 51.44354

, , 20

           [,1]     [,2]
 [1,]  8.506270 57.07500
 [2,]  9.813331 55.99615
 [3,]  5.912895 57.30321
 [4,]  1.514531 56.24512
 [5,]  1.161832 56.84678
 [6,]  0.871374 57.19948
 [7,]  1.286314 58.36131
 [8,]  3.651472 59.00447
 [9,]  6.929498 59.08746
[10,]  9.979307 58.65177
[11,] 11.888031 58.77625
[12,] 16.556106 56.95052

, , 21

           [,1]     [,2]
 [1,] 10.310018 55.68670
 [2,] 11.086944 54.67879
 [3,]  7.895248 55.77069
 [4,]  4.388582 54.51081
 [5,]  3.884630 54.80478
 [6,]  3.569660 55.09875
 [7,]  3.548662 56.10666
 [8,]  5.291496 57.15656
 [9,]  8.294210 57.40853
[10,] 10.519998 57.34554
[11,] 13.732692 57.51352
[12,] 15.958480 55.93867

, , 22

           [,1]     [,2]
 [1,]  8.168564 57.41153
 [2,]  8.189617 56.04309
 [3,]  5.579045 59.41157
 [4,]  0.694749 60.42211
 [5,]  0.421060 61.11686
 [6,]  0.336848 61.58002
 [7,]  1.305286 62.52741
 [8,]  3.957964 62.61162
 [9,]  7.494868 60.90633
[10,] 10.084387 59.05366
[11,] 13.810768 56.90626
[12,] 15.052895 53.24304

, , 23

           [,1]     [,2]
 [1,]  8.514847 55.94275
 [2,]  9.163398 54.83394
 [3,]  5.732354 55.92183
 [4,]  2.238547 54.66657
 [5,]  1.882890 55.00131
 [6,]  1.694601 55.41973
 [7,]  1.799206 56.25657
 [8,]  3.640254 57.34446
 [9,]  6.673799 57.59551
[10,]  9.016951 57.51183
[11,] 11.883128 57.34446
[12,] 14.100754 55.37789

, , 24

          [,1]     [,2]
 [1,]  7.52874 58.00074
 [2,]  7.90728 57.24366
 [3,]  5.23647 58.12692
 [4,]  1.95579 56.94924
 [5,]  1.55622 57.26469
 [6,]  1.36695 57.79044
 [7,]  1.53519 58.73679
 [8,]  3.13347 59.49387
 [9,]  5.59398 59.51490
[10,]  7.90728 59.22048
[11,] 10.53603 59.17842
[12,] 12.38667 57.43293

, , 25

           [,1]     [,2]
 [1,]  9.660255 58.00344
 [2,] 10.498455 57.16524
 [3,]  7.543800 58.17108
 [4,]  4.253865 56.80901
 [5,]  3.876675 57.27002
 [6,]  3.583305 57.60530
 [7,]  3.604260 58.50636
 [8,]  5.196840 59.55411
 [9,]  7.858125 59.70080
[10,] 10.142220 59.61698
[11,] 12.824460 59.38647
[12,] 15.108555 57.66816

, , 26

           [,1]     [,2]
 [1,]  8.374318 56.47404
 [2,]  8.837220 55.10638
 [3,]  5.554824 57.02111
 [4,]  1.346624 55.94802
 [5,]  0.967886 56.74758
 [6,]  0.799558 57.33673
 [7,]  0.904763 58.51502
 [8,]  3.008863 59.20937
 [9,]  6.312300 58.97792
[10,]  9.110753 58.28357
[11,] 12.498354 57.84171
[12,] 15.465135 55.56928

, , 27

           [,1]     [,2]
 [1,]  8.634288 57.98208
 [2,]  9.663680 56.13338
 [3,]  5.945264 58.54930
 [4,]  1.491568 56.53253
 [5,]  0.924352 57.41486
 [6,]  0.630240 58.27619
 [7,]  0.861328 59.83078
 [8,]  3.361280 60.90219
 [9,]  7.016672 60.86018
[10,]  9.936784 59.95683
[11,] 14.180400 59.43163
[12,] 17.016480 57.01571

, , 28

          [,1]     [,2]
 [1,]  9.99570 57.01410
 [2,] 10.63920 55.74855
 [3,]  6.73530 57.70050
 [4,]  1.26555 55.83435
 [5,]  0.64350 56.49930
 [6,]  0.49335 56.99265
 [7,]  0.66495 58.25820
 [8,]  3.81810 59.56665
 [9,]  7.61475 59.48085
[10,] 10.85370 58.92315
[11,] 14.43585 58.53705
[12,] 17.54610 56.11320

, , 29

           [,1]     [,2]
 [1,]  9.293050 56.80955
 [2,]  9.860725 55.37985
 [3,]  6.664925 57.29312
 [4,]  2.733250 55.90547
 [5,]  2.291725 56.15777
 [6,]  2.018400 56.62032
 [7,]  2.060450 57.83977
 [8,]  4.205000 59.08025
 [9,]  7.758225 59.01717
[10,] 10.449425 58.40745
[11,] 13.645225 57.96592
[12,] 15.831825 56.15777

, , 30

           [,1]     [,2]
 [1,]  8.395014 57.54170
 [2,]  9.238734 56.52924
 [3,]  6.243528 57.96356
 [4,]  2.425695 57.01438
 [5,]  1.792905 57.26750
 [6,]  1.455417 57.49952
 [7,]  1.413231 58.51198
 [8,]  3.417066 59.65100
 [9,]  6.686481 59.54554
[10,]  9.133269 58.80728
[11,] 11.790987 58.51198
[12,] 14.090124 56.74017

, , 31

           [,1]     [,2]
 [1,]  9.536103 56.41668
 [2,] 10.188684 55.53254
 [3,]  6.862626 56.83770
 [4,]  2.778732 55.72200
 [5,]  2.315610 56.16407
 [6,]  1.978794 56.45878
 [7,]  2.084049 57.49028
 [8,]  4.189149 58.39547
 [9,]  7.431003 58.62703
[10,] 10.314990 58.35337
[11,] 13.809456 57.99551
[12,] 15.935607 56.03776

, , 32

          [,1]     [,2]
 [1,]  9.28998 57.66999
 [2,]  9.43845 56.39739
 [3,]  6.15090 60.06672
 [4,]  0.91203 61.10601
 [5,]  0.67872 61.63626
 [6,]  0.57267 62.16651
 [7,]  1.16655 63.16338
 [8,]  4.43289 63.26943
 [9,]  7.86891 61.44537
[10,] 10.90194 59.30316
[11,] 14.23191 57.26700
[12,] 15.84387 53.95824

, , 33

          [,1]     [,2]
 [1,]  9.45411 57.01684
 [2,] 10.10108 56.05682
 [3,]  6.63666 57.28815
 [4,]  2.69223 55.86899
 [5,]  2.35831 56.36987
 [6,]  2.02439 56.72466
 [7,]  2.08700 57.72642
 [8,]  3.88182 58.85340
 [9,]  7.57581 58.89514
[10,] 10.20543 58.39426
[11,] 13.44028 58.20643
[12,] 16.13251 56.32813

, , 34

           [,1]     [,2]
 [1,]  7.130627 56.33819
 [2,]  7.546407 55.63136
 [3,]  5.238828 56.50450
 [4,]  1.683909 55.36111
 [5,]  1.476019 55.67294
 [6,]  1.247340 55.75610
 [7,]  1.164184 56.75397
 [8,]  2.577836 57.81421
 [9,]  5.488296 57.98052
[10,]  7.691930 57.54395
[11,] 10.165821 57.39843
[12,] 12.847602 55.79768

, , 35

           [,1]     [,2]
 [1,]  9.093168 58.07419
 [2,]  9.745687 56.79020
 [3,]  6.209455 58.36888
 [4,]  1.852312 57.00069
 [5,]  1.283989 57.48482
 [6,]  1.094548 57.90580
 [7,]  1.305038 59.00035
 [8,]  3.388889 59.96860
 [9,]  7.114562 60.32643
[10,]  9.787785 59.71601
[11,] 12.945135 59.16874
[12,] 15.239476 57.50587

, , 36

           [,1]     [,2]
 [1,]  8.076244 58.16164
 [2,]  8.837356 57.21025
 [3,]  5.412352 58.26735
 [4,]  1.945064 56.51257
 [5,]  1.458798 56.93541
 [6,]  1.205094 57.29482
 [7,]  1.374230 58.20393
 [8,]  3.065590 59.45130
 [9,]  5.835192 59.85300
[10,]  8.625936 59.64158
[11,] 11.691526 59.76843
[12,] 14.672548 57.88680

, , 37

          [,1]     [,2]
 [1,]  8.46210 56.89815
 [2,]  9.28305 55.97195
 [3,]  6.44130 56.77185
 [4,]  2.31550 55.29835
 [5,]  1.91555 55.57200
 [6,]  1.78925 56.05615
 [7,]  1.76820 57.08760
 [8,]  3.17855 57.99275
 [9,]  6.31500 58.45585
[10,]  8.77785 58.37165
[11,] 11.97745 58.35060
[12,] 14.46135 57.08760

, , 38

          [,1]     [,2]
 [1,]  8.58024 57.72735
 [2,]  9.65277 56.27628
 [3,]  6.07767 58.31619
 [4,]  1.21974 57.41190
 [5,]  0.79914 58.27413
 [6,]  0.65193 58.77885
 [7,]  1.07253 60.12477
 [8,]  3.36480 60.73464
 [9,]  6.98196 60.27198
[10,] 10.01028 59.28357
[11,] 13.83774 58.88400
[12,] 16.71885 56.08701

, , 39

           [,1]     [,2]
 [1,]  9.389055 56.73521
 [2,] 10.000926 55.84905
 [3,]  6.751680 56.94620
 [4,]  2.869464 55.57477
 [5,]  2.363088 56.06004
 [6,]  2.088801 56.62972
 [7,]  2.236494 57.62137
 [8,]  4.198701 58.50753
 [9,]  7.532343 58.38093
[10,]  9.916530 58.21214
[11,] 12.638301 58.29654
[12,] 15.338973 56.27103

, , 40

           [,1]     [,2]
 [1,]  9.494001 56.66929
 [2,] 10.125531 55.57464
 [3,]  6.694218 57.25872
 [4,]  1.494621 56.47983
 [5,]  0.968346 56.77455
 [6,]  0.842040 57.34292
 [7,]  0.989397 58.33232
 [8,]  3.410262 59.30067
 [9,]  7.473105 58.92175
[10,]  9.957123 58.26917
[11,] 13.514742 57.72184
[12,] 15.956658 55.59569

> estimate.missing(plethland,method="Reg")
, , 1

            [,1]        [,2]
 [1,]  2.8488870 -0.36113642
 [2,]  3.2257739 -1.37038959
 [3,] -0.4930715  0.07352973
 [4,] -4.1931357 -1.38996394
 [5,] -4.7861969 -0.95456782
 [6,] -4.8264526 -0.81522983
 [7,] -5.2204437  0.56876865
 [8,] -2.7095552  1.63676479
 [9,]  0.2392932  1.57766650
[10,]  2.8310743  1.12297781
[11,]  4.7128401  1.29991874
[12,]  8.3709871 -1.38833862

, , 2

             [,1]        [,2]
 [1,]  2.32975308  0.00157302
 [2,]  2.51161266 -0.76769471
 [3,] -0.40795403 -0.01756626
 [4,] -4.51425240 -1.22763461
 [5,] -4.95181315 -0.84865537
 [6,] -5.10895448 -0.63552962
 [7,] -5.08813187  0.58853900
 [8,] -2.83214673  1.35809072
 [9,]  0.01910411  1.65139579
[10,]  2.54794402  1.42387567
[11,]  4.66585700  1.03878136
[12,]  7.58888103 -1.22465053

, , 3

            [,1]        [,2]
 [1,]  2.5582401  0.01370492
 [2,]  2.8059847 -0.81033465
 [3,] -0.6259428  0.02356795
 [4,] -4.0198062 -1.49541007
 [5,] -4.4035914 -0.97194545
 [6,] -4.5657040 -0.72338031
 [7,] -4.5434882  0.44791784
 [8,] -2.6057336  1.30774862
 [9,]  0.4184023  1.54604841
[10,]  2.7287344  1.19150825
[11,]  4.8620254  0.94026333
[12,]  7.3908794 -1.46968885

, , 4

            [,1]        [,2]
 [1,]  2.8568975 -0.07612055
 [2,]  3.1266180 -1.35120727
 [3,] -0.6823959 -0.02551966
 [4,] -4.2372883 -1.95565814
 [5,] -4.8406825 -1.19558489
 [6,] -5.1131576 -0.59540899
 [7,] -4.9165181  0.70423486
 [8,] -3.1096965  1.60639987
 [9,]  0.1509471  1.92468428
[10,]  3.0431253  1.45695683
[11,]  5.1684292  1.27112539
[12,]  8.5537218 -1.76390171

, , 5

            [,1]       [,2]
 [1,]  2.2925806  0.1859602
 [2,]  2.6080048 -0.7067990
 [3,] -0.4079260 -0.1065693
 [4,] -4.1637110 -1.2128733
 [5,] -4.7735363 -0.6034521
 [6,] -4.8648042 -0.2842273
 [7,] -4.8858273  0.8918698
 [8,] -2.5387133  1.1528225
 [9,]  0.6650542  1.2657688
[10,]  2.6560797  1.3903212
[11,]  4.0043922  1.3502515
[12,]  7.1268213 -1.0110511

, , 6

            [,1]        [,2]
 [1,]  2.3852385 -0.06718574
 [2,]  2.6389927 -1.07492459
 [3,] -0.6958249  0.01424395
 [4,] -3.6921298 -1.24018267
 [5,] -4.0060299 -0.87962045
 [6,] -4.3193365 -0.74052244
 [7,] -4.4003462  0.39314262
 [8,] -2.6919518  1.27903869
 [9,]  0.1790866  1.52716191
[10,]  2.6647751  1.15918618
[11,]  4.5495259  1.14886084
[12,]  7.3880004 -1.51919830

, , 7

            [,1]        [,2]
 [1,]  2.4913186  0.03624586
 [2,]  2.9679567 -0.84995637
 [3,] -0.3949080 -0.08181219
 [4,] -4.0046658 -1.26188177
 [5,] -4.3672216 -0.78753084
 [6,] -4.5197647 -0.58397208
 [7,] -4.3972403  0.37909928
 [8,] -2.5572560  1.13579923
 [9,]  0.3736653  1.27203901
[10,]  2.5888783  1.19258052
[11,]  4.6626156  0.68241421
[12,]  7.1566218 -1.13302487

, , 8

            [,1]         [,2]
 [1,]  2.5741951 -0.156699793
 [2,]  3.4397450 -1.182565621
 [3,] -0.1015889 -0.006002279
 [4,] -4.5247116 -1.723145330
 [5,] -5.0600899 -1.024209467
 [6,] -5.2483787 -0.544450257
 [7,] -5.2256789  0.515855735
 [8,] -3.1239010  1.487216239
 [9,]  0.4064535  1.666181674
[10,]  2.9598814  1.383739393
[11,]  5.1513200  1.172262633
[12,]  8.7527542 -1.588182925

, , 9

            [,1]        [,2]
 [1,]  3.0174120 -0.19237816
 [2,]  3.3231474 -1.32775625
 [3,] -0.7998189 -0.07255367
 [4,] -4.2633931 -1.40896305
 [5,] -4.7421877 -1.09599059
 [6,] -5.3029323 -0.71718782
 [7,] -5.1359345  0.55178852
 [8,] -3.0436450  1.56974486
 [9,]  0.3333783  1.54934219
[10,]  3.3029823  1.43448193
[11,]  5.0178695  1.14770565
[12,]  8.2931220 -1.43823361

, , 10

            [,1]          [,2]
 [1,]  3.0775646 -0.0008161492
 [2,]  3.3769854 -1.0237075341
 [3,] -0.3986890  0.0504170936
 [4,] -4.7453891 -1.7771278359
 [5,] -5.1664204 -1.1924042638
 [6,] -5.2943013 -0.6606869084
 [7,] -5.2662793  0.6662794207
 [8,] -3.1659324  1.6003727085
 [9,]  0.1241916  1.6472642721
[10,]  3.0050072  1.4563483950
[11,]  5.1779114  0.9332771386
[12,]  8.8766623 -1.6487992436

, , 11

            [,1]       [,2]
 [1,]  3.1529733 -0.8645774
 [2,]  4.0348976 -2.1054777
 [3,] -1.0090708 -0.4914384
 [4,] -5.6185838 -1.5590575
 [5,] -5.9080691 -0.8244333
 [6,] -6.2382761 -0.4320686
 [7,] -6.0651115  0.8463627
 [8,] -3.2715620  1.7929186
 [9,]  0.2984702  1.5573694
[10,]  3.6893102  1.2889441
[11,]  6.1264587  1.1885405
[12,] 10.8085634 -0.3970824

, , 12

            [,1]       [,2]
 [1,]  2.5944727 -0.7667142
 [2,]  3.6711366 -1.8306825
 [3,] -0.9202779 -0.3827177
 [4,] -4.4527962 -1.4012809
 [5,] -5.2250019 -0.8601984
 [6,] -5.5863679 -0.4069678
 [7,] -5.3900984  0.8633430
 [8,] -3.1593486  1.7142673
 [9,]  0.1792491  1.4199823
[10,]  3.2680347  1.0583343
[11,]  5.1821145  1.2613603
[12,]  9.8388832 -0.6687256

, , 13

            [,1]       [,2]
 [1,]  2.8027564 -0.6942156
 [2,]  3.6016105 -2.0374333
 [3,] -0.8575125 -0.2110163
 [4,] -5.3240893 -1.6116313
 [5,] -5.8732666 -0.8551070
 [6,] -5.9771755 -0.5064697
 [7,] -5.6662527  0.8521190
 [8,] -3.1886794  1.8040081
 [9,]  0.3526865  1.4371949
[10,]  3.6288753  1.0449923
[11,]  5.7170905  1.2397852
[12,] 10.7839566 -0.4622264

, , 14

            [,1]       [,2]
 [1,]  1.3894628 -0.2935731
 [2,]  2.0420605 -0.9966357
 [3,] -0.6981028 -0.3046438
 [4,] -2.6862456 -0.9927071
 [5,] -2.9641087 -0.6438977
 [6,] -3.1180521 -0.1841118
 [7,] -2.8003827  0.6657677
 [8,] -1.8724383  1.0535023
 [9,]  0.4166286  0.7616023
[10,]  1.8144739  0.7093782
[11,]  2.7969538  0.5809826
[12,]  5.6797507 -0.3556638

, , 15

            [,1]       [,2]
 [1,]  3.1669329 -0.6421296
 [2,]  3.9513094 -2.4253434
 [3,] -0.7663759 -0.2182565
 [4,] -5.5783726 -1.5801100
 [5,] -6.0528486 -1.2005714
 [6,] -6.7184673 -0.7237895
 [7,] -6.2616399  0.8794852
 [8,] -3.5549616  1.9771443
 [9,]  0.9013380  1.8203119
[10,]  3.8100675  1.5598777
[11,]  5.9415194  1.3422900
[12,] 11.1614986 -0.7889088

, , 16

            [,1]       [,2]
 [1,]  2.7569139 -0.3941374
 [2,]  3.6124353 -2.5228417
 [3,] -0.6253186 -0.1479225
 [4,] -5.3332681 -1.7740095
 [5,] -5.6865433 -0.9690813
 [6,] -5.9199861 -0.4741289
 [7,] -5.7282126  0.8618897
 [8,] -3.2639413  1.7965366
 [9,]  0.4741212  1.6094154
[10,]  3.6201101  1.4572049
[11,]  5.7701416  1.0290720
[12,] 10.3235477 -0.4719971

, , 17

            [,1]       [,2]
 [1,]  1.8020382 -0.4174893
 [2,]  2.3114814 -1.2186279
 [3,] -0.5883281 -0.3070083
 [4,] -3.1441243 -1.0300982
 [5,] -3.4203971 -0.6391079
 [6,] -3.5917431 -0.2530434
 [7,] -3.5597004  0.4392346
 [8,] -2.3023311  1.2637290
 [9,]  0.3568387  1.0572495
[10,]  2.0710719  0.8519553
[11,]  3.6863763  0.7773390
[12,]  6.3788176 -0.5241324

, , 18

            [,1]        [,2]
 [1,]  2.8438663 -0.82131115
 [2,]  3.8303127 -2.03382259
 [3,] -0.9780352 -0.05364948
 [4,] -5.1391654 -1.67345869
 [5,] -5.8057644 -1.12987396
 [6,] -6.3555004 -0.58360602
 [7,] -6.0412969  0.84744000
 [8,] -3.6186813  1.95768475
 [9,]  0.6785123  1.78462821
[10,]  3.7493069  1.23098670
[11,]  6.0172455  1.12362639
[12,] 10.8192000 -0.64864418

, , 19

            [,1]       [,2]
 [1,]  2.3055442 -0.5208119
 [2,]  3.6664735 -1.9129770
 [3,] -1.1749746 -0.3178897
 [4,] -4.7856531 -1.5579380
 [5,] -5.3513972 -0.9366774
 [6,] -5.4682433 -0.4553078
 [7,] -5.1559277  0.7203506
 [8,] -3.1467587  1.6779580
 [9,]  0.5972066  1.5823955
[10,]  3.5019625  1.3467320
[11,]  5.1826504  1.1492665
[12,]  9.8291175 -0.7751009

, , 20

            [,1]       [,2]
 [1,]  2.0117453 -0.5417572
 [2,]  3.3264750 -1.6185056
 [3,] -0.5934835 -0.3248754
 [4,] -5.0012448 -1.4087169
 [5,] -5.3584930 -0.8069212
 [6,] -5.6515694 -0.4540922
 [7,] -5.2416659  0.7138828
 [8,] -2.8720769  1.3718725
 [9,]  0.4178214  1.4704715
[10,]  3.4795109  1.0479337
[11,]  5.3973619  1.1808354
[12,] 10.0856189 -0.6301274

, , 21

            [,1]       [,2]
 [1,]  2.0720511 -0.4932778
 [2,]  2.7613436 -1.5651020
 [3,] -0.3307093 -0.2038202
 [4,] -3.9370489 -1.1625881
 [5,] -4.4147784 -0.8261585
 [6,] -4.7039404 -0.5059137
 [7,] -4.6389488  0.5016313
 [8,] -2.8104149  1.4007691
 [9,]  0.2072795  1.3964175
[10,]  2.4231866  1.1438316
[11,]  5.6420315  1.0376777
[12,]  7.7299482 -0.7234669

, , 22

            [,1]       [,2]
 [1,]  2.5697941 -0.7283707
 [2,]  3.2401059 -1.9253713
 [3,] -0.6663317 -0.1977995
 [4,] -5.4542757 -1.6320134
 [5,] -6.0262924 -1.1494238
 [6,] -6.3210559 -0.7808215
 [7,] -5.9185538  0.5157338
 [8,] -3.6191483  1.8523786
 [9,]  0.3116691  2.0319021
[10,]  3.4771427  1.6307740
[11,]  7.7829600  1.5107770
[12,] 10.6239861 -1.1277651

, , 23

            [,1]       [,2]
 [1,]  2.1480357 -0.2394519
 [2,]  2.7553521 -1.3728446
 [3,] -0.6361830 -0.1560395
 [4,] -4.1783603 -1.2810699
 [5,] -4.5217049 -0.9327823
 [6,] -4.6944678 -0.5072090
 [7,] -4.5585120  0.3262542
 [8,] -2.6760578  1.3455029
 [9,]  0.3680455  1.4829479
[10,]  2.7090637  1.3113402
[11,]  5.5695818  1.0367301
[12,]  7.7152070 -1.0133781

, , 24

             [,1]       [,2]
 [1,]  1.97549768 -0.2626125
 [2,]  2.34832428 -1.0241052
 [3,] -0.31879549 -0.1166046
 [4,] -3.61366134 -1.2677086
 [5,] -4.01102776 -0.9483287
 [6,] -4.19608694 -0.4205384
 [7,] -4.01964208  0.5255767
 [8,] -2.41275174  1.2700674
 [9,]  0.05147319  1.2701339
[10,]  2.36508037  0.9556091
[11,]  4.99624563  0.8909470
[12,]  6.83534421 -0.8724360

, , 25

             [,1]       [,2]
 [1,]  1.80101880 -0.3694881
 [2,]  2.59967995 -1.2468800
 [3,] -0.30768576 -0.1028536
 [4,] -3.66092986 -1.3106952
 [5,] -4.01652926 -0.8321493
 [6,] -4.29411221 -0.4831820
 [7,] -4.23094108  0.4168496
 [8,] -2.58944079  1.3897928
 [9,]  0.07852953  1.4118936
[10,]  2.35839833  1.2210703
[11,]  5.02909310  0.8652583
[12,]  7.23291923 -0.9596163

, , 26

             [,1]       [,2]
 [1,]  2.34144478 -0.5670359
 [2,]  2.92894526 -1.8881848
 [3,] -0.52086754 -0.2805482
 [4,] -4.61892036 -1.7372456
 [5,] -5.07012786 -0.9750489
 [6,] -5.29219442 -0.4031967
 [7,] -5.29533633  0.7815345
 [8,] -3.26067277  1.6675167
 [9,]  0.05521377  1.7401446
[10,]  2.90968846  1.3049134
[11,]  6.32761531  1.1754476
[12,]  9.49521172 -0.8182968

, , 27

            [,1]        [,2]
 [1,]  2.0351286 -0.49047906
 [2,]  3.1614024 -2.28937686
 [3,] -0.6937328 -0.06068925
 [4,] -5.0572215 -2.30976708
 [5,] -5.6712044 -1.45529711
 [6,] -6.0103718 -0.60819411
 [7,] -5.8587116  0.96174387
 [8,] -3.4070922  2.16478769
 [9,]  0.2619062  2.31044872
[10,]  3.2375370  1.55636306
[11,]  7.5153833  1.24872845
[12,] 10.4869768 -1.02826833

, , 28

            [,1]       [,2]
 [1,]  2.9557306 -0.4518288
 [2,]  3.6388240 -1.6987307
 [3,] -0.3286514  0.1345888
 [4,] -5.7445196 -1.9005610
 [5,] -6.3873840 -1.2542669
 [6,] -6.5529948 -0.7651341
 [7,] -6.4201167  0.5068130
 [8,] -3.3055107  1.9129066
 [9,]  0.4970565  1.9436888
[10,]  3.7556566  1.4851071
[11,]  7.3519834  1.2088597
[12,] 10.5399260 -1.1214425

, , 29

            [,1]        [,2]
 [1,]  2.0754772 -0.35082906
 [2,]  2.6861971 -1.76606939
 [3,] -0.5726241  0.05666313
 [4,] -4.4716311 -1.44803146
 [5,] -4.9214177 -1.20751452
 [6,] -5.2087079 -0.75213564
 [7,] -5.2018637  0.47074170
 [8,] -3.0894572  1.77547243
 [9,]  0.4720867  1.81590201
[10,]  3.1862904  1.28392065
[11,]  6.3999122  0.93520215
[12,]  8.6457381 -0.81332200

, , 30

             [,1]         [,2]
 [1,]  2.07568375 -0.331219541
 [2,]  2.96530513 -1.306438200
 [3,] -0.09737629 -0.006327991
 [4,] -3.87490996 -1.128765684
 [5,] -4.51921204 -0.903629003
 [6,] -4.86723128 -0.686387388
 [7,] -4.95479463  0.324987993
 [8,] -3.00102908  1.554755455
 [9,]  0.27522490  1.596774249
[10,]  2.75712776  0.968962953
[11,]  5.42973473  0.793462425
[12,]  7.81147701 -0.876175266

, , 31

            [,1]       [,2]
 [1,]  2.2600663 -0.5682170
 [2,]  2.9212248 -1.4491467
 [3,] -0.4224598 -0.1686167
 [4,] -4.5046889 -1.3203374
 [5,] -4.9723144 -0.8811230
 [6,] -5.3120347 -0.5883838
 [7,] -5.2149868  0.4461493
 [8,] -3.1134233  1.3704758
 [9,]  0.1329030  1.6286374
[10,]  3.0242231  1.3779291
[11,]  6.5266336  1.0483846
[12,]  8.6748570 -0.8957517

, , 32

            [,1]        [,2]
 [1,]  3.1990398 -0.72245758
 [2,]  3.9202847 -1.78400150
 [3,] -0.6973411 -0.04846734
 [4,] -5.8294694 -1.55163917
 [5,] -6.2822848 -1.18856463
 [6,] -6.6219295 -0.76677733
 [7,] -6.5561058  0.39358873
 [8,] -3.7056570  1.99961364
 [9,]  0.1898696  1.97115729
[10,]  3.8741048  1.47364677
[11,]  7.7725393  1.20777953
[12,] 10.7369493 -0.98387842

, , 33

            [,1]        [,2]
 [1,]  2.2416160 -0.29192952
 [2,]  2.8905205 -1.25262568
 [3,] -0.5797936 -0.02341695
 [4,] -4.5275497 -1.44861096
 [5,] -4.8626012 -0.94748750
 [6,] -5.1972361 -0.59255579
 [7,] -5.1355753  0.41069270
 [8,] -3.3394616  1.54089100
 [9,]  0.3586494  1.58675018
[10,]  2.9921611  1.08834018
[11,]  6.2305179  0.90388352
[12,]  8.9287527 -0.97393118

, , 34

            [,1]        [,2]
 [1,]  1.7740034 -0.25491465
 [2,]  2.1724364 -0.97437488
 [3,] -0.1180962 -0.03877145
 [4,] -3.7087536 -1.09131855
 [5,] -3.9092601 -0.77327226
 [6,] -4.1361540 -0.68343107
 [7,] -4.1929825  0.31832440
 [8,] -2.7484408  1.34305148
 [9,]  0.1713963  1.43331593
[10,]  2.3676989  0.93868981
[11,]  4.8417145  0.72828700
[12,]  7.4864377 -0.94558576

, , 35

            [,1]        [,2]
 [1,]  2.5134060 -0.33292451
 [2,]  3.1853341 -1.60906316
 [3,] -0.3785878 -0.07930289
 [4,] -4.7214478 -1.51190502
 [5,] -5.2973504 -1.03526241
 [6,] -5.4932007 -0.61643902
 [7,] -5.2982627  0.48270479
 [8,] -3.2255144  1.48225019
 [9,]  0.4995841  1.89358976
[10,]  3.1852618  1.32110060
[11,]  6.3540651  0.81898192
[12,]  8.6767130 -0.81373025

, , 36

            [,1]        [,2]
 [1,]  2.0462839 -0.28184594
 [2,]  2.7234346 -1.29693421
 [3,] -0.6026629  0.05371804
 [4,] -4.2139562 -1.39717899
 [5,] -4.6625670 -0.93326371
 [6,] -4.8846705 -0.55272136
 [7,] -4.6375323  0.33999337
 [8,] -2.8419791  1.43814318
 [9,] -0.0433575  1.59936578
[10,]  2.7224833  1.14740522
[11,]  5.7912940  1.00899825
[12,]  8.6032296 -1.12567964

, , 37

             [,1]       [,2]
 [1,]  2.05476797 -0.3128984
 [2,]  2.77505258 -1.3224553
 [3,]  0.02630224 -0.2254036
 [4,] -4.23910880 -1.2592163
 [5,] -4.60893101 -0.9440707
 [6,] -4.68408735 -0.4485378
 [7,] -4.59626157  0.5815718
 [8,] -3.09462602  1.3352028
 [9,]  0.07950873  1.4658035
[10,]  2.52493322  1.1222891
[11,]  5.70960550  0.7644208
[12,]  8.05284450 -0.7567061

, , 38

            [,1]       [,2]
 [1,]  2.0949726 -0.5000891
 [2,]  3.3614655 -1.7890744
 [3,] -0.4714186 -0.2667490
 [4,] -5.1630686 -1.8447650
 [5,] -5.7011522 -1.0488721
 [6,] -5.9180817 -0.5688769
 [7,] -5.6897207  0.8250040
 [8,] -3.5011655  1.7517110
 [9,]  0.1520266  1.7998774
[10,]  3.2943823  1.2442832
[11,]  7.1455410  1.3839597
[12,] 10.3962193 -0.9864086

, , 39

            [,1]       [,2]
 [1,]  2.2755144 -0.3823080
 [2,]  2.8771998 -1.2762000
 [3,] -0.3606332 -0.1399869
 [4,] -4.2607576 -1.4660359
 [5,] -4.7615833 -0.9745553
 [6,] -5.0292363 -0.4014723
 [7,] -4.8697522  0.5889273
 [8,] -2.8961830  1.4522868
 [9,]  0.4373840  1.2862538
[10,]  2.8207326  1.0890771
[11,]  5.5446234  1.1411673
[12,]  8.2226914 -0.9171539

, , 40

             [,1]        [,2]
 [1,]  2.80801047 -0.42354420
 [2,]  3.54112544 -1.45646005
 [3,] -0.04118738 -0.09921633
 [4,] -5.15319366 -1.36612020
 [5,] -5.70584226 -1.12108160
 [6,] -5.88555780 -0.56618865
 [7,] -5.83153232  0.43516626
 [8,] -3.50790049  1.62884556
 [9,]  0.57988278  1.63338615
[10,]  3.12008075  1.21630648
[11,]  6.71917475  1.00529826
[12,]  9.35693972 -0.88639169

> 
> 
> 
> cleanEx()
> nameEx("fixed.angle")
> ### * fixed.angle
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: fixed.angle
> ### Title: Rotate a subset of 2D landmarks to common articulation angle
> ### Aliases: fixed.angle
> ### Keywords: utilities
> 
> ### ** Examples
> 
> #Example using Plethodon
> #Articulation point is landmark 1, rotate mandibular landmarks (2-5) 
> # relative to cranium
> 
> data(plethspecies) 
> # Using specific points:
> newLM1 <- fixed.angle(plethspecies$land,
+ art.pt=1, angle.pts.1 = 5, 
+ angle.pts.2 = 6, rot.pts = c(2,3,4,5))
> Y.gpa1 <- gpagen(newLM1)

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> plot(Y.gpa1, mean = FALSE)
> 
> # Using centroids from subsets
> newLM2 <- fixed.angle(plethspecies$land,art.pt=1, 
+ angle.pts.1 = c(1, 6:11), 
+ angle.pts.2 = 2:5, 
+ rot.pts = NULL, angle = 20, 
+ degrees = TRUE) # rotated points same as second partition
> Y.gpa2 <- gpagen(newLM2)

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> plot(Y.gpa2, mean = FALSE)
> 
> 
> 
> 
> cleanEx()
> nameEx("geomorph.data.frame")
> ### * geomorph.data.frame
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: geomorph.data.frame
> ### Title: Create a data frame with shape data
> ### Aliases: geomorph.data.frame
> ### Keywords: utilities
> 
> ### ** Examples
> 
> data(plethodon) 
> Y.gpa <- gpagen(plethodon$land,PrinAxes=FALSE)

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> gdf <- geomorph.data.frame(Y.gpa)
> attributes(gdf)
$names
[1] "coords" "Csize" 

$class
[1] "geomorph.data.frame"

> 
> gdf <- geomorph.data.frame(Y.gpa, species = plethodon$species, 
+ site = plethodon$site)
> attributes(gdf)
$names
[1] "coords"  "Csize"   "species" "site"   

$class
[1] "geomorph.data.frame"

> 
> # Using geomorph.data.frame to facilitate analysis
> anova(procD.lm(coords ~ Csize + species * site, data = gdf))

Analysis of Variance, using Residual Randomization
Permutation procedure: Randomization of null model residuals 
Number of permutations: 1000 
Estimation method: Ordinary Least Squares 
Sums of Squares and Cross-products: Type I 
Effect sizes (Z) based on F distributions

             Df       SS       MS     Rsq       F      Z Pr(>F)    
Csize         1 0.010409 0.010409 0.05286  5.2986 2.8820  0.001 ***
species       1 0.025661 0.025661 0.13030 13.0625 4.0712  0.001 ***
site          1 0.063018 0.063018 0.31999 32.0780 5.3722  0.001 ***
species:site  1 0.029093 0.029093 0.14773 14.8093 5.2418  0.001 ***
Residuals    35 0.068758 0.001965 0.34913                          
Total        39 0.196940                                           
---
Signif. codes:  0 *** 0.001 ** 0.01 * 0.05 . 0.1   1

Call: procD.lm(f1 = coords ~ Csize + species * site, data = gdf)
> 
> 
> 
> cleanEx()
> nameEx("globalIntegration")
> ### * globalIntegration
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: globalIntegration
> ### Title: Quantify global integration relative to self-similarity
> ### Aliases: globalIntegration
> ### Keywords: analysis
> 
> ### ** Examples
> 
> data(plethodon) 
> Y.gpa<-gpagen(plethodon$land)    #GPA-alignment    

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> 
> globalIntegration(Y.gpa$coords)
     BEval 
-0.6369198 
> 
> 
> 
> cleanEx()
> nameEx("gm.prcomp")
> ### * gm.prcomp
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gm.prcomp
> ### Title: Principal and phylogenetically-aligned components analysis of
> ###   shape data
> ### Aliases: gm.prcomp
> ### Keywords: visualization
> 
> ### ** Examples
> 
>  data(plethspecies) 
>  Y.gpa <- gpagen(plethspecies$land)    #GPA-alignment

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
>  
>  ###  Traditional PCA 
>  PCA <- gm.prcomp(Y.gpa$coords)
>  summary(PCA)

Ordination type: Principal Component Analysis 
Centering by OLS mean
Orthogonal projection of OLS residuals
Number of observations: 9 
Number of vectors 8 

Importance of Components:
                              Comp1        Comp2        Comp3        Comp4
Eigenvalues            0.0002720474 0.0001120524 0.0001084758 0.0000568924
Proportion of Variance 0.4564029477 0.1879858086 0.1819855633 0.0954461044
Cumulative Proportion  0.4564029477 0.6443887563 0.8263743196 0.9218204240
                              Comp5        Comp6        Comp7        Comp8
Eigenvalues            0.0000264508 1.260516e-05 5.959622e-06 1.584785e-06
Proportion of Variance 0.0443754550 2.114717e-02 9.998220e-03 2.658730e-03
Cumulative Proportion  0.9661958790 9.873431e-01 9.973413e-01 1.000000e+00
>  plot(PCA, main = "PCA")
>  plot(PCA, main = "PCA", flip = 1) # flip the first axis
>  plot(PCA, main = "PCA", axis1 = 3, axis2 = 4) # change PCs viewed
>  
>  ### Phylomorphospace - PCA with phylogeny (result is same as above, 
>  ### but with estimated ancestral states projected into plot)
>  PCA.w.phylo <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy)
>  summary(PCA.w.phylo)

Ordination type: Principal Component Analysis 
Centering by OLS mean
Orthogonal projection of OLS residuals
Number of observations: 9 
Number of vectors 8 

Importance of Components:
                              Comp1        Comp2        Comp3        Comp4
Eigenvalues            0.0002720474 0.0001120524 0.0001084758 0.0000568924
Proportion of Variance 0.4564029477 0.1879858086 0.1819855633 0.0954461044
Cumulative Proportion  0.4564029477 0.6443887563 0.8263743196 0.9218204240
                              Comp5        Comp6        Comp7        Comp8
Eigenvalues            0.0000264508 1.260516e-05 5.959622e-06 1.584785e-06
Proportion of Variance 0.0443754550 2.114717e-02 9.998220e-03 2.658730e-03
Cumulative Proportion  0.9661958790 9.873431e-01 9.973413e-01 1.000000e+00


Dispersion (variance) of points, after projection:
                                       Comp1        Comp2        Comp3
Tips Dispersion                 2.720474e-04 1.120524e-04 1.084758e-04
Proportion Tips Dispersion      4.564029e-01 1.879858e-01 1.819856e-01
Cumulative Tips Dispersion      4.564029e-01 6.443888e-01 8.263743e-01
Ancestors Dispersion            3.073342e-05 2.320038e-05 2.039005e-05
Proportion Ancestors Dispersion 3.854327e-01 2.909597e-01 2.557149e-01
Cumulative Ancestors Dispersion 3.854327e-01 6.763923e-01 9.321072e-01
                                       Comp4        Comp5        Comp6
Tips Dispersion                 5.689240e-05 2.645080e-05 1.260516e-05
Proportion Tips Dispersion      9.544610e-02 4.437545e-02 2.114717e-02
Cumulative Tips Dispersion      9.218204e-01 9.661959e-01 9.873431e-01
Ancestors Dispersion            3.171758e-06 1.748508e-06 3.945777e-07
Proportion Ancestors Dispersion 3.977752e-02 2.192831e-02 4.948462e-03
Cumulative Ancestors Dispersion 9.718847e-01 9.938130e-01 9.987615e-01
                                       Comp7        Comp8
Tips Dispersion                 5.959622e-06 1.584785e-06
Proportion Tips Dispersion      9.998220e-03 2.658730e-03
Cumulative Tips Dispersion      9.973413e-01 1.000000e+00
Ancestors Dispersion            8.354868e-08 1.520561e-08
Proportion Ancestors Dispersion 1.047797e-03 1.906960e-04
Cumulative Ancestors Dispersion 9.998093e-01 1.000000e+00


>  plot(PCA.w.phylo, phylo = TRUE, main = "PCA.w.phylo")
>  
>  ### Phylogenetic PCA - PCA based on GLS-centering and projection
>  # This is the same as the method described by Revell (2009)
>  phylo.PCA <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy, GLS = TRUE)
>  summary(phylo.PCA)

Ordination type: Principal Component Analysis 
Centering by GLS mean
Oblique projection of GLS-centered residuals
Number of observations: 9 
Number of vectors 8 

Importance of Components:
                              Comp1        Comp2        Comp3        Comp4
Eigenvalues            2.761405e-05 9.322868e-06 7.889847e-06 6.605120e-06
Proportion of Variance 4.855705e-01 1.639351e-01 1.387365e-01 1.161457e-01
Cumulative Proportion  4.855705e-01 6.495056e-01 7.882421e-01 9.043878e-01
                              Comp5        Comp6        Comp7        Comp8
Eigenvalues            3.017886e-06 1.203779e-06 9.895110e-07 2.262231e-07
Proportion of Variance 5.306707e-02 2.116747e-02 1.739975e-02 3.977950e-03
Cumulative Proportion  9.574548e-01 9.786223e-01 9.960221e-01 1.000000e+00


Dispersion (variance) of points, after projection:
                                       Comp1        Comp2        Comp3
Tips Dispersion                 0.0002498092 8.395185e-05 1.057114e-04
Proportion Tips Dispersion      0.4190949497 1.408427e-01 1.773479e-01
Cumulative Tips Dispersion      0.4190949497 5.599376e-01 7.372855e-01
Ancestors Dispersion            0.0000169982 9.862682e-06 2.194379e-05
Proportion Ancestors Dispersion 0.2131770701 1.236895e-01 2.752006e-01
Cumulative Ancestors Dispersion 0.2131770701 3.368665e-01 6.120671e-01
                                       Comp4        Comp5        Comp6
Tips Dispersion                 0.0001027383 2.765308e-05 1.675548e-05
Proportion Tips Dispersion      0.1723598707 4.639247e-02 2.811000e-02
Cumulative Tips Dispersion      0.9096453329 9.560378e-01 9.841478e-01
Ancestors Dispersion            0.0000272722 1.114653e-06 1.772175e-06
Proportion Ancestors Dispersion 0.3420249711 1.397905e-02 2.222513e-02
Cumulative Ancestors Dispersion 0.9540920945 9.680711e-01 9.902963e-01
                                       Comp7        Comp8
Tips Dispersion                 7.598972e-06 1.850019e-06
Proportion Tips Dispersion      1.274849e-02 3.103703e-03
Cumulative Tips Dispersion      9.968963e-01 1.000000e+00
Ancestors Dispersion            7.068511e-07 6.689930e-08
Proportion Ancestors Dispersion 8.864732e-03 8.389947e-04
Cumulative Ancestors Dispersion 9.991610e-01 1.000000e+00


>  plot(phylo.PCA, phylo = TRUE, main = "phylo PCA")
>  
>  ### Phylogenetic PCA - PCA based on GLS-centering and transformed 
>  # projection
>  # This produces a PCA independent of phylogeny
>  phylo.tPCA <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy, 
+  GLS = TRUE, transform = TRUE)
>  summary(phylo.tPCA)

Ordination type: Principal Component Analysis 
Centering by GLS mean
GLS residuals transformed for orthogonal projection
Number of observations: 9 
Number of vectors 8 

Importance of Components:
                              Comp1        Comp2        Comp3        Comp4
Eigenvalues            2.761405e-05 9.322868e-06 7.889847e-06 6.605120e-06
Proportion of Variance 4.855705e-01 1.639351e-01 1.387365e-01 1.161457e-01
Cumulative Proportion  4.855705e-01 6.495056e-01 7.882421e-01 9.043878e-01
                              Comp5        Comp6        Comp7        Comp8
Eigenvalues            3.017886e-06 1.203779e-06 9.895110e-07 2.262231e-07
Proportion of Variance 5.306707e-02 2.116747e-02 1.739975e-02 3.977950e-03
Cumulative Proportion  9.574548e-01 9.786223e-01 9.960221e-01 1.000000e+00


Dispersion (variance) of points, after projection:
                                       Comp1        Comp2        Comp3
Tips Dispersion                 2.740155e-05 8.385080e-06 7.889441e-06
Proportion Tips Dispersion      4.933393e-01 1.509655e-01 1.420420e-01
Cumulative Tips Dispersion      4.933393e-01 6.443048e-01 7.863468e-01
Ancestors Dispersion            1.604482e-06 8.942699e-07 1.578102e-06
Proportion Ancestors Dispersion 3.034061e-01 1.691056e-01 2.984176e-01
Cumulative Ancestors Dispersion 3.034061e-01 4.725117e-01 7.709293e-01
                                       Comp4        Comp5        Comp6
Tips Dispersion                 6.590826e-06 2.909294e-06 1.175603e-06
Proportion Tips Dispersion      1.186617e-01 5.237912e-02 2.116563e-02
Cumulative Tips Dispersion      9.050085e-01 9.573876e-01 9.785532e-01
Ancestors Dispersion            1.007063e-06 6.196138e-08 1.114791e-07
Proportion Ancestors Dispersion 1.904346e-01 1.171684e-02 2.108060e-02
Cumulative Ancestors Dispersion 9.613640e-01 9.730808e-01 9.941614e-01
                                       Comp7        Comp8
Tips Dispersion                 9.878523e-07 2.033663e-07
Proportion Tips Dispersion      1.778536e-02 3.661419e-03
Cumulative Tips Dispersion      9.963386e-01 1.000000e+00
Ancestors Dispersion            2.711996e-08 3.755919e-09
Proportion Ancestors Dispersion 5.128360e-03 7.102409e-04
Cumulative Ancestors Dispersion 9.992898e-01 1.000000e+00


>  plot(phylo.tPCA, phylo = TRUE, main = "phylo PCA")
>  
>  ### PaCA - Alignment of data to physlogenetic signal rather than axis of 
>  ### greatest variation, like in PCA
>  
>  # OLS method (rotation of PCA)
>  PaCA.ols <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy, 
+    align.to.phy = TRUE)
>  summary(PaCA.ols)

Ordination type: Alignment to an alternative matrix 
Alignment matrix: phy 
Centering by OLS mean
OLS residuals
Alignment to  phy means residual projection is not orthogonal.
Number of observations: 9 
Number of vectors 8 

Importance of Components:
                                Comp1        Comp2        Comp3        Comp4
Singular Value           0.0003931629 0.0001155198 5.091258e-05 2.660786e-05
Proportion of Covariance 0.6595936040 0.1938028696 8.541399e-02 4.463894e-02
Cumulative Proportion    0.6595936040 0.8533964737 9.388105e-01 9.834494e-01
RV by Component          0.0993211764 0.0291827102 1.286158e-02 6.721702e-03
Cumulative RV            0.0993211764 0.1285038867 1.413655e-01 1.480872e-01
                                Comp5        Comp6        Comp7        Comp8
Singular Value           6.598675e-06 2.351469e-06 7.108871e-07 2.042572e-07
Proportion of Covariance 1.107033e-02 3.944966e-03 1.192627e-03 3.426742e-04
Cumulative Proportion    9.945197e-01 9.984647e-01 9.996573e-01 1.000000e+00
RV by Component          1.666963e-03 5.940304e-04 1.795850e-04 5.159965e-05
Cumulative RV            1.497541e-01 1.503482e-01 1.505278e-01 1.505794e-01


Dispersion (variance) of points, after projection:
                                       Comp1        Comp2        Comp3
Tips Dispersion                 2.301865e-04 1.124810e-04 1.133102e-04
Proportion Tips Dispersion      3.861747e-01 1.887049e-01 1.900960e-01
Cumulative Tips Dispersion      3.861747e-01 5.748795e-01 7.649755e-01
Ancestors Dispersion            4.069158e-05 2.437196e-05 8.067595e-06
Proportion Ancestors Dispersion 5.103196e-01 3.056526e-01 1.011770e-01
Cumulative Ancestors Dispersion 5.103196e-01 8.159722e-01 9.171492e-01
                                       Comp4        Comp5        Comp6
Tips Dispersion                 7.526878e-05 4.046474e-05 1.571235e-05
Proportion Tips Dispersion      1.262754e-01 6.788606e-02 2.635999e-02
Cumulative Tips Dispersion      8.912509e-01 9.591370e-01 9.854970e-01
Ancestors Dispersion            6.244464e-06 3.539330e-07 3.508799e-09
Proportion Ancestors Dispersion 7.831282e-02 4.438730e-03 4.400441e-05
Cumulative Ancestors Dispersion 9.954620e-01 9.999008e-01 9.999448e-01
                                       Comp7        Comp8
Tips Dispersion                 6.396433e-06 2.248360e-06
Proportion Tips Dispersion      1.073104e-02 3.771984e-03
Cumulative Tips Dispersion      9.962280e-01 1.000000e+00
Ancestors Dispersion            2.594059e-09 1.810230e-09
Proportion Ancestors Dispersion 3.253251e-05 2.270238e-05
Cumulative Ancestors Dispersion 9.999773e-01 1.000000e+00


>  plot(PaCA.ols, phylo = TRUE, main = "PaCA using OLS")
>  
>  # GLS method (rotation of Phylogenetic PCA)
>  PaCA.gls <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy, 
+  align.to.phy = TRUE, GLS = TRUE)
>  summary(PaCA.gls)

Ordination type: Alignment to an alternative matrix 
Alignment matrix: phy 
Centering by GLS mean
GLS-centered residuals, not transformed
Alignment to  phy means residual projection is not orthogonal.
Number of observations: 9 
Number of vectors 8 

Importance of Components:
                                Comp1        Comp2        Comp3        Comp4
Singular Value           4.093955e-05 8.496891e-06 3.846098e-06 1.712760e-06
Proportion of Covariance 7.198888e-01 1.494109e-01 6.763051e-02 3.011750e-02
Cumulative Proportion    7.198888e-01 8.692997e-01 9.369302e-01 9.670477e-01
RV by Component          3.478334e-01 2.941678e-02 1.180673e-02 7.103513e-03
Cumulative RV            3.478334e-01 3.772502e-01 3.890569e-01 3.961604e-01
                                Comp5        Comp6        Comp7        Comp8
Singular Value           1.409129e-06 3.002188e-07 1.044332e-07 6.019398e-08
Proportion of Covariance 2.477838e-02 5.279104e-03 1.836373e-03 1.058462e-03
Cumulative Proportion    9.918261e-01 9.971052e-01 9.989415e-01 1.000000e+00
RV by Component          1.521884e-03 5.394338e-04 1.631937e-04 4.681627e-05
Cumulative RV            3.976823e-01 3.982218e-01 3.983850e-01 3.984318e-01


Dispersion (variance) of points, after projection:
                                       Comp1        Comp2        Comp3
Tips Dispersion                 1.984349e-04 1.385956e-04 1.134850e-04
Proportion Tips Dispersion      3.329063e-01 2.325162e-01 1.903892e-01
Cumulative Tips Dispersion      3.329063e-01 5.654225e-01 7.558117e-01
Ancestors Dispersion            2.670575e-05 2.563105e-05 1.045586e-05
Proportion Ancestors Dispersion 3.349211e-01 3.214430e-01 1.311286e-01
Cumulative Ancestors Dispersion 3.349211e-01 6.563641e-01 7.874927e-01
                                       Comp4        Comp5        Comp6
Tips Dispersion                 6.989984e-05 5.027941e-05 1.608390e-05
Proportion Tips Dispersion      1.172682e-01 8.435176e-02 2.698331e-02
Cumulative Tips Dispersion      8.730799e-01 9.574317e-01 9.844150e-01
Ancestors Dispersion            9.518248e-06 6.011721e-06 9.181389e-07
Proportion Ancestors Dispersion 1.193699e-01 7.539395e-02 1.151453e-02
Cumulative Ancestors Dispersion 9.068625e-01 9.822565e-01 9.937710e-01
                                       Comp7        Comp8
Tips Dispersion                 6.451805e-06 2.837941e-06
Proportion Tips Dispersion      1.082393e-02 4.761099e-03
Cumulative Tips Dispersion      9.952389e-01 1.000000e+00
Ancestors Dispersion            3.629411e-07 1.337427e-07
Proportion Ancestors Dispersion 4.551702e-03 1.677288e-03
Cumulative Ancestors Dispersion 9.983227e-01 1.000000e+00


>  plot(PaCA.gls, phylo = TRUE, main = "PaCA using GLS")
>  
>  # GLS method (rotation of Phylogenetic PCA with transformed data)
>  PaCA.gls <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy, 
+  align.to.phy = TRUE, GLS = TRUE, transform = TRUE)
>  summary(PaCA.gls)

Ordination type: Alignment to an alternative matrix 
Alignment matrix: phy 
Centering by GLS mean
GLS residuals transformed
Alignment to  phy means residual projection is not orthogonal.
Number of observations: 9 
Number of vectors 8 

Importance of Components:
                                Comp1        Comp2        Comp3        Comp4
Singular Value           4.093955e-05 8.496891e-06 3.846098e-06 1.712760e-06
Proportion of Covariance 7.198888e-01 1.494109e-01 6.763051e-02 3.011750e-02
Cumulative Proportion    7.198888e-01 8.692997e-01 9.369302e-01 9.670477e-01
RV by Component          1.248320e-01 2.590853e-02 1.172744e-02 5.222511e-03
Cumulative RV            1.248320e-01 1.507405e-01 1.624680e-01 1.676905e-01
                                Comp5        Comp6        Comp7        Comp8
Singular Value           1.409129e-06 3.002188e-07 1.044332e-07 6.019398e-08
Proportion of Covariance 2.477838e-02 5.279104e-03 1.836373e-03 1.058462e-03
Cumulative Proportion    9.918261e-01 9.971052e-01 9.989415e-01 1.000000e+00
RV by Component          4.296684e-03 9.154207e-04 3.184354e-04 1.835422e-04
Cumulative RV            1.719872e-01 1.729026e-01 1.732210e-01 1.734046e-01


Dispersion (variance) of points, after projection:
                                       Comp1        Comp2        Comp3
Tips Dispersion                 1.444116e-05 1.274219e-05 1.272668e-05
Proportion Tips Dispersion      2.599995e-01 2.294112e-01 2.291320e-01
Cumulative Tips Dispersion      2.599995e-01 4.894107e-01 7.185427e-01
Ancestors Dispersion            1.735351e-06 2.256490e-06 6.767762e-07
Proportion Ancestors Dispersion 3.281533e-01 4.267002e-01 1.279778e-01
Cumulative Ancestors Dispersion 3.281533e-01 7.548535e-01 8.828313e-01
                                       Comp4        Comp5        Comp6
Tips Dispersion                 7.046498e-06 4.980748e-06 2.127778e-06
Proportion Tips Dispersion      1.268656e-01 8.967371e-02 3.830865e-02
Cumulative Tips Dispersion      8.454083e-01 9.350821e-01 9.733907e-01
Ancestors Dispersion            2.276556e-07 3.818644e-07 6.284842e-09
Proportion Ancestors Dispersion 4.304947e-02 7.221021e-02 1.188458e-03
Cumulative Ancestors Dispersion 9.258808e-01 9.980910e-01 9.992794e-01
                                       Comp7        Comp8
Tips Dispersion                 1.093977e-06 3.839834e-07
Proportion Tips Dispersion      1.969603e-02 6.913263e-03
Cumulative Tips Dispersion      9.930867e-01 1.000000e+00
Ancestors Dispersion            8.928781e-10 2.917607e-09
Proportion Ancestors Dispersion 1.688424e-04 5.517169e-04
Cumulative Ancestors Dispersion 9.994483e-01 1.000000e+00


>  plot(PaCA.gls, phylo = TRUE, 
+    main = "PaCA using GLS and transformed projection")
>  
>  
>  ### Advanced Plotting
>  gps <- as.factor(c(rep("gp1", 5), rep("gp2", 4))) # Two random groups
>  par(mar=c(2, 2, 2, 2))
>  plot(PaCA.ols, pch=22, cex = 1.5, bg = gps, phylo = TRUE) 
>  # Modify options as desired
>  #  Add things as desired using standard R plotting
>  text(par()$usr[1], 0.1*par()$usr[3], labels = "PC1 - 45.64%", 
+    pos = 4, font = 2)
>  text(0, 0.95*par()$usr[4], labels = "PC2 - 18.80%", pos = 4, font = 2)
>  legend("topleft", pch=22, pt.bg = unique(gps), legend = levels(gps))
>  
>  ### NOT RUN
>  ### 3D plot with a phylogeny and time on the z-axis
>  # plot(PCA.w.phylo, time.plot = TRUE)
>  # plot(PCA.w.phylo, time.plot = TRUE, bg = "red", 
>  #    phylo.par = list(tip.labels = TRUE, 
>  # tip.txt.cex = 2, edge.color = "blue", edge.width = 2))
>  
> 
> 
> 
> graphics::par(get("par.postscript", pos = 'CheckExEnv'))
> cleanEx()
> nameEx("gpagen")
> ### * gpagen
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gpagen
> ### Title: Generalized Procrustes analysis of points, curves, and surfaces
> ### Aliases: gpagen
> ### Keywords: analysis
> 
> ### ** Examples
> 
> # Example 1: fixed points only
> data(plethodon) 
> Y.gpa <- gpagen(plethodon$land, PrinAxes = FALSE)

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> summary(Y.gpa)

Call:
gpagen(A = plethodon$land, PrinAxes = FALSE) 



Generalized Procrustes Analysis
with Partial Procrustes Superimposition

12 fixed landmarks
0 semilandmarks (sliders)
2-dimensional landmarks
2 GPA iterations to converge


Consensus (mean) Configuration

             X            Y
1   0.15263287 -0.023350400
2   0.19445064 -0.092643121
3  -0.03361223 -0.007346212
4  -0.28069721 -0.092850147
5  -0.30998751 -0.061672264
6  -0.32557841 -0.036112255
7  -0.31804390  0.036125318
8  -0.18947114  0.098010902
9   0.02036829  0.099112877
10  0.18852641  0.077278061
11  0.35134314  0.065866346
12  0.55006905 -0.062419105
> plot(Y.gpa)
> 
> # Example 2: points and semilandmarks on curves
> data(hummingbirds)
> 
> ###Slider matrix
> hummingbirds$curvepts
      before slide after
 [1,]      1    11    12
 [2,]     11    12    13
 [3,]     13    14    15
 [4,]      7    15    14
 [5,]     12    13    14
 [6,]      1    16    17
 [7,]     16    17    18
 [8,]     17    18    19
 [9,]     18    19    20
[10,]     10    20    19
[11,]      2    21    22
[12,]     21    22    23
[13,]     22    23    24
[14,]     23    24    25
[15,]      8    25    24
> 
> # Using bending energy for sliding
> Y.gpa <- gpagen(hummingbirds$land, curves = hummingbirds$curvepts,
+ ProcD = FALSE)   

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> summary(Y.gpa)

Call:
gpagen(A = hummingbirds$land, curves = hummingbirds$curvepts,  
    ProcD = FALSE) 



Generalized Procrustes Analysis
with Partial Procrustes Superimposition

10 fixed landmarks
15 semilandmarks (sliders)
2-dimensional landmarks
11 GPA iterations to converge
Minimized Bending Energy used


Consensus (mean) Configuration

             X            Y
1  -0.23340453 -0.004150126
2  -0.23437642 -0.008073562
3  -0.13537856  0.009746653
4  -0.10887364  0.011238582
5   0.26393927  0.015493692
6   0.24590730  0.015048673
7   0.27566044  0.023298007
8   0.26748616 -0.029997538
9   0.29156223 -0.006599804
10  0.35241626 -0.024707450
11 -0.20987595  0.005563094
12 -0.17992668  0.012558224
13 -0.15199371  0.015891895
14  0.04417872  0.024479691
15  0.15109354  0.025897899
16 -0.20917012 -0.004128421
17 -0.17798781 -0.001793039
18 -0.15107528 -0.001286613
19  0.04022402 -0.001224994
20  0.14967214 -0.004713315
21 -0.20967275 -0.011393041
22 -0.17729851 -0.014580239
23 -0.14937194 -0.015398253
24  0.03963382 -0.011429485
25  0.14897835 -0.016626651
> plot(Y.gpa)
> 
> 
> # Using Procrustes Distance for sliding
> Y.gpa <- gpagen(hummingbirds$land, curves = hummingbirds$curvepts,
+ ProcD = TRUE)   

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> summary(Y.gpa)

Call:
gpagen(A = hummingbirds$land, curves = hummingbirds$curvepts,  
    ProcD = TRUE) 



Generalized Procrustes Analysis
with Partial Procrustes Superimposition

10 fixed landmarks
15 semilandmarks (sliders)
2-dimensional landmarks
11 GPA iterations to converge
Minimized squared Procrustes Distance used


Consensus (mean) Configuration

             X            Y
1  -0.23028526 -0.003994116
2  -0.23124541 -0.007839311
3  -0.13357583  0.009669288
4  -0.10742820  0.011126953
5   0.26035775  0.015162379
6   0.24256782  0.014731020
7   0.27192260  0.022857806
8   0.26382105 -0.029710933
9   0.28759112 -0.006639457
10  0.34760860 -0.024530122
11 -0.21094248  0.004175427
12 -0.18219203  0.011505800
13 -0.15202026  0.015605897
14  0.06302129  0.024709217
15  0.15648134  0.025342288
16 -0.21055088 -0.004151996
17 -0.18098052 -0.001971807
18 -0.15153441 -0.001191697
19  0.06135175 -0.001527170
20  0.15617421 -0.005369971
21 -0.21097576 -0.010667752
22 -0.18032943 -0.013802158
23 -0.15015648 -0.015202822
24  0.06092370 -0.011474702
25  0.15555003 -0.017250320
> plot(Y.gpa)
> 
> 
> # Example 3: points, curves and surfaces
> data(scallops)
> 
> # Using Procrustes Distance for sliding
> Y.gpa <- gpagen(A = scallops$coorddata, curves = scallops$curvslide, 
+ surfaces = scallops$surfslide)

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> # NOTE can summarize as: summary(Y.gpa)
> # NOTE can plot as: plot(Y.gpa) 
> 
> 
> 
> cleanEx()
> nameEx("gridPar")
> ### * gridPar
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: gridPar
> ### Title: Set up parameters for grids, points, and links in
> ###   plotRefToTarget
> ### Aliases: gridPar
> ### Keywords: utilities visualization
> 
> ### ** Examples
> 
> data(plethodon) 
> Y.gpa<-gpagen(plethodon$land)    #GPA-alignment

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> ref<-mshape(Y.gpa$coords)
> plotRefToTarget(ref,Y.gpa$coords[,,39]) # default settings
> 
> # Altering points and links
> GP1 <- gridPar(pt.bg = "red", pt.size = 1, link.col="blue", link.lwd=2, 
+ n.col.cell=50)
> plotRefToTarget(ref,Y.gpa$coords[,,39], gridPars=GP1, mag=2, 
+ links=plethodon$links, method="TPS")
> 
> # Altering point color
> GP2 <- gridPar(pt.bg = "green", pt.size = 1) 
> plotRefToTarget(ref,Y.gpa$coords[,,39], gridPars=GP2, mag=3, 
+ method="vector")
> 
> # Altering ref and target points
> GP3 <- gridPar(pt.bg = "blue", pt.size = 1.5, tar.pt.bg = "orange", 
+ tar.pt.size = 1) 
> plotRefToTarget(ref,Y.gpa$coords[,,39], gridPars=GP3, mag=3, 
+ method="points")
> 
> # Altering outline color
> GP4 <- gridPar(tar.out.col = "red", tar.out.cex = 0.3) 
> plotRefToTarget(ref,Y.gpa$coords[,,39], gridPars=GP4, mag=3, 
+ outline=plethodon$outline, method="TPS")
> 
> # Altering text labels
> GP5 <- gridPar(txt.pos = 3, txt.col = "red") 
> plotRefToTarget(ref,Y.gpa$coords[,,39], gridPars=GP5, mag=3, 
+ method="vector", label=TRUE)
> 
> 
> 
> cleanEx()
> nameEx("integration.Vrel")
> ### * integration.Vrel
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: integration.Vrel
> ### Title: Quantify integration in a set of traits
> ### Aliases: integration.Vrel
> ### Keywords: analysis
> 
> ### ** Examples
> 
> data(plethodon) 
> Y.gpa<-gpagen(plethodon$land)    #GPA-alignment    

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> integration.Vrel(Y.gpa$coords)
$Re.obs
[1] 0.2048115

$Z.obs
[1] -0.6782447

$ZR
[1] 1.092893

$ZR.var
[1] 0.02702703

attr(,"class")
[1] "rel.eig"
> 
> 
> 
> cleanEx()
> nameEx("integration.test")
> ### * integration.test
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: integration.test
> ### Title: Quantify morphological integration between modules
> ### Aliases: integration.test
> ### Keywords: analysis
> 
> ### ** Examples
> 
> data(plethodon) 
> Y.gpa<-gpagen(plethodon$land)    #GPA-alignment    

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> #landmarks on the skull and mandible assigned to partitions
> land.gps<-c("A","A","A","A","A","B","B","B","B","B","B","B") 
> IT <- integration.test(Y.gpa$coords, partition.gp=land.gps, iter=999)

Random PLS calculations: 1000 permutations.
  |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%

> summary(IT) # Test summary

Call:
integration.test(A = Y.gpa$coords, partition.gp = land.gps, iter = 999) 



r-PLS: 0.911

Effect Size (Z): 5.2379

P-value: 0.001

Based on 1000 random permutations
> P <- plot(IT) # PLS plot
> 
>  # Visualize shape at minimum and maximum PLS scores.
>  # This is the challenging way
>  
>  # Block 1 
>  minx <- min(P$plot.args$x)
>  maxx <- max(P$plot.args$x)
>  preds <- shape.predictor(P$A1, 
+  x = P$plot.args$x,
+  min = minx, max = maxx)
>  plotRefToTarget(mshape(P$A1), preds$min)
>  plotRefToTarget(mshape(P$A1), preds$max)
> 
>  # Block 2 
>  miny <- min(P$plot.args$y)
>  maxy <- max(P$plot.args$y)
>  preds <- shape.predictor(P$A2, 
+  x = P$plot.args$y,
+  min = miny, max = maxy)
>  plotRefToTarget(mshape(P$A2), preds$min)
>  plotRefToTarget(mshape(P$A2), preds$max)
>  
>  ### Visualize shape variation using picknplot.shape Because picknplot  
>  ### requires user decisions, the following example
>  ### is not run (but can be with removal of #).
>  ### For detailed options, see the picknplot help file
>  # picknplot.shape(P)
> 
> IT$left.pls.vectors # extracting just the left (first block) 
           [,1]        [,2]        [,3]        [,4]       [,5]        [,6]
1.X  0.71462518  0.18157111  0.18964696  0.31982909  0.1501020  0.08781322
1.Y  0.34537802 -0.25283147 -0.20548507 -0.19265627  0.0235635 -0.22313401
2.X  0.34180402  0.51991706  0.21616145  0.05930713 -0.3514134 -0.05617039
2.Y  0.40722563 -0.44721589  0.03490058 -0.54168937 -0.3437573  0.26163220
3.X -0.06305656 -0.55691078  0.47720344  0.46371701 -0.3501288 -0.25887653
3.Y  0.17930972 -0.27274837  0.04450666  0.07392613  0.6702014  0.24478497
4.X  0.01134012 -0.06150667 -0.29104198  0.46460615 -0.2166110  0.50934432
4.Y -0.17561111  0.01107404  0.64141802 -0.09956944  0.1810362  0.42291843
5.X -0.06250760 -0.06464277 -0.28813427  0.13759040 -0.2315642  0.48206992
5.Y -0.12790232  0.20041631  0.25498678 -0.31376042 -0.1737156  0.27069124
           [,7]       [,8]        [,9]       [,10]
1.X  0.21554859 -0.1959554  0.45033241 -0.01361666
1.Y -0.58214136  0.3046457  0.21018580 -0.45959771
2.X -0.26220951  0.3102982 -0.49138075  0.17167648
2.Y  0.16894487 -0.2383882 -0.21239807  0.14971653
3.X  0.06694696  0.2179136  0.02518033  0.03013578
3.Y  0.11735119  0.4560020 -0.37064781  0.13353599
4.X  0.00602439 -0.1420349 -0.30823222 -0.52340688
4.Y -0.50738143 -0.2613881  0.05860450 -0.08293795
5.X -0.25261934  0.3134323  0.40529274  0.52690579
5.Y  0.42167773  0.5229885  0.25639233 -0.39936635
> # singular vectors
> 
> 
> 
> cleanEx()
> nameEx("interlmkdist")
> ### * interlmkdist
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: interlmkdist
> ### Title: Calculate linear distances between landmarks
> ### Aliases: interlmkdist
> ### Keywords: utilities
> 
> ### ** Examples
> 
>  
> data(plethodon)
> # Make a matrix defining three interlandmark distances 
> lmks <- matrix(c(8,9,6,12,4,2), ncol=2, byrow=TRUE, 
+ dimnames = list(c("eyeW", "headL", "mouthL"),c("start", "end")))
> # where 8-9 is eye width; 6-12 is head length; 4-2 is mouth length
> # or alternatively
> lmks <- data.frame(eyeW = c(8,9), headL = c(6,12), mouthL = c(4,2), 
+ row.names = c("start", "end")) 
> A <- plethodon$land
> lineardists <- interlmkdist(A, lmks)
> 
> 
> 
> cleanEx()
> nameEx("make_ggplot")
> ### * make_ggplot
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: make_ggplot
> ### Title: Convert geomorph plots to ggplot objects
> ### Aliases: make_ggplot
> ### Keywords: utilities
> 
> ### ** Examples
> 
> 
> ### PLS Example
> # NOT RUN
> # data(plethodon) 
> # Y.gpa<-gpagen(plethodon$land)    #GPA-alignment    
> # landmarks on the skull and mandible assigned to partitions
> # land.gps<-c("A","A","A","A","A","B","B","B","B","B","B","B") 
> # IT <- integration.test(Y.gpa$coords, partition.gp=land.gps, iter=999)
> # summary(IT) # Test summary
> # P <- plot(IT) # PLS plot
> # make_ggplot(P) # same plot in ggplot
> 
> ### Allometry example
> 
> # data(plethodon) 
> # Y.gpa <- gpagen(plethodon$land, print.progress = FALSE)    #GPA-alignment  
> 
> # gdf <- geomorph.data.frame(Y.gpa, site = plethodon$site, 
> #                           species = plethodon$species) 
> 
> # fit <- procD.lm(coords ~ Csize * species * site, data=gdf, iter=0, 
> #                 print.progress = FALSE)
> 
> # P <- plotAllometry(fit, size = gdf$Csize, logsz = TRUE, method = "PredLine", 
> #                     pch = 19, col = as.numeric(interaction(gdf$species, gdf$site)))
> 
> # make_ggplot(P)
> 
> ### Tangent Space plot
> 
> # data(plethspecies) 
> # Y.gpa <- gpagen(plethspecies$land)    #GPA-alignment
> 
> # PCA.w.phylo <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy)
> # P <- plot(PCA.w.phylo, phylo = TRUE, main = "PCA.w.phylo")
> # make_ggplot(P)
> 
> 
> 
> 
> cleanEx()
> nameEx("modularity.test")
> ### * modularity.test
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: modularity.test
> ### Title: Evaluate the degree of modular signal in shape data
> ### Aliases: modularity.test
> ### Keywords: analysis
> 
> ### ** Examples
> 
> # Not Run
> # data(pupfish) 
> # Y.gpa<-gpagen(pupfish$coords, print.progress = FALSE)    #GPA-alignment    
>  #landmarks on the body and operculum
> # land.gps<-rep('a',56); land.gps[39:48]<-'b'
> 
> # MT <- modularity.test(Y.gpa$coords,land.gps,CI=FALSE,iter=99)
> # summary(MT) # Test summary
> # plot(MT) # Histogram of CR sampling distribution 
> # Result implies modularity present
> 
> 
> 
> cleanEx()
> nameEx("morphol.disparity")
> ### * morphol.disparity
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: morphol.disparity
> ### Title: Morphological disparity for one or more groups of specimens
> ### Aliases: morphol.disparity
> ### Keywords: analysis
> 
> ### ** Examples
> 
> # Not Run
> # data(plethodon)
> # Y.gpa<-gpagen(plethodon$land, print.progress = FALSE)    #GPA-alignment
> # gdf <- geomorph.data.frame(Y.gpa, species = plethodon$species, 
> # site = plethodon$site)
> 
> # Morphological disparity for entire data set
> # morphol.disparity(coords ~ 1, groups = NULL, data = gdf, 
> # iter = 999, print.progress = FALSE)
> 
> # Morphological disparity for entire data set, accounting for allometry
> # morphol.disparity(coords ~ Csize, groups= NULL, data = gdf, 
> # iter = 999, print.progress = FALSE)
> 
> # Morphological disparity without covariates, using overall mean
> # morphol.disparity(coords ~ 1, groups= ~ species*site, data = gdf, 
> # iter = 999, print.progress = FALSE)
> 
> # Morphological partial disparities for overal mean
> # morphol.disparity(coords ~ 1, groups= ~ species*site, partial = TRUE, 
> # data = gdf, iter = 999, print.progress = FALSE)
> 
> # Morphological disparity without covariates, using group means
> # morphol.disparity(coords ~ species*site, groups= ~species*site, 
> # data = gdf, iter = 999, print.progress = FALSE)
> 
> # Morphological disparity of different groups than those 
> # described by the linear model
> # morphol.disparity(coords ~ Csize + species*site, groups= ~ species, 
> # data = gdf, iter = 999, print.progress = FALSE)
> 
> # Extracting components
> # MD <- morphol.disparity(coords ~ Csize + species*site, groups= ~ species, 
> # data = gdf, iter = 999, print.progress = FALSE)
> # MD$Procrustes.var # just the Procrustes variances
> 
> 
> ### Morphol.disparity can be used with previously-defined 
> ### procD.lm or lm.rrpp class objects
> 
> # data(plethspecies)
> # Y.gpa<-gpagen(plethspecies$land)    #GPA-alignment
> # gp.end<-factor(c(0,0,1,0,0,1,1,0,0))  #endangered species vs. rest
> # names(gp.end)<-plethspecies$phy$tip
> 
> # gdf <- geomorph.data.frame(Y.gpa, phy = plethspecies$phy, 
> # gp.end = gp.end)
> 
> # pleth.ols <- procD.lm(coords ~ Csize + gp.end, 
> # data = gdf, iter = 999) # ordinary least squares
> # pleth.pgls <- procD.pgls(coords ~ Csize + gp.end, phy = phy, 
> # data = gdf, iter = 999) # phylogenetic generalized least squares
> 
> # summary(pleth.ols)
> # summary(pleth.pgls)
> 
> # morphol.disparity(f1 = pleth.ols, groups = ~ gp.end, data = gdf, 
> # iter = 999, print.progress = FALSE)
> # morphol.disparity(f1 = pleth.pgls, groups = ~ gp.end, 
> # transform = FALSE, data = gdf, 
> # iter = 999, print.progress = FALSE) # disparity in tangent space
> # morphol.disparity(f1 = pleth.pgls, groups = ~ gp.end,
> # transform = TRUE, data = gdf, 
> # iter = 999, print.progress = FALSE) # disparity in transformed space 
> 
> # Three plots that correspond to the three tests
> # PCA <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy)
> # pPCA <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy, 
> # GLS = TRUE, transform = FALSE)
> # tpPCA <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy, 
> # GLS = TRUE, transform = TRUE)
> 
> # par(mfrow = c(1,3))
> 
> # Phylomorphospace
> # PC.plot <- plot(PCA, pch = 19, phylo = TRUE, main = "PCA-OLS")
> # shapeHulls(PC.plot, groups = gp.end)
> 
> # Phylo-PCA
> # pPC.plot <- plot(pPCA, pch = 19, phylo = TRUE, main = "pPCA - GLS, not transformed")
> # shapeHulls(pPC.plot, groups = gp.end)
> 
> # Transformed phylo-PCA
> # tpPC.plot <- plot(tpPCA, pch = 19, phylo = TRUE, main = "tpPCA - GLS, transformed")
> # shapeHulls(tpPC.plot, groups = gp.end)
> 
> # par(mfrow = c(1,1))
> 
>  ### Variance using RRPP (not necessarily the same as disparity)
>  # PW <- pairwise(pleth.ols, groups = gp.end)
>  # summary(PW, test.type = 'var')
>  # PW2 <- pairwise(pleth.pgls, groups = gp.end)
>  # summary(PW2, test.type = 'var')
> 
> 
> 
> 
> cleanEx()
> nameEx("mshape")
> ### * mshape
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: mshape
> ### Title: Estimate mean shape for a set of aligned specimens
> ### Aliases: mshape
> ### Keywords: utilities
> 
> ### ** Examples
> 
> data(plethodon)
> Y.gpa<-gpagen(plethodon$land)    #GPA-alignment

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> A <- Y.gpa$coords
> A[[1]] <- NA # make a missing value, just for example
> 
> mshape(Y.gpa$coords)   # mean (consensus) configuration
             X            Y
1   0.15233235 -0.025236647
2   0.19328979 -0.095041344
3  -0.03370053 -0.006929874
4  -0.28182427 -0.089370882
5  -0.31072667 -0.057833070
6  -0.32600020 -0.032082160
7  -0.31757270  0.040056685
8  -0.18824427  0.100347118
9   0.02159274  0.098853343
10  0.18946790  0.074940119
11  0.35213101  0.061515271
12  0.54925485 -0.069218559
attr(,"class")
[1] "mshape" "matrix"
> # mshape(A, na.action = 1) # will return an error
> mshape(A, na.action = 2) # returns NA in spot of missing value
Warning: 
This is not an error!  It is a friendly warning.
 
Missing values detected.
 
NA is returned for any coordinate where missing values were found. 
You can estimate missing values (see 'estimate.missing') 
or change the na.action (see Arguments) to find the mean of just the remaining values.
 
Use options(warn = -1) to turn off these warnings. 


             X            Y
1           NA -0.025236647
2   0.19328979 -0.095041344
3  -0.03370053 -0.006929874
4  -0.28182427 -0.089370882
5  -0.31072667 -0.057833070
6  -0.32600020 -0.032082160
7  -0.31757270  0.040056685
8  -0.18824427  0.100347118
9   0.02159274  0.098853343
10  0.18946790  0.074940119
11  0.35213101  0.061515271
12  0.54925485 -0.069218559
attr(,"class")
[1] "mshape" "matrix"
> mshape(A, na.action = 3) # finds mean values from all possible values
Warning: 
This is not an error!  It is a friendly warning.
 
Missing values detected.
 
Means are calculated only for values that are found. 
You can estimate missing values (see 'estimate.missing') 
or change the na.action (see Arguments) to return NA for coordinates that have missing values.
 
Use options(warn = -1) to turn off these warnings. 


             [,1]         [,2]
 [1,]  0.15144998 -0.025236647
 [2,]  0.19328979 -0.095041344
 [3,] -0.03370053 -0.006929874
 [4,] -0.28182427 -0.089370882
 [5,] -0.31072667 -0.057833070
 [6,] -0.32600020 -0.032082160
 [7,] -0.31757270  0.040056685
 [8,] -0.18824427  0.100347118
 [9,]  0.02159274  0.098853343
[10,]  0.18946790  0.074940119
[11,]  0.35213101  0.061515271
[12,]  0.54925485 -0.069218559
attr(,"class")
[1] "mshape" "matrix"
> 
> 
> 
> 
> cleanEx()
> nameEx("na.omit.geomorph.data.frame")
> ### * na.omit.geomorph.data.frame
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: na.omit.geomorph.data.frame
> ### Title: Handle missing values in rrpp.data.frame objects
> ### Aliases: na.omit.geomorph.data.frame
> ### Keywords: utilities
> 
> ### ** Examples
> 
> data(plethspecies)
> Y.gpa <- gpagen(plethspecies$land, verbose = TRUE)

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!

Compiling additional results ... Finished!
> gdf <- geomorph.data.frame(Y.gpa)
> gdf$d <- Y.gpa$procD
> gdf$group <- c(rep(1, 4), rep(2, 4), NA) # one unknown group designation
> gdf
$coords
, , P_cinereus

             X           Y
1   0.21608543 -0.02080338
2   0.25310261 -0.07708298
3  -0.01792156 -0.01448663
4  -0.26651651 -0.09752395
5  -0.28724162 -0.06453206
6  -0.31967119 -0.03239812
7  -0.31362497  0.04171542
8  -0.17675527  0.10909565
9   0.05039109  0.11565174
10  0.23977149  0.08099904
11  0.62238049 -0.04063474

, , P_electromorphus

             X           Y
1   0.20836367 -0.02140531
2   0.24409833 -0.07723167
3  -0.02977598 -0.01275263
4  -0.26427414 -0.09970880
5  -0.28743030 -0.06481155
6  -0.31243134 -0.03300287
7  -0.30722191  0.04972560
8  -0.17365967  0.10841289
9   0.04485841  0.11313202
10  0.23906577  0.07161864
11  0.63840715 -0.03397633

, , P_hoffmani

             X           Y
1   0.21459121 -0.02287960
2   0.24756106 -0.07822209
3  -0.02375710 -0.01304699
4  -0.26003800 -0.09162166
5  -0.29093913 -0.05923147
6  -0.32328269 -0.02648361
7  -0.31321860  0.04070778
8  -0.17360458  0.10475086
9   0.05043677  0.10368721
10  0.24107282  0.06939060
11  0.63117824 -0.02705104

, , P_hubrichti

             X           Y
1   0.21443964 -0.02119811
2   0.24499372 -0.08828434
3  -0.03901225 -0.01855381
4  -0.25951827 -0.09138193
5  -0.29217428 -0.06366227
6  -0.31517233 -0.03103907
7  -0.30835717  0.04609711
8  -0.17899031  0.10645896
9   0.06059128  0.11017621
10  0.24377493  0.07836204
11  0.62942504 -0.02697478

, , P_nettingi

             X           Y
1   0.21654559 -0.02813895
2   0.24704810 -0.09648021
3  -0.02436038 -0.01854270
4  -0.25450293 -0.09034384
5  -0.29784646 -0.06316524
6  -0.31950340 -0.02972654
7  -0.31454020  0.04911675
8  -0.17753572  0.11756629
9   0.05885615  0.10519037
10  0.24159021  0.06598143
11  0.62424903 -0.01145736

, , P_richmondi

             X           Y
1   0.21011439 -0.02520581
2   0.24295090 -0.08508453
3  -0.02920928 -0.01669879
4  -0.26589080 -0.09914647
5  -0.28990167 -0.06520709
6  -0.31064171 -0.03292885
7  -0.30486638  0.04909758
8  -0.17663351  0.11126334
9   0.04965576  0.11462982
10  0.24051813  0.08066616
11  0.63390416 -0.03138536

, , P_serratus

             X           Y
1   0.20818334 -0.01415801
2   0.24119812 -0.07686512
3  -0.02305482 -0.01291846
4  -0.26423369 -0.09713612
5  -0.28717057 -0.06784749
6  -0.31456554 -0.03659827
7  -0.31427636  0.04125976
8  -0.17824200  0.10593720
9   0.06164380  0.12160978
10  0.24058299  0.08262449
11  0.62993474 -0.04590775

, , P_shenandoah

             X           Y
1   0.21579765 -0.01726806
2   0.25672979 -0.06960327
3  -0.01906112 -0.01690242
4  -0.26666124 -0.09501735
5  -0.29025387 -0.06444754
6  -0.31994500 -0.03222086
7  -0.31409080  0.04255455
8  -0.17727722  0.10439896
9   0.05385606  0.11357742
10  0.23909884  0.07776279
11  0.62180691 -0.04283423

, , P_virginia

             X           Y
1   0.21478687 -0.01844535
2   0.25156003 -0.07532063
3  -0.03797741 -0.01560252
4  -0.25896508 -0.09180671
5  -0.28861103 -0.05863990
6  -0.31890576 -0.02625082
7  -0.31275958  0.03519037
8  -0.16889451  0.10001765
9   0.04165959  0.10916447
10  0.24666034  0.08098191
11  0.63144654 -0.03928848


$Csize
      P_cinereus P_electromorphus       P_hoffmani      P_hubrichti 
        1.000195         1.000134         1.000130         1.000226 
      P_nettingi      P_richmondi       P_serratus     P_shenandoah 
        1.000642         1.000129         1.000379         1.000292 
      P_virginia 
        1.000335 

$d
                 P_cinereus P_electromorphus P_hoffmani P_hubrichti P_nettingi
P_electromorphus 0.02981890                                                   
P_hoffmani       0.02850929       0.02715724                                  
P_hubrichti      0.03523416       0.03010539 0.02832740                       
P_nettingi       0.04727517       0.04546351 0.03382725  0.03231336           
P_richmondi      0.02834280       0.01636811 0.03052226  0.02293346 0.04002223
P_serratus       0.02450219       0.03129608 0.03844946  0.03503221 0.05511893
P_shenandoah     0.01264766       0.03340326 0.02989239  0.03793174 0.05146378
P_virginia       0.03190935       0.03139221 0.02786956  0.03340683 0.05355207
                 P_richmondi P_serratus P_shenandoah
P_electromorphus                                    
P_hoffmani                                          
P_hubrichti                                         
P_nettingi                                          
P_richmondi                                         
P_serratus        0.03004204                        
P_shenandoah      0.03486126 0.02654262             
P_virginia        0.03488261 0.03836789   0.03241539

$group
[1]  1  1  1  1  2  2  2  2 NA

attr(,"class")
[1] "geomorph.data.frame"
> ndf <- na.omit(gdf)
> ndf
$coords
, , P_cinereus

             X           Y
1   0.21608543 -0.02080338
2   0.25310261 -0.07708298
3  -0.01792156 -0.01448663
4  -0.26651651 -0.09752395
5  -0.28724162 -0.06453206
6  -0.31967119 -0.03239812
7  -0.31362497  0.04171542
8  -0.17675527  0.10909565
9   0.05039109  0.11565174
10  0.23977149  0.08099904
11  0.62238049 -0.04063474

, , P_electromorphus

             X           Y
1   0.20836367 -0.02140531
2   0.24409833 -0.07723167
3  -0.02977598 -0.01275263
4  -0.26427414 -0.09970880
5  -0.28743030 -0.06481155
6  -0.31243134 -0.03300287
7  -0.30722191  0.04972560
8  -0.17365967  0.10841289
9   0.04485841  0.11313202
10  0.23906577  0.07161864
11  0.63840715 -0.03397633

, , P_hoffmani

             X           Y
1   0.21459121 -0.02287960
2   0.24756106 -0.07822209
3  -0.02375710 -0.01304699
4  -0.26003800 -0.09162166
5  -0.29093913 -0.05923147
6  -0.32328269 -0.02648361
7  -0.31321860  0.04070778
8  -0.17360458  0.10475086
9   0.05043677  0.10368721
10  0.24107282  0.06939060
11  0.63117824 -0.02705104

, , P_hubrichti

             X           Y
1   0.21443964 -0.02119811
2   0.24499372 -0.08828434
3  -0.03901225 -0.01855381
4  -0.25951827 -0.09138193
5  -0.29217428 -0.06366227
6  -0.31517233 -0.03103907
7  -0.30835717  0.04609711
8  -0.17899031  0.10645896
9   0.06059128  0.11017621
10  0.24377493  0.07836204
11  0.62942504 -0.02697478

, , P_nettingi

             X           Y
1   0.21654559 -0.02813895
2   0.24704810 -0.09648021
3  -0.02436038 -0.01854270
4  -0.25450293 -0.09034384
5  -0.29784646 -0.06316524
6  -0.31950340 -0.02972654
7  -0.31454020  0.04911675
8  -0.17753572  0.11756629
9   0.05885615  0.10519037
10  0.24159021  0.06598143
11  0.62424903 -0.01145736

, , P_richmondi

             X           Y
1   0.21011439 -0.02520581
2   0.24295090 -0.08508453
3  -0.02920928 -0.01669879
4  -0.26589080 -0.09914647
5  -0.28990167 -0.06520709
6  -0.31064171 -0.03292885
7  -0.30486638  0.04909758
8  -0.17663351  0.11126334
9   0.04965576  0.11462982
10  0.24051813  0.08066616
11  0.63390416 -0.03138536

, , P_serratus

             X           Y
1   0.20818334 -0.01415801
2   0.24119812 -0.07686512
3  -0.02305482 -0.01291846
4  -0.26423369 -0.09713612
5  -0.28717057 -0.06784749
6  -0.31456554 -0.03659827
7  -0.31427636  0.04125976
8  -0.17824200  0.10593720
9   0.06164380  0.12160978
10  0.24058299  0.08262449
11  0.62993474 -0.04590775

, , P_shenandoah

             X           Y
1   0.21579765 -0.01726806
2   0.25672979 -0.06960327
3  -0.01906112 -0.01690242
4  -0.26666124 -0.09501735
5  -0.29025387 -0.06444754
6  -0.31994500 -0.03222086
7  -0.31409080  0.04255455
8  -0.17727722  0.10439896
9   0.05385606  0.11357742
10  0.23909884  0.07776279
11  0.62180691 -0.04283423


$Csize
[1] 1.000195 1.000134 1.000130 1.000226 1.000642 1.000129 1.000379 1.000292

$d
                 P_cinereus P_electromorphus P_hoffmani P_hubrichti P_nettingi
P_electromorphus 0.02981890                                                   
P_hoffmani       0.02850929       0.02715724                                  
P_hubrichti      0.03523416       0.03010539 0.02832740                       
P_nettingi       0.04727517       0.04546351 0.03382725  0.03231336           
P_richmondi      0.02834280       0.01636811 0.03052226  0.02293346 0.04002223
P_serratus       0.02450219       0.03129608 0.03844946  0.03503221 0.05511893
P_shenandoah     0.01264766       0.03340326 0.02989239  0.03793174 0.05146378
                 P_richmondi P_serratus
P_electromorphus                       
P_hoffmani                             
P_hubrichti                            
P_nettingi                             
P_richmondi                            
P_serratus        0.03004204           
P_shenandoah      0.03486126 0.02654262

$group
[1] 1 1 1 1 2 2 2 2

attr(,"class")
[1] "geomorph.data.frame"
> 
> 
> 
> cleanEx()
> nameEx("phylo.integration")
> ### * phylo.integration
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: phylo.integration
> ### Title: Quantify phylogenetic morphological integration between two or
> ###   more sets of variables under Brownian motion
> ### Aliases: phylo.integration
> ### Keywords: analysis
> 
> ### ** Examples
> 
> 
> data(plethspecies) 
> Y.gpa<-gpagen(plethspecies$land)    #GPA-alignment

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> land.gps<-c("A","A","A","A","A","B","B","B","B","B","B") 
> 
> IT<- phylo.integration(Y.gpa$coords,partition.gp=land.gps,
+   phy=plethspecies$phy,iter=999)

Random PLS calculations: 1000 permutations.
  |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%

> summary(IT) # Test summary

Call:
phylo.integration(A = Y.gpa$coords, phy = plethspecies$phy, partition.gp = land.gps,  
    iter = 999) 



r-PLS: 0.934

Effect Size (Z): 2.1665

P-value: 0.014

Based on 1000 random permutations
> P <- plot(IT) # PLS plot
> 
>  # Block 1 
>  minx <- min(P$plot.args$x)
>  maxx <- max(P$plot.args$x)
>  preds <- shape.predictor(P$A1, 
+  x = P$plot.args$x,
+  min = minx, max = maxx)
>  plotRefToTarget(mshape(P$A1), preds$min)
>  plotRefToTarget(mshape(P$A1), preds$max)
> 
>  # Block 2 
>  miny <- min(P$plot.args$y)
>  maxy <- max(P$plot.args$y)
>  preds <- shape.predictor(P$A2, 
+  x = P$plot.args$y,
+  min = miny, max = maxy)
>  plotRefToTarget(mshape(P$A2), preds$min)
>  plotRefToTarget(mshape(P$A2), preds$max)
>  
>  ### Visualize shape variation using picknplot.shape Because picknplot  
>  ### requires user decisions, the following example
>  ### is not run (but can be with removal of #).
>  ### For detailed options, see the picknplot help file
>  # picknplot.shape(P)
> 
> 
> 
> 
> cleanEx()
> nameEx("phylo.modularity")
> ### * phylo.modularity
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: phylo.modularity
> ### Title: Evaluate the degree of phylogenetic modular signal in Procrustes
> ###   shape variables
> ### Aliases: phylo.modularity
> ### Keywords: analysis
> 
> ### ** Examples
> 
> # Not Run
> # data(plethspecies)
> # Y.gpa<-gpagen(plethspecies$land)    #GPA-alignment
> # land.gps<-c("A","A","A","A","A","B","B","B","B","B","B") 
> 
> # MT <- phylo.modularity(Y.gpa$coords, partition.gp=land.gps, 
> # phy=plethspecies$phy, 
> # CI = FALSE, iter=499)
> # summary(MT) # Test summary
> # plot(MT) # Histogram of CR sampling distribution 
> 
> 
> 
> cleanEx()
> nameEx("physignal")
> ### * physignal
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: physignal
> ### Title: Assessing phylogenetic signal in Procrustes shape variables
> ### Aliases: physignal
> ### Keywords: analysis
> 
> ### ** Examples
> 
> data(plethspecies) 
> Y.gpa<-gpagen(plethspecies$land)    #GPA-alignment    

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> 
> #Test for phylogenetic signal in shape
> PS.shape <- physignal(A=Y.gpa$coords,phy=plethspecies$phy,iter=999)
> summary(PS.shape)

Call:
physignal(A = Y.gpa$coords, phy = plethspecies$phy, iter = 999) 



Observed Phylogenetic Signal (K): 0.9573

P-value: 0.008

Based on 1000 random permutations

 Use physignal.z to estimate effect size.> plot(PS.shape)
> plot(PS.shape$PACA, phylo = TRUE)
> PS.shape$K.by.p # Phylogenetic signal profile
[1] 1.5034858 1.4253457 1.1610972 1.0762048 1.0010464 0.9746155 0.9623519
[8] 0.9572991 0.9572991
> 
> #Test for phylogenetic signal in size
> PS.size <- physignal(A=Y.gpa$Csize,phy=plethspecies$phy,iter=999)
> summary(PS.size)

Call:
physignal(A = Y.gpa$Csize, phy = plethspecies$phy, iter = 999) 



Observed Phylogenetic Signal (K): 0.7098

P-value: 0.477

Based on 1000 random permutations

 Use physignal.z to estimate effect size.> plot(PS.size)
> 
> 
> 
> cleanEx()
> nameEx("physignal.z")
> ### * physignal.z
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: physignal.z
> ### Title: Assessing phylogenetic signal effect size in Procrustes shape
> ###   variables
> ### Aliases: physignal.z
> ### Keywords: analysis
> 
> ### ** Examples
> 
> data(plethspecies) 
> Y.gpa<-gpagen(plethspecies$land)    #GPA-alignment    

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> 
> # Test for phylogenetic signal in shape
> PS.shape <- physignal.z(A = Y.gpa$coords, phy = plethspecies$phy, 
+ lambda = "front", iter=999)
> summary(PS.shape)

Call:
physignal.z(A = Y.gpa$coords, phy = plethspecies$phy, lambda = "front",  
    iter = 999) 

Evaluation of phylogenetic signal effect size
Optimization method: front
Optimization performed in 8 data dimensions.

Observed phylogenetic signal effect size (Z): -0.7628

P-value: 0.711 based on 1000 random permutations

For a model with a log-likelihood of 277.4506
a branch-scaling (lambda) of 1e-04
and a ratio of Bownian Motion fit (K) of 0.8859 
> 
> # Problem with ill-conditioned residual covariance matrix; try shaving one dimension
> 
> PS.shape <- physignal.z(A = Y.gpa$coords, phy = plethspecies$phy, 
+ lambda = "front", PAC.no = 7, iter=999)
> summary(PS.shape)

Call:
physignal.z(A = Y.gpa$coords, phy = plethspecies$phy, lambda = "front",  
    iter = 999, PAC.no = 7) 

Evaluation of phylogenetic signal effect size
Optimization method: front
Optimization performed in 7 data dimensions.

Observed phylogenetic signal effect size (Z): 1.7018

P-value: 0.027 based on 1000 random permutations

For a model with a log-likelihood of 229.8667
a branch-scaling (lambda) of 1e-04
and a ratio of Bownian Motion fit (K) of 0.8901 
> plot(PS.shape)
> plot(PS.shape$PACA, phylo = TRUE)
> 
> # Test for phylogenetic signal in size
> PS.size <- physignal.z(A = Y.gpa$Csize, phy = plethspecies$phy, 
+ lambda = "front", iter=999)
> summary(PS.size)

Call:
physignal.z(A = Y.gpa$Csize, phy = plethspecies$phy, lambda = "front",  
    iter = 999) 

Evaluation of phylogenetic signal effect size
Optimization method: front
Optimization performed in 1 data dimensions.

Observed phylogenetic signal effect size (Z): -0.6985

P-value: 0.741 based on 1000 random permutations

For a model with a log-likelihood of 66.0972
a branch-scaling (lambda) of 1e-04
and a ratio of Bownian Motion fit (K) of 0.6938 
> plot(PS.size)
> 
> 
> 
> cleanEx()
> nameEx("picknplot.shape")
> ### * picknplot.shape
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: picknplot.shape
> ### Title: Pick points in geomorph scatterplots to visualize shape
> ###   variation
> ### Aliases: picknplot.shape
> ### Keywords: visualization
> 
> ### ** Examples
> 
> 
> ### Because picknplot requires user decisions, the following examples
> ### are not run (but can be with removal of #s)
> 
> # 2d
> # data(plethodon) 
> # Y.gpa <- gpagen(plethodon$land)
> # pleth.pca <- gm.prcomp(Y.gpa$coords)
> # pleth.pca.plot <- plot(pleth.pca)
> # picknplot.shape(pleth.pca.plot) 
> # May change arguments for plotRefToTarget
> # picknplot.shape(plot(pleth.pca), method = "points", mag = 3, 
> # links=plethodon$links)
> 
> # 2d with phylogeny
> # data(plethspecies) 
> # Y.gpa <- gpagen(plethspecies$land)
> # gps <- as.factor(c(rep("gp1", 5), rep("gp2", 4))) # Two random groups
> # pleth.phylo <- gm.prcomp(Y.gpa$coords, plethspecies$phy)
> # pleth.phylomorphospace <- plot(pleth.phylo, phylo = TRUE, cex = 2, 
> # pch = 22, bg = gps, phylo.par = list(edge.color = "blue", 
> # edge.width = 2, edge.lty = 2,
> # node.pch = 22, node.bg = "black"))
> # links.species <- plethodon$links[-11,]
> # links.species[11, 1] <- 11
> # picknplot.shape(pleth.phylomorphospace, method = "points", 
> # links = links.species)
> 
> # 2d allometry 
> # gdf <- geomorph.data.frame(Y.gpa, site = plethodon$site, 
> # species = plethodon$species) 
> # fit <- procD.lm(coords ~ log(Csize), data=gdf, iter=0, 
> # print.progress = FALSE)
> # Predline
> # PA <- plotAllometry(fit, size = gdf$Csize, logsz = TRUE, 
> # method = "PredLine", pch = 19)
> # picknplot.shape(PA)
> 
> # 3d and two-b-pls
> # data("scallops")
> # Y.gpa <- gpagen(scallops$coorddata, curves = scallops$curvslide, 
> #              surfaces = scallops$surfslide)
> # PLS <- two.b.pls(Y.gpa$coords, Y.gpa$Csize)
> # PLS.plot = plot(PLS)
> # picknplot.shape(PLS.plot)
> 
> 
> 
> cleanEx()
> nameEx("plotAllSpecimens")
> ### * plotAllSpecimens
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotAllSpecimens
> ### Title: Plot landmark coordinates for all specimens
> ### Aliases: plotAllSpecimens
> ### Keywords: visualization
> 
> ### ** Examples
> 
> data(plethodon) 
> Y.gpa<-gpagen(plethodon$land)    #GPA-alignment

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> 
> plotAllSpecimens(Y.gpa$coords,links=plethodon$links)
> 
> 
> 
> cleanEx()
> nameEx("plotAllometry")
> ### * plotAllometry
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotAllometry
> ### Title: Plotting to assist visualization of shape-size covariation
> ###   (allometry)
> ### Aliases: plotAllometry
> ### Keywords: utilities
> 
> ### ** Examples
> 
> 
> # Simple allometry
> data(plethodon) 
> Y.gpa <- gpagen(plethodon$land, print.progress = FALSE)    #GPA-alignment  
> 
> gdf <- geomorph.data.frame(Y.gpa, site = plethodon$site, 
+ species = plethodon$species) 
> fit <- procD.lm(coords ~ log(Csize), data=gdf, iter=0, 
+ print.progress = FALSE)
> 
> # Predline
> plotAllometry(fit, size = gdf$Csize, logsz = TRUE, 
+ method = "PredLine", pch = 19)
> 
> # same as
> logSize <- log(gdf$Csize)
> plot(fit, type = "regression", reg.type = "PredLine", 
+ predictor = logSize, pch = 19)
> 
> # RegScore
> plotAllometry(fit, size = gdf$Csize, logsz = TRUE, 
+ method = "RegScore", pch = 19)
> 
> # same as
> plot(fit, type = "regression", reg.type = "RegScore", 
+ predictor = logSize, pch = 19)
> 
> # CAC
> plotAllometry(fit, size = gdf$Csize, logsz = TRUE, 
+ method = "CAC", pch = 19)
> 
> # same (first plot) as
> PLS <- two.b.pls(log(gdf$Csize), gdf$coords, print.progress = FALSE)
Data in either A1 or A2 do not have names.  It is assumed data in both A1 and A2 are ordered the same.
> plot(PLS)
> 
> # Group Allometries
> fit <- procD.lm(coords ~ Csize * species * site, data=gdf, iter=0, 
+ print.progress = FALSE)
> 
> # CAC (should not change from last time; model change has no effect)
> plotAllometry(fit, size = gdf$Csize, logsz = TRUE, method = "CAC", 
+ pch = 19)
> 
> # Predline
> plotAllometry(fit, size = gdf$Csize, logsz = TRUE, method = "PredLine", 
+ pch = 19, col = as.numeric(interaction(gdf$species, gdf$site)))
> 
> # RegScore
> plotAllometry(fit, size = gdf$Csize, logsz = TRUE, method = "RegScore", 
+ pch = 19, col = as.numeric(interaction(gdf$species, gdf$site)))
> 
> # Size-Shape PCA
> 
> pc.plot <- plotAllometry(fit, size = gdf$Csize, logsz = TRUE, 
+ method = "size.shape", 
+ pch = 19, col = as.numeric(interaction(gdf$species, gdf$site)))
> summary(pc.plot$size.shape.PCA)
Importance of components:
                          PC1     PC2     PC3     PC4     PC5     PC6     PC7
Standard deviation     0.1607 0.04302 0.03771 0.01985 0.01492 0.01314 0.01291
Proportion of Variance 0.8428 0.06044 0.04643 0.01287 0.00727 0.00563 0.00544
Cumulative Proportion  0.8428 0.90328 0.94971 0.96258 0.96985 0.97548 0.98093
                           PC8      PC9    PC10     PC11     PC12     PC13
Standard deviation     0.01217 0.009205 0.00901 0.008189 0.007239 0.006479
Proportion of Variance 0.00483 0.002770 0.00265 0.002190 0.001710 0.001370
Cumulative Proportion  0.98576 0.988530 0.99118 0.993370 0.995080 0.996450
                           PC14     PC15     PC16     PC17     PC18     PC19
Standard deviation     0.005112 0.004286 0.004155 0.003962 0.003686 0.003026
Proportion of Variance 0.000850 0.000600 0.000560 0.000510 0.000440 0.000300
Cumulative Proportion  0.997300 0.997900 0.998470 0.998980 0.999420 0.999720
                           PC20     PC21      PC22      PC23      PC24
Standard deviation     0.002242 0.001862 1.334e-15 2.885e-16 1.415e-16
Proportion of Variance 0.000160 0.000110 0.000e+00 0.000e+00 0.000e+00
Cumulative Proportion  0.999890 1.000000 1.000e+00 1.000e+00 1.000e+00
                            PC25
Standard deviation     1.081e-17
Proportion of Variance 0.000e+00
Cumulative Proportion  1.000e+00
> 
> # Are species' shape differences just a manifestation of shape allometry?
> 
> fit3 <- procD.lm(coords ~ species, data = gdf, iter = 0, 
+ print.progress = FALSE)
> plotAllometry(fit3, size = gdf$Csize, logsz = TRUE, method = "RegScore", 
+ pch = 19, col = as.numeric(gdf$species))
> 
> # No evidence this is the case
> 
> 
> 
> 
> cleanEx()
> nameEx("plotOutliers")
> ### * plotOutliers
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotOutliers
> ### Title: Find potential outliers
> ### Aliases: plotOutliers
> ### Keywords: utilities
> 
> ### ** Examples
> 
> data(plethodon)
> # let's make some outliers
> newland <- plethodon$land
> newland[c(1,8),,2] <- newland[c(8,1),,2]
> newland[c(3,11),,26] <- newland[c(11,3),,2]
> Y<- gpagen(newland) # GPA

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================================                  |  75%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> out <- plotOutliers(Y$coords) # function returns dimnames and address 
> # of all specimens ordered
> plotOutliers(Y$coords, inspect.outliers = TRUE) # function also produces 
26  2 14 27  4  5  3 12  9  6 10 11 19 13  1 29 20 22  7 15 16 31 37 34 21 40 
26  2 14 27  4  5  3 12  9  6 10 11 19 13  1 29 20 22  7 15 16 31 37 34 21 40 
38 18  8 17 30 32 36 24 33 35 23 25 28 39 
38 18  8 17 30 32 36 24 33 35 23 25 28 39 
> # plots of identified outlier specimens compared to the mean shape
> 
> # example with groups
> plotOutliers(Y$coords, groups = plethodon$species, 
+ inspect.outliers = TRUE)
$Jord
16  2 17 12 19 11  9  4  6  1  5  3 10  7 14 20 13 15  8 18 
16  2 17 12 19 11  9  4  6  1  5  3 10  7 14 20 13 15  8 18 

$Teyah
 4 14 11 20 17  9  2 16 10 15  5  3  1 18  6 12 13  8  7 19 
 4 14 11 20 17  9  2 16 10 15  5  3  1 18  6 12 13  8  7 19 

>  
> 
> 
> 
> cleanEx()
> nameEx("plotRefToTarget")
> ### * plotRefToTarget
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotRefToTarget
> ### Title: Plot shape differences between a reference and target specimen
> ### Aliases: plotRefToTarget
> ### Keywords: visualization
> 
> ### ** Examples
> 
> # Not Run
> # Two dimensional data
> # data(plethodon) 
> # Y.gpa<-gpagen(plethodon$land)    #GPA-alignment
> # ref<-mshape(Y.gpa$coords)
> # plotRefToTarget(ref,Y.gpa$coords[,,39])
> # plotRefToTarget(ref,Y.gpa$coords[,,39], mag=2, outline=plethodon$outline)   
> #magnify by 2X
> # plotRefToTarget(ref,Y.gpa$coords[,,39], method="vector", mag=3)
> # plotRefToTarget(ref,Y.gpa$coords[,,39], method="points", 
> # outline=plethodon$outline)
> # plotRefToTarget(ref,Y.gpa$coords[,,39], method="vector", 
> # outline=plethodon$outline, mag=2.5)
> # plotRefToTarget(ref,Y.gpa$coords[,,39], 
> # gridPars=gridPar(pt.bg = "green", pt.size = 1),
> # method="vector",mag=3)
> 
> # Three dimensional data
> # data(scallops)
> # Y.gpa<-gpagen(A=scallops$coorddata, curves=scallops$curvslide, 
> # surfaces=scallops$surfslide)
> # ref<-mshape(Y.gpa$coords)
> # plotRefToTarget(ref,Y.gpa$coords[,,1],method="points")
> # scallinks <- matrix(c(1,rep(2:16, each=2),1), nrow=16, byrow=TRUE)
> # plotRefToTarget(ref,Y.gpa$coords[,,1],
> # gridPars=gridPar(tar.pt.bg = "blue", tar.link.col="blue",
> # tar.link.lwd=2), method="points", links = scallinks)
> 
> 
> 
> 
> cleanEx()
> nameEx("plotspec")
> ### * plotspec
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: plotspec
> ### Title: Plot 3D specimen, fixed landmarks and surface semilandmarks
> ### Aliases: plotspec
> ### Keywords: visualization
> 
> ### ** Examples
> 
> 
> ## Not Run
> # data(scallopPLY)
> # ply <- scallopPLY$ply
> # digitdat <- scallopPLY$coords
> # plotspec(spec = ply, digitspec = digitdat, fixed = 16, 
> # centered = TRUE, fixed.pt.col = "red", 
> # fixed.pt.size = 15, col = "blue", size = 5)
> 
> 
> 
> cleanEx()
> nameEx("procD.lm")
> ### * procD.lm
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: procD.lm
> ### Title: Procrustes ANOVA/regression for Procrustes shape variables
> ### Aliases: procD.lm
> ### Keywords: analysis
> 
> ### ** Examples
> 
> ## Not run: 
> ##D ### ANOVA example for Goodall's F test (multivariate shape vs. factors)
> ##D data(plethodon) 
> ##D Y.gpa <- gpagen(plethodon$land)    #GPA-alignment  
> ##D gdf <- geomorph.data.frame(Y.gpa, 
> ##D site = plethodon$site, 
> ##D species = plethodon$species) # geomorph data frame
> ##D 
> ##D fit1 <- procD.lm(coords ~ species * site, 
> ##D data = gdf, iter = 999, turbo = TRUE,
> ##D RRPP = FALSE, print.progress = FALSE) # randomize raw values
> ##D fit2 <- procD.lm(coords ~ species * site, 
> ##D data = gdf, iter = 999, turbo = TRUE,
> ##D RRPP = TRUE, print.progress = FALSE) # randomize residuals
> ##D 
> ##D summary(fit1)
> ##D summary(fit2)
> ##D 
> ##D # RRPP example applications
> ##D 
> ##D coef(fit2)
> ##D coef(fit2, test = TRUE)
> ##D anova(fit2) # same as summary
> ##D anova(fit2, effect.type = "Rsq")
> ##D # if species and site were modeled as random effects ...
> ##D anova(fit2, error = c("species:site", "species:site", "Residuals"))  
> ##D # not run, because it is a large object to print 
> ##D # remove # to run
> ##D # predict(fit2) 
> ##D 
> ##D # TPS plots for fitted values of some specimens
> ##D 
> ##D M <- Y.gpa$consensus
> ##D plotRefToTarget(M, fit2$GM$fitted[,,1], mag = 3)
> ##D plotRefToTarget(M, fit2$GM$fitted[,,20], mag = 3)
> ##D 
> ##D ### THE FOLLOWING ILLUSTRATES SIMPLER SOLUTIONS FOR 
> ##D ### THE NOW DEPRECATED advanced.procD.lm FUNCTION AND
> ##D ### PERFORM ANALYSES ALSO FOUND VIA THE morphol.disparity FUNCTION
> ##D ### USING THE pairwise FUNCTION
> ##D 
> ##D # Comparison of LS means, with log(Csize) as a covariate
> ##D 
> ##D # Model fits
> ##D fit.null <- procD.lm(coords ~ log(Csize) + species + site, data = gdf, 
> ##D iter = 999, print.progress = FALSE, turbo = TRUE)
> ##D fit.full <- procD.lm(coords ~ log(Csize) + species * site, data = gdf, 
> ##D iter = 999, print.progress = FALSE, turbo = TRUE)
> ##D 
> ##D # ANOVA, using anova.lm.rrpp function from the RRPP package 
> ##D # (replaces advanced.procD.lm)
> ##D anova(fit.null, fit.full, print.progress = FALSE)
> ##D 
> ##D # Pairwise tests, using pairwise function from the RRPP package
> ##D gp <-  interaction(gdf$species, gdf$site)
> ##D 
> ##D PW <- pairwise(fit.full, groups = gp, covariate = NULL)
> ##D 
> ##D # Pairwise distances between means, summarized two ways 
> ##D # (replaces advanced.procD.lm):
> ##D summary(PW, test.type = "dist", confidence = 0.95, stat.table = TRUE)
> ##D summary(PW, test.type = "dist", confidence = 0.95, stat.table = FALSE)
> ##D 
> ##D # Pairwise comaprisons of group variances, two ways 
> ##D # (same as morphol.disaprity):
> ##D summary(PW, test.type = "var", confidence = 0.95, stat.table = TRUE)
> ##D summary(PW, test.type = "var", confidence = 0.95, stat.table = FALSE)
> ##D morphol.disparity(fit.full, groups = gp, iter = 999)
> ##D 
> ##D ### Regression example
> ##D data(ratland)
> ##D rat.gpa<-gpagen(ratland)         #GPA-alignment
> ##D gdf <- geomorph.data.frame(rat.gpa) # geomorph data frame is easy 
> ##D # without additional input
> ##D 
> ##D fit <- procD.lm(coords ~ Csize, data = gdf, iter = 999, turbo = TRUE,
> ##D RRPP = TRUE, print.progress = FALSE) 
> ##D summary(fit)
> ##D 
> ##D ### Extracting objects and plotting options
> ##D # diagnostic plots
> ##D plot(fit, type = "diagnostics") 
> ##D # diagnostic plots, including plotOutliers
> ##D plot(fit, type = "diagnostics", outliers = TRUE) 
> ##D 
> ##D # PC plot rotated to major axis of fitted values
> ##D plot(fit, type = "PC", pch = 19, col = "blue") 
> ##D # Regression-type plots 
> ##D 
> ##D # Use fitted values from the model to make prediction lines
> ##D plot(fit, type = "regression", 
> ##D predictor = gdf$Csize, reg.type = "RegScore", 
> ##D pch = 19, col = "green")
> ##D 
> ##D # Uses coefficients from the model to find the projected regression 
> ##D # scores
> ##D rat.plot <- plot(fit, type = "regression", 
> ##D predictor = gdf$Csize, reg.type = "RegScore", 
> ##D pch = 21, bg = "yellow") 
> ##D 
> ##D # TPS grids for min and max scores in previous plot
> ##D preds <- shape.predictor(fit$GM$fitted, x = rat.plot$RegScore, 
> ##D                         predmin = min(rat.plot$RegScore), 
> ##D                         predmax = max(rat.plot$RegScore))
> ##D M <- rat.gpa$consensus
> ##D plotRefToTarget(M, preds$predmin, mag=2)
> ##D plotRefToTarget(M, preds$predmax, mag=2)
> ##D                         
> ##D attributes(fit)
> ##D fit$fitted[1:3, ] # the fitted values (first three specimens)
> ##D fit$GM$fitted[,, 1:3] # the fitted values as Procrustes 
> ##D # coordinates (same specimens)
> ##D 
> ##D ### THE FOLLOWING ILLUSTRATES SIMPLER SOLUTIONS FOR 
> ##D ### THE NOW DEFUNCT nested.update FUNCTION USING
> ##D ### THE anova GENERIC FUNCTION
> ##D 
> ##D data("larvalMorph")
> ##D Y.gpa <- gpagen(larvalMorph$tailcoords, 
> ##D curves = larvalMorph$tail.sliders,
> ##D ProcD = TRUE, print.progress = FALSE)
> ##D gdf <- geomorph.data.frame(Y.gpa, treatment = larvalMorph$treatment, 
> ##D family = larvalMorph$family)
> ##D 
> ##D fit <- procD.lm(coords ~ treatment/family, data = gdf, turbo = TRUE,
> ##D print.progress = FALSE, iter = 999)
> ##D anova(fit) # treatment effect not adjusted
> ##D anova(fit, error = c("treatment:family", "Residuals")) 
> ##D # treatment effect updated (adjusted)
> ## End(Not run)
> 
> 
> 
> 
> 
> 
> cleanEx()
> nameEx("procD.pgls")
> ### * procD.pgls
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: procD.pgls
> ### Title: Phylogenetic ANOVA/regression for Procrustes shape variables
> ### Aliases: procD.pgls
> ### Keywords: analysis
> 
> ### ** Examples
> 
> ### Example of D-PGLS for high-dimensional data 
> data(plethspecies)
> Y.gpa<-gpagen(plethspecies$land)    #GPA-alignment

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> gdf <- geomorph.data.frame(Y.gpa, phy = plethspecies$phy)
> 
> pleth.pgls <- procD.pgls(coords ~ Csize, phy = phy, data = gdf, 
+ iter = 999)

Please be aware that printing progress slows down the analysis (perhaps slightly).

Preliminary Model Fit...

Sums of Squares calculations: 1000 permutations.
  |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%
> anova(pleth.pgls)

Analysis of Variance, using Residual Randomization
Permutation procedure: Randomization of null model residuals 
Number of permutations: 1000 
Estimation method: Generalized Least-Squares (via OLS projection) 
Sums of Squares and Cross-products: Type I 
Effect sizes (Z) based on F distributions

          Df       SS        MS     Rsq      F       Z Pr(>F)
Csize      1 0.006812 0.0068121 0.15732 1.3068 0.55586  0.299
Residuals  7 0.036490 0.0052129 0.84268                      
Total      8 0.043302                                        

Call: procD.lm(f1 = coords ~ Csize, iter = iter, seed = seed, RRPP = TRUE,  
    SS.type = SS.type, effect.type = effect.type, int.first = int.first,  
    Cov = Cov, data = data, print.progress = print.progress)
> summary(pleth.pgls)  #similar output

Analysis of Variance, using Residual Randomization
Permutation procedure: Randomization of null model residuals 
Number of permutations: 1000 
Estimation method: Generalized Least-Squares (via OLS projection) 
Sums of Squares and Cross-products: Type I 
Effect sizes (Z) based on F distributions

          Df       SS        MS     Rsq      F       Z Pr(>F)
Csize      1 0.006812 0.0068121 0.15732 1.3068 0.55586  0.299
Residuals  7 0.036490 0.0052129 0.84268                      
Total      8 0.043302                                        

Call: procD.lm(f1 = coords ~ Csize, iter = iter, seed = seed, RRPP = TRUE,  
    SS.type = SS.type, effect.type = effect.type, int.first = int.first,  
    Cov = Cov, data = data, print.progress = print.progress)
> 
> ### Working with procD.pgls objects
> predict(pleth.pgls)

Linear Model fit with lm.rrpp

Number of predictions: 9
Confidence level: 95 %
Number of bootstrap permutations: 1000

Predicted values (mean of bootstrapped values):

        1.X         1.Y       2.X         2.Y         3.X         3.Y
1 0.2125900 -0.02070487 0.2473196 -0.07872911 -0.02707564 -0.01490797
2 0.2121199 -0.02045381 0.2470273 -0.07741623 -0.02703351 -0.01446153
3 0.2120895 -0.02043758 0.2470084 -0.07733132 -0.02703078 -0.01443265
4 0.2128254 -0.02083063 0.2474660 -0.07938676 -0.02709674 -0.01513160
5 0.2160139 -0.02253364 0.2494490 -0.08829255 -0.02738253 -0.01815999
6 0.2120826 -0.02043390 0.2470041 -0.07731208 -0.02703016 -0.01442611
7 0.2140006 -0.02145830 0.2481969 -0.08266911 -0.02720207 -0.01624775
8 0.2133344 -0.02110250 0.2477826 -0.08080849 -0.02714237 -0.01561505
9 0.2136627 -0.02127782 0.2479867 -0.08172533 -0.02717179 -0.01592682
         4.X         4.Y        5.X         5.Y        6.X         6.Y
1 -0.2635586 -0.09576044 -0.2891430 -0.06358069 -0.3166873 -0.03138897
2 -0.2645368 -0.09644615 -0.2883673 -0.06363672 -0.3163578 -0.03154185
3 -0.2646001 -0.09649049 -0.2883171 -0.06364035 -0.3163365 -0.03155173
4 -0.2630686 -0.09541695 -0.2895316 -0.06355262 -0.3168524 -0.03131239
5 -0.2564331 -0.09076552 -0.2947938 -0.06317251 -0.3190876 -0.03027539
6 -0.2646144 -0.09650054 -0.2883057 -0.06364117 -0.3163317 -0.03155397
7 -0.2606230 -0.09370261 -0.2914710 -0.06341253 -0.3176762 -0.03093019
8 -0.2620093 -0.09467439 -0.2903716 -0.06349194 -0.3172092 -0.03114685
9 -0.2613262 -0.09419554 -0.2909134 -0.06345281 -0.3174393 -0.03104009
         7.X        7.Y        8.X       8.Y        9.X       9.Y      10.X
1 -0.3105477 0.04395691 -0.1756483 0.1066765 0.05142884 0.1124276 0.2409528
2 -0.3098457 0.04399599 -0.1756051 0.1060148 0.05068886 0.1128273 0.2406383
3 -0.3098003 0.04399852 -0.1756023 0.1059720 0.05064100 0.1128531 0.2406180
4 -0.3108993 0.04393733 -0.1756700 0.1070080 0.05179952 0.1122274 0.2411103
5 -0.3156609 0.04367220 -0.1759632 0.1114970 0.05681909 0.1095165 0.2432435
6 -0.3097900 0.04399909 -0.1756016 0.1059623 0.05063016 0.1128590 0.2406134
7 -0.3126543 0.04383961 -0.1757780 0.1086625 0.05364955 0.1112283 0.2418965
8 -0.3116594 0.04389500 -0.1757168 0.1077246 0.05260084 0.1117947 0.2414509
9 -0.3121496 0.04386771 -0.1757470 0.1081868 0.05311760 0.1115156 0.2416705
        10.Y      11.X        11.Y
1 0.07722771 0.6303693 -0.03521670
2 0.07776904 0.6312718 -0.03665076
3 0.07780405 0.6313301 -0.03674350
4 0.07695655 0.6299173 -0.03449836
5 0.07328455 0.6237956 -0.02477064
6 0.07781198 0.6313433 -0.03676452
7 0.07560319 0.6276610 -0.03091308
8 0.07637035 0.6289400 -0.03294542
9 0.07599233 0.6283098 -0.03194396


 95 % Lower confidence limits:

        1.X         1.Y       2.X         2.Y         3.X         3.Y
1 0.2108429 -0.02314004 0.2443836 -0.08271203 -0.03097556 -0.01606192
2 0.2099662 -0.02366692 0.2429105 -0.08275895 -0.03221130 -0.01600567
3 0.2099006 -0.02371234 0.2428098 -0.08275742 -0.03232869 -0.01600353
4 0.2112019 -0.02286939 0.2450456 -0.08275134 -0.03069136 -0.01612206
5 0.2111947 -0.02880133 0.2420429 -0.09906428 -0.03975875 -0.02140026
6 0.2098836 -0.02372044 0.2427828 -0.08276532 -0.03235508 -0.01600305
7 0.2122054 -0.02368269 0.2456236 -0.08657641 -0.03177613 -0.01749778
8 0.2119063 -0.02262108 0.2459106 -0.08336965 -0.03026572 -0.01647342
9 0.2121798 -0.02299814 0.2459769 -0.08471461 -0.03077952 -0.01694341
         4.X         4.Y        5.X         5.Y        6.X         6.Y
1 -0.2653599 -0.09749720 -0.2906038 -0.06530181 -0.3189387 -0.03326643
2 -0.2669355 -0.09884701 -0.2903422 -0.06605399 -0.3193002 -0.03411097
3 -0.2670386 -0.09893286 -0.2903340 -0.06611412 -0.3193316 -0.03417211
4 -0.2645983 -0.09684764 -0.2907725 -0.06495463 -0.3187452 -0.03291385
5 -0.2616257 -0.09566244 -0.2984539 -0.06753919 -0.3255915 -0.03540941
6 -0.2670627 -0.09895197 -0.2903338 -0.06612431 -0.3193410 -0.03418715
7 -0.2624626 -0.09536515 -0.2928343 -0.06492112 -0.3199644 -0.03275005
8 -0.2632014 -0.09569141 -0.2912862 -0.06463679 -0.3188999 -0.03256204
9 -0.2627118 -0.09537092 -0.2919596 -0.06467682 -0.3193300 -0.03253079
         7.X        7.Y        8.X       8.Y        9.X       9.Y      10.X
1 -0.3121983 0.04123872 -0.1775808 0.1041767 0.04800481 0.1092276 0.2394959
2 -0.3121079 0.04040757 -0.1783997 0.1026722 0.04595902 0.1083875 0.2384804
3 -0.3121005 0.04034464 -0.1784438 0.1025895 0.04582177 0.1083192 0.2384175
4 -0.3122733 0.04154992 -0.1772311 0.1048196 0.04882678 0.1095558 0.2399481
5 -0.3201573 0.03605694 -0.1801774 0.1044973 0.04721862 0.1012962 0.2399081
6 -0.3120978 0.04033038 -0.1784538 0.1025711 0.04579066 0.1083037 0.2384032
7 -0.3142581 0.04119595 -0.1773314 0.1061773 0.05011239 0.1081577 0.2407235
8 -0.3126329 0.04185358 -0.1766499 0.1057424 0.04987479 0.1094887 0.2407680
9 -0.3133579 0.04163709 -0.1768858 0.1060834 0.05016169 0.1088968 0.2408173
        10.Y      11.X        11.Y
1 0.07404471 0.6277267 -0.04053776
2 0.07376629 0.6278193 -0.04328780
3 0.07373192 0.6278442 -0.04348463
4 0.07416735 0.6274043 -0.03909797
5 0.06394327 0.6160560 -0.03996840
6 0.07372414 0.6278499 -0.04353669
7 0.07216837 0.6247727 -0.03625905
8 0.07410976 0.6268027 -0.03667314
9 0.07338067 0.6259731 -0.03614503


 95 % Upper confidence limits:

        1.X         1.Y       2.X         2.Y         3.X         3.Y
1 0.2144881 -0.01850039 0.2500325 -0.07494020 -0.02279332 -0.01371336
2 0.2148658 -0.01754702 0.2506259 -0.07231352 -0.02091106 -0.01286104
3 0.2148815 -0.01745407 0.2506433 -0.07214026 -0.02080605 -0.01280567
4 0.2143914 -0.01886721 0.2499494 -0.07602793 -0.02363451 -0.01409243
5 0.2204490 -0.01616694 0.2577286 -0.07747311 -0.01650566 -0.01512374
6 0.2148850 -0.01743395 0.2506575 -0.07210676 -0.02078199 -0.01279312
7 0.2155596 -0.01912193 0.2511389 -0.07879760 -0.02319898 -0.01519893
8 0.2143780 -0.01928072 0.2499623 -0.07806955 -0.02461895 -0.01480580
9 0.2148596 -0.01932494 0.2504133 -0.07867855 -0.02408337 -0.01506125
         4.X         4.Y        5.X         5.Y        6.X         6.Y
1 -0.2616561 -0.09403737 -0.2877629 -0.06190631 -0.3144135 -0.02948341
2 -0.2619411 -0.09425102 -0.2865920 -0.06148562 -0.3132013 -0.02893031
3 -0.2619565 -0.09426432 -0.2865163 -0.06143453 -0.3131102 -0.02890983
4 -0.2614437 -0.09390865 -0.2883145 -0.06206491 -0.3149184 -0.02958214
5 -0.2515564 -0.08597862 -0.2909747 -0.05824718 -0.3130197 -0.02487435
6 -0.2619594 -0.09426737 -0.2864994 -0.06142915 -0.3130860 -0.02890523
7 -0.2587646 -0.09183763 -0.2900851 -0.06159737 -0.3155109 -0.02890823
8 -0.2607934 -0.09337106 -0.2893399 -0.06221728 -0.3158006 -0.02976742
9 -0.2598954 -0.09275601 -0.2897598 -0.06202967 -0.3158084 -0.02946626
         7.X        7.Y        8.X       8.Y        9.X       9.Y      10.X
1 -0.3089748 0.04658643 -0.1739131 0.1091238 0.05514891 0.1154392 0.2422276
2 -0.3078015 0.04766874 -0.1735501 0.1094607 0.05581488 0.1168048 0.2422008
3 -0.3077195 0.04774492 -0.1735142 0.1094739 0.05586656 0.1169121 0.2422034
4 -0.3095300 0.04612212 -0.1740290 0.1090564 0.05500205 0.1148121 0.2423133
5 -0.3110445 0.05102091 -0.1709283 0.1186559 0.06595650 0.1180379 0.2471930
6 -0.3076973 0.04776218 -0.1735108 0.1094838 0.05587279 0.1169409 0.2422031
7 -0.3109018 0.04648639 -0.1739165 0.1111315 0.05702791 0.1144971 0.2434470
8 -0.3104886 0.04552846 -0.1741406 0.1093705 0.05497998 0.1142336 0.2426261
9 -0.3107739 0.04588706 -0.1740803 0.1101350 0.05589362 0.1142679 0.2429825
        10.Y      11.X        11.Y
1 0.08044550 0.6332177 -0.02979484
2 0.08223399 0.6352662 -0.02911016
3 0.08235051 0.6353971 -0.02905601
4 0.07952699 0.6323066 -0.02980443
5 0.08176674 0.6306076 -0.01030484
6 0.08237737 0.6354265 -0.02904374
7 0.07864298 0.6300743 -0.02562216
8 0.07828891 0.6307884 -0.02944034
9 0.07823311 0.6302568 -0.02785672


> plot(pleth.pgls, type="regression", reg.type="RegScore", 
+ predictor = gdf$Csize)
> attributes(pleth.pgls) # Note the PGLS object
$names
 [1] "aov.table"         "call"              "pgls.coefficients"
 [4] "Y"                 "X"                 "QR"               
 [7] "pgls.fitted"       "pgls.residuals"    "Terms"            
[10] "term.labels"       "data"              "random.SS"        
[13] "call"              "LM"                "ANOVA"            
[16] "PermInfo"          "turbo"             "verbose"          
[19] "subTest"           "pgls.fitted"       "pgls.residuals"   
[22] "pgls.coefficients" "pgls.mean"         "GM"               
[25] "lambda"           

$class
[1] "procD.lm" "lm.rrpp" 

> attributes(pleth.pgls$PGLS) # PGLS details embedded within PGLS object
NULL
> pleth.pgls$LM$Pcov # the projection matrix derived from the 
NULL
> # phylogenetic covariance matrix
> pleth.pgls$pgls.fitted # the PGLS fitted values 
                       1.X         1.Y       2.X         2.Y         3.X
P_cinereus       0.2117224 -0.01876915 0.2466425 -0.07657939 -0.02508257
P_electromorphus 0.2112385 -0.01851259 0.2463324 -0.07525585 -0.02503185
P_hoffmani       0.2112072 -0.01849600 0.2463123 -0.07517026 -0.02502857
P_hubrichti      0.2119647 -0.01889766 0.2467979 -0.07724237 -0.02510798
P_nettingi       0.2152471 -0.02063799 0.2489019 -0.08622039 -0.02545207
P_richmondi      0.2112001 -0.01849224 0.2463078 -0.07515086 -0.02502782
P_serratus       0.2131745 -0.01953908 0.2475734 -0.08055134 -0.02523480
P_shenandoah     0.2124887 -0.01917549 0.2471338 -0.07867563 -0.02516291
P_virginia       0.2128267 -0.01935465 0.2473504 -0.07959990 -0.02519834
                         3.Y        4.X         4.Y        5.X         5.Y
P_cinereus       -0.01416088 -0.2646929 -0.09646336 -0.2880820 -0.06456112
P_electromorphus -0.01370570 -0.2656721 -0.09715279 -0.2873026 -0.06461754
P_hoffmani       -0.01367626 -0.2657354 -0.09719737 -0.2872522 -0.06462118
P_hubrichti      -0.01438889 -0.2642024 -0.09611801 -0.2884725 -0.06453286
P_nettingi       -0.01747657 -0.2575604 -0.09144134 -0.2937597 -0.06415019
P_richmondi      -0.01366959 -0.2657497 -0.09720748 -0.2872407 -0.06462201
P_serratus       -0.01552690 -0.2617544 -0.09439436 -0.2904211 -0.06439183
P_shenandoah     -0.01488181 -0.2631421 -0.09537142 -0.2893165 -0.06447177
P_virginia       -0.01519968 -0.2624583 -0.09488996 -0.2898608 -0.06443238
                        6.X         6.Y        7.X        7.Y        8.X
P_cinereus       -0.3165731 -0.03264783 -0.3114058 0.04290065 -0.1763220
P_electromorphus -0.3162409 -0.03280245 -0.3107058 0.04293365 -0.1762741
P_hoffmani       -0.3162194 -0.03281244 -0.3106605 0.04293578 -0.1762710
P_hubrichti      -0.3167395 -0.03257037 -0.3117565 0.04288413 -0.1763461
P_nettingi       -0.3189929 -0.03152153 -0.3165053 0.04266033 -0.1766714
P_richmondi      -0.3162145 -0.03281471 -0.3106502 0.04293626 -0.1762703
P_serratus       -0.3175700 -0.03218381 -0.3135067 0.04280164 -0.1764660
P_shenandoah     -0.3170992 -0.03240293 -0.3125146 0.04284840 -0.1763980
P_virginia       -0.3173312 -0.03229496 -0.3130035 0.04282536 -0.1764315
                       8.Y        9.X       9.Y      10.X       10.Y      11.X
P_cinereus       0.1058249 0.05336651 0.1148728 0.2405138 0.07904735 0.6299133
P_electromorphus 0.1051577 0.05262616 0.1152772 0.2401975 0.07958747 0.6308327
P_hoffmani       0.1051145 0.05257829 0.1153033 0.2401771 0.07962240 0.6308921
P_hubrichti      0.1061591 0.05373736 0.1146702 0.2406722 0.07877679 0.6294527
P_nettingi       0.1106848 0.05875936 0.1119271 0.2428174 0.07511295 0.6232160
P_richmondi      0.1051048 0.05256744 0.1153092 0.2401724 0.07963032 0.6309056
P_serratus       0.1078271 0.05558828 0.1136592 0.2414628 0.07742644 0.6271541
P_shenandoah     0.1068816 0.05453907 0.1142323 0.2410147 0.07819189 0.6284571
P_virginia       0.1073475 0.05505608 0.1139499 0.2412355 0.07781471 0.6278150
                        11.Y
P_cinereus       -0.03946393
P_electromorphus -0.04090906
P_hoffmani       -0.04100252
P_hubrichti      -0.03874003
P_nettingi       -0.02893718
P_richmondi      -0.04102370
P_serratus       -0.03512706
P_shenandoah     -0.03717510
P_virginia       -0.03616591
> pleth.pgls$GM$pgls.fitted # The same fitted values, in a 3D array
, , P_cinereus

             [,1]        [,2]
 [1,]  0.21172236 -0.01876915
 [2,]  0.24664254 -0.07657939
 [3,] -0.02508257 -0.01416088
 [4,] -0.26469290 -0.09646336
 [5,] -0.28808202 -0.06456112
 [6,] -0.31657309 -0.03264783
 [7,] -0.31140584  0.04290065
 [8,] -0.17632203  0.10582487
 [9,]  0.05336651  0.11487278
[10,]  0.24051378  0.07904735
[11,]  0.62991328 -0.03946393

, , P_electromorphus

             [,1]        [,2]
 [1,]  0.21123848 -0.01851259
 [2,]  0.24633237 -0.07525585
 [3,] -0.02503185 -0.01370570
 [4,] -0.26567207 -0.09715279
 [5,] -0.28730258 -0.06461754
 [6,] -0.31624090 -0.03280245
 [7,] -0.31070578  0.04293365
 [8,] -0.17627406  0.10515769
 [9,]  0.05262616  0.11527716
[10,]  0.24019753  0.07958747
[11,]  0.63083269 -0.04090906

, , P_hoffmani

             [,1]        [,2]
 [1,]  0.21120718 -0.01849600
 [2,]  0.24631231 -0.07517026
 [3,] -0.02502857 -0.01367626
 [4,] -0.26573539 -0.09719737
 [5,] -0.28725217 -0.06462118
 [6,] -0.31621941 -0.03281244
 [7,] -0.31066051  0.04293578
 [8,] -0.17627096  0.10511454
 [9,]  0.05257829  0.11530331
[10,]  0.24017708  0.07962240
[11,]  0.63089215 -0.04100252

, , P_hubrichti

             [,1]        [,2]
 [1,]  0.21196475 -0.01889766
 [2,]  0.24679791 -0.07724237
 [3,] -0.02510798 -0.01438889
 [4,] -0.26420242 -0.09611801
 [5,] -0.28847246 -0.06453286
 [6,] -0.31673950 -0.03257037
 [7,] -0.31175651  0.04288413
 [8,] -0.17634606  0.10615907
 [9,]  0.05373736  0.11467021
[10,]  0.24067220  0.07877679
[11,]  0.62945272 -0.03874003

, , P_nettingi

             [,1]        [,2]
 [1,]  0.21524709 -0.02063799
 [2,]  0.24890190 -0.08622039
 [3,] -0.02545207 -0.01747657
 [4,] -0.25756040 -0.09144134
 [5,] -0.29375972 -0.06415019
 [6,] -0.31899290 -0.03152153
 [7,] -0.31650526  0.04266033
 [8,] -0.17667144  0.11068479
 [9,]  0.05875936  0.11192713
[10,]  0.24281743  0.07511295
[11,]  0.62321600 -0.02893718

, , P_richmondi

             [,1]        [,2]
 [1,]  0.21120009 -0.01849224
 [2,]  0.24630777 -0.07515086
 [3,] -0.02502782 -0.01366959
 [4,] -0.26574974 -0.09720748
 [5,] -0.28724075 -0.06462201
 [6,] -0.31621455 -0.03281471
 [7,] -0.31065025  0.04293626
 [8,] -0.17627026  0.10510476
 [9,]  0.05256744  0.11530924
[10,]  0.24017245  0.07963032
[11,]  0.63090562 -0.04102370

, , P_serratus

             [,1]        [,2]
 [1,]  0.21317450 -0.01953908
 [2,]  0.24757336 -0.08055134
 [3,] -0.02523480 -0.01552690
 [4,] -0.26175442 -0.09439436
 [5,] -0.29042115 -0.06439183
 [6,] -0.31757002 -0.03218381
 [7,] -0.31350673  0.04280164
 [8,] -0.17646598  0.10782708
 [9,]  0.05558828  0.11365921
[10,]  0.24146285  0.07742644
[11,]  0.62715410 -0.03512706

, , P_shenandoah

             [,1]        [,2]
 [1,]  0.21248874 -0.01917549
 [2,]  0.24713379 -0.07867563
 [3,] -0.02516291 -0.01488181
 [4,] -0.26314208 -0.09537142
 [5,] -0.28931652 -0.06447177
 [6,] -0.31709923 -0.03240293
 [7,] -0.31251461  0.04284840
 [8,] -0.17639800  0.10688156
 [9,]  0.05453907  0.11423230
[10,]  0.24101466  0.07819189
[11,]  0.62845709 -0.03717510

, , P_virginia

             [,1]        [,2]
 [1,]  0.21282665 -0.01935465
 [2,]  0.24735040 -0.07959990
 [3,] -0.02519834 -0.01519968
 [4,] -0.26245830 -0.09488996
 [5,] -0.28986084 -0.06443238
 [6,] -0.31733122 -0.03229496
 [7,] -0.31300348  0.04282536
 [8,] -0.17643150  0.10734748
 [9,]  0.05505608  0.11394991
[10,]  0.24123551  0.07781471
[11,]  0.62781503 -0.03616591

> 
> # Changing lambda value
> 
> pleth.pgls2 <- procD.pgls(coords ~ Csize, phy = phy, lambda = 0.5, 
+ data = gdf, iter = 999)

Please be aware that printing progress slows down the analysis (perhaps slightly).

Preliminary Model Fit...

Sums of Squares calculations: 1000 permutations.
  |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |==                                                                    |   4%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |=========                                                             |  14%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |================                                                      |  24%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%
> 
> anova(pleth.pgls)

Analysis of Variance, using Residual Randomization
Permutation procedure: Randomization of null model residuals 
Number of permutations: 1000 
Estimation method: Generalized Least-Squares (via OLS projection) 
Sums of Squares and Cross-products: Type I 
Effect sizes (Z) based on F distributions

          Df       SS        MS     Rsq      F       Z Pr(>F)
Csize      1 0.006812 0.0068121 0.15732 1.3068 0.55586  0.299
Residuals  7 0.036490 0.0052129 0.84268                      
Total      8 0.043302                                        

Call: procD.lm(f1 = coords ~ Csize, iter = iter, seed = seed, RRPP = TRUE,  
    SS.type = SS.type, effect.type = effect.type, int.first = int.first,  
    Cov = Cov, data = data, print.progress = print.progress)
> anova(pleth.pgls2)

Analysis of Variance, using Residual Randomization
Permutation procedure: Randomization of null model residuals 
Number of permutations: 1000 
Estimation method: Generalized Least-Squares (via OLS projection) 
Sums of Squares and Cross-products: Type I 
Effect sizes (Z) based on F distributions

          Df        SS        MS     Rsq      F        Z Pr(>F)
Csize      1 0.0023872 0.0023872 0.08287 0.6325 0.084053  0.476
Residuals  7 0.0264188 0.0037741 0.91713                       
Total      8 0.0288060                                         

Call: procD.lm(f1 = coords ~ Csize, iter = iter, seed = seed, RRPP = TRUE,  
    SS.type = SS.type, effect.type = effect.type, int.first = int.first,  
    Cov = Cov, data = data, print.progress = print.progress)
> 
> 
> 
> cleanEx()
> nameEx("read.ply")
> ### * read.ply
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: read.ply
> ### Title: Read mesh data (vertices and faces) from ply files
> ### Aliases: read.ply
> ### Keywords: IO
> 
> ### ** Examples
> 
> # If the file has no mesh color, or color is undesirable, user can 
> # assign this as follows:
> # Using the example scallop PLY
> data(scallopPLY) 
> myply <- scallopPLY$ply
> myply$material$color <- "gray" # using color word
> myply$material$color <- "#FCE6C9" # using RGB code
> 
> 
> 
> cleanEx()
> nameEx("readland.shapes")
> ### * readland.shapes
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: readland.shapes
> ### Title: Read landmark data from a shapes object (StereoMorph)
> ### Aliases: readland.shapes
> ### Keywords: IO
> 
> ### ** Examples
> 
> # A true example is not possible, as digitizing experiences are 
> # unique, but here is a general set-up
> # myShapes <- readShapes("myDigitizingFile") # data from readShapes 
> # from StereoMorph 
> # myGMdata <- readland.shapes(myShapes) # just reading in the fixed 
> # landmarks
> # myGMdata <- readland.shapes(myShapes, 
> #      nCurvePts = c(10, 15, 5), 
> #      continuous.curve = 2) # fixed landmarks plus curve points 
> # for three curves, one closed
> # myGPA <- gpagen(myGMdata, ProcD = FALSE) # GPA perfomed with 
> # minimized bending energy
> 
> 
> 
> cleanEx()
> nameEx("rotate.coords")
> ### * rotate.coords
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: rotate.coords
> ### Title: Rotate or flip landmark or coordinate configurations
> ### Aliases: rotate.coords
> ### Keywords: utilities
> 
> ### ** Examples
> 
> data(plethodon)
> Y.gpa <- gpagen(plethodon$land)

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> plot(Y.gpa)
> Y.gpa2 <- rotate.coords(Y.gpa, "flipX")
> plot(Y.gpa2)
> Y.gpa3 <- rotate.coords(Y.gpa2, "rotateCC")
> plot(Y.gpa3)
> 
> spec1 <- Y.gpa$coords[,,1]
> plot(spec1, asp = 1)
> spec1 <- rotate.coords(spec1, "flipY")
> plot(spec1, asp = 1)
> 
> specs1to3 <- Y.gpa$coords[,,1:3]
> plotAllSpecimens(specs1to3)
> specs1to3 <- rotate.coords(specs1to3, "rotateC")
> plotAllSpecimens(specs1to3)
> 
> 
> 
> cleanEx()
> nameEx("shape.predictor")
> ### * shape.predictor
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: shape.predictor
> ### Title: Shape prediction from numeric predictors
> ### Aliases: shape.predictor
> 
> ### ** Examples
> 
> # Examples using Plethodon data
> # NOT RUN
> # data("plethodon")
> 
> # Y.gpa <- gpagen(plethodon$land)    #GPA-alignment    
> # plot(gm.prcomp(Y.gpa$coords))
> 
> # preds <- shape.predictor(Y.gpa$coords, x= NULL, Intercept = FALSE, 
> # pred1 = -0.1, pred2 = 0.1) # PC 1 extremes, sort of
> # M <- mshape(Y.gpa$coords)
> # plotRefToTarget(M, preds$pred1)
> # plotRefToTarget(M, preds[[1]]) # same result
> # plotRefToTarget(M, preds$pred2)
> 
> # PCA <- gm.prcomp(Y.gpa$coords)
> # PC <- PCA$x[,1]
> # preds <- shape.predictor(Y.gpa$coords, x= PC, Intercept = FALSE, 
> # pred1 = min(PC), pred2 = max(PC)) # PC 1 extremes, more technically
> # plotRefToTarget(M, preds$pred1)
> # plotRefToTarget(M, preds$pred2)
> 
> # PC <- PCA$x[,1:2]
> # user-picked spots can be anything, but it in this case, apparent groups
> # preds <- shape.predictor(Y.gpa$coords, x= PC, Intercept = FALSE, 
> #                          pred1 = c(0.045,-0.02), 
> #                          pred2 = c(-0.025,0.06), 
> #                          pred3 = c(-0.06,-0.04)) 
> # plotRefToTarget(M, preds$pred1)
> # plotRefToTarget(M, preds$pred2)
> # plotRefToTarget(M, preds$pred3)
> 
> # allometry example - straight-up allometry
> 
> # preds <- shape.predictor(Y.gpa$coords, x= log(Y.gpa$Csize), 
> #                          Intercept = TRUE, 
> #                          predmin = min(log(Y.gpa$Csize)), 
> #                          predmax = max(log(Y.gpa$Csize))) 
> 
> # plotRefToTarget(M, preds$predmin, mag=3)
> # plotRefToTarget(M, preds$predmax, mag=3)
> 
> # allometry example - using RegScore or PredLine via procD.lm
> 
> # gdf <- geomorph.data.frame(Y.gpa)
> # plethAllometry <- procD.lm(coords ~ log(Csize), data=gdf)
> # allom.plot <- plot(plethAllometry, 
> # type = "regression", 
> # predictor = log(gdf$Csize),
> # reg.type ="RegScore") # make sure to have a predictor 
> 
> # preds <- shape.predictor(plethAllometry$GM$fitted, 
> #                          x= allom.plot$RegScore, Intercept = FALSE, 
> #                          predmin = min(allom.plot$RegScore), 
> #                          predmax = max(allom.plot$RegScore)) 
> # plotRefToTarget(M, preds$predmin, mag=3)
> # plotRefToTarget(M, preds$predmax, mag=3)
> 
> # allom.plot <- plot(plethAllometry, 
> # type = "regression", 
> # predictor = log(gdf$Csize),
> # reg.type ="PredLine")
> # preds <- shape.predictor(plethAllometry$GM$fitted, 
> #                          x= allom.plot$PredLine, Intercept = FALSE, 
> #                          predmin = min(allom.plot$PredLine), 
> #                          predmax = max(allom.plot$PredLine)) 
> # plotRefToTarget(M, preds$predmin, mag=3)
> # plotRefToTarget(M, preds$predmax, mag=3)
> 
> # using factors via PCA
> 
> # gdf <- geomorph.data.frame(Y.gpa, species = plethodon$species, 
> #         site = plethodon$site)
> # pleth <- procD.lm(coords ~ species*site, data=gdf)
> # PCA <- prcomp(pleth$fitted)
> # plot(PCA$x, asp=1, pch=19)
> 
> # means <- unique(round(PCA$x,3))
> # means # note: suggests 3 PCs useful enough
> 
> # preds <- shape.predictor(arrayspecs(pleth$fitted, 12,2), x= PCA$x[,1:3],
> #                          Intercept = FALSE,
> #                          pred1 = means[1,1:3], 
> #                          pred2 = means[2,1:3],
> #                          pred3 = means[3,1:3], 
> #                          pred4 = means[4,1:3])                   
> # plotRefToTarget(M, preds$pred1, mag=2)
> # plotRefToTarget(M, preds$pred2, mag=2)
> # plotRefToTarget(M, preds$pred3, mag=2)
> # plotRefToTarget(M, preds$pred4, mag=2)
> 
> # Using a design matrix for factors
> 
> # X <- pleth$X
> # X # includes intercept; remove for better functioning 
> # X <- X[,-1]
> # symJord <- c(0,1,0) # design for P. Jordani in sympatry
> # alloJord <- c(0,0,0) # design for P. Jordani in allopatry
> # preds <- shape.predictor(arrayspecs(pleth$fitted, 12,2), x = X, 
> #                          Intercept = TRUE, 
> #                          symJord=symJord, alloJord=alloJord)
> # plotRefToTarget(M, preds$symJord, mag=2)
> # plotRefToTarget(M, preds$alloJord, mag=2)
> 
> # PLS Example
> 
> # data(plethShapeFood) 
> # Y.gpa<-gpagen(plethShapeFood$land)    #GPA-alignment    
> 
> # 2B-PLS between head shape and food use data
> # PLS <-two.b.pls(A1 = plethShapeFood$food, A2 = Y.gpa$coords, iter=999) 
> # summary(PLS)
> # plot(PLS)
> 
> # preds <- shape.predictor(Y.gpa$coords, plethShapeFood$food, 
> #                          Intercept = FALSE,
> #                          method = "PLS",
> #                          pred1 = 2, pred2 = -4, pred3 = 2.5) 
>                         # using PLS plot as a guide
> # M <- mshape(Y.gpa$coords)
> # plotRefToTarget(M, preds$pred1, mag=2)
> # plotRefToTarget(M, preds$pred2, mag=2)
> # plotRefToTarget(M, preds$pred3, mag=2)
> 
> 
> 
> 
> cleanEx()
> nameEx("shapeHulls")
> ### * shapeHulls
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: shapeHulls
> ### Title: Update Plots with Convex Hulls for Groups
> ### Aliases: shapeHulls
> ### Keywords: utilities
> 
> ### ** Examples
> 
> 
> # Via procD.lm and plot.procD.lm
> 
> data("pupfish")
> gdf <- geomorph.data.frame(coords = pupfish$coords, Sex = pupfish$Sex,
+ Pop = pupfish$Pop)
> fit <- procD.lm(coords ~ Pop * Sex, data = gdf, print.progress = FALSE)
> pc.plot <- plot(fit, type = "PC", pch = 19)
> shapeHulls(pc.plot)
> 
> pc.plot <- plot(fit, type = "PC", pch = 19)
> groups <- interaction(gdf$Pop, gdf$Sex)
> 
> shapeHulls(pc.plot, groups = groups, 
+ group.cols = c("dark red", "dark red", "dark blue", "dark blue"),
+ group.lwd = rep(2, 4), group.lty = c(2, 1, 2, 1))
> 
> legend("topright", levels(groups), 
+ col = c("dark red", "dark red", "dark blue", "dark blue"),
+ lwd = rep(2,4), lty = c(2, 1, 2, 1))
> 
> pc.plot <- plot(fit, type = "PC", pch = 19)
> shapeHulls(pc.plot, groups = gdf$Sex, group.cols = c("black", "black"), 
+ group.lwd = rep(2, 2), group.lty = c(2, 1))
> legend("topright", levels(gdf$Sex), lwd = 2, lty = c(2, 1))
> 
> # Via gm.prcomp and plot.gm.prcomp
> 
> data(plethspecies) 
> Y.gpa <- gpagen(plethspecies$land)    #GPA-alignment

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> pleth.phylo <- gm.prcomp(Y.gpa$coords, phy = plethspecies$phy)
> summary(pleth.phylo)

Ordination type: Principal Component Analysis 
Centering by OLS mean
Orthogonal projection of OLS residuals
Number of observations: 9 
Number of vectors 8 

Importance of Components:
                              Comp1        Comp2        Comp3        Comp4
Eigenvalues            0.0002720474 0.0001120524 0.0001084758 0.0000568924
Proportion of Variance 0.4564029477 0.1879858086 0.1819855633 0.0954461044
Cumulative Proportion  0.4564029477 0.6443887563 0.8263743196 0.9218204240
                              Comp5        Comp6        Comp7        Comp8
Eigenvalues            0.0000264508 1.260516e-05 5.959622e-06 1.584785e-06
Proportion of Variance 0.0443754550 2.114717e-02 9.998220e-03 2.658730e-03
Cumulative Proportion  0.9661958790 9.873431e-01 9.973413e-01 1.000000e+00


Dispersion (variance) of points, after projection:
                                       Comp1        Comp2        Comp3
Tips Dispersion                 2.720474e-04 1.120524e-04 1.084758e-04
Proportion Tips Dispersion      4.564029e-01 1.879858e-01 1.819856e-01
Cumulative Tips Dispersion      4.564029e-01 6.443888e-01 8.263743e-01
Ancestors Dispersion            3.073342e-05 2.320038e-05 2.039005e-05
Proportion Ancestors Dispersion 3.854327e-01 2.909597e-01 2.557149e-01
Cumulative Ancestors Dispersion 3.854327e-01 6.763923e-01 9.321072e-01
                                       Comp4        Comp5        Comp6
Tips Dispersion                 5.689240e-05 2.645080e-05 1.260516e-05
Proportion Tips Dispersion      9.544610e-02 4.437545e-02 2.114717e-02
Cumulative Tips Dispersion      9.218204e-01 9.661959e-01 9.873431e-01
Ancestors Dispersion            3.171758e-06 1.748508e-06 3.945777e-07
Proportion Ancestors Dispersion 3.977752e-02 2.192831e-02 4.948462e-03
Cumulative Ancestors Dispersion 9.718847e-01 9.938130e-01 9.987615e-01
                                       Comp7        Comp8
Tips Dispersion                 5.959622e-06 1.584785e-06
Proportion Tips Dispersion      9.998220e-03 2.658730e-03
Cumulative Tips Dispersion      9.973413e-01 1.000000e+00
Ancestors Dispersion            8.354868e-08 1.520561e-08
Proportion Ancestors Dispersion 1.047797e-03 1.906960e-04
Cumulative Ancestors Dispersion 9.998093e-01 1.000000e+00


> 
> pc.plot <- plot(pleth.phylo, phylo = TRUE)
> gp <- factor(c(rep(1, 5), rep(2, 4)))
> shapeHulls(pc.plot, groups = gp, group.cols = 1:2, 
+ group.lwd = rep(2, 2), group.lty = c(2, 1))
> legend("topright", c("P. cinereus clade", "P. hubrichti clade"), 
+ col = 1:2, lwd = 2, lty = c(2, 1))
> 
> 
> 
> cleanEx()
> nameEx("two.b.pls")
> ### * two.b.pls
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: two.b.pls
> ### Title: Two-block partial least squares analysis for Procrustes shape
> ###   variables
> ### Aliases: two.b.pls
> ### Keywords: analysis
> 
> ### ** Examples
> 
> data(plethShapeFood) 
> Y.gpa<-gpagen(plethShapeFood$land)    #GPA-alignment    

Performing GPA
  |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%

Making projections... Finished!
> 
> #2B-PLS between head shape and food use data
> PLS <-two.b.pls(Y.gpa$coords,plethShapeFood$food,iter=999)
Data in either A1 or A2 do not have names.  It is assumed data in both A1 and A2 are ordered the same.

Random PLS calculations: 1000 permutations.
  |                                                                              |                                                                      |   0%  |                                                                              |                                                                      |   1%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |===                                                                   |   5%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |=====                                                                 |   8%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |=======                                                               |  11%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  16%  |                                                                              |============                                                          |  17%  |                                                                              |============                                                          |  18%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |==============                                                        |  21%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |=================                                                     |  25%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |===================                                                   |  28%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |=====================                                                 |  31%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |=======================                                               |  34%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |==========================                                            |  38%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  39%  |                                                                              |============================                                          |  40%  |                                                                              |============================                                          |  41%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |==============================                                        |  44%  |                                                                              |===============================                                       |  44%  |                                                                              |===============================                                       |  45%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |=================================                                     |  48%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |===================================                                   |  51%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |=====================================                                 |  54%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  56%  |                                                                              |========================================                              |  57%  |                                                                              |========================================                              |  58%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |==========================================                            |  61%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  62%  |                                                                              |============================================                          |  63%  |                                                                              |============================================                          |  64%  |                                                                              |=============================================                         |  64%  |                                                                              |=============================================                         |  65%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |===============================================                       |  68%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |=================================================                     |  71%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |===================================================                   |  74%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |======================================================                |  78%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  79%  |                                                                              |========================================================              |  80%  |                                                                              |========================================================              |  81%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |==========================================================            |  84%  |                                                                              |===========================================================           |  84%  |                                                                              |===========================================================           |  85%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |=============================================================         |  88%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |===============================================================       |  91%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |=================================================================     |  94%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |====================================================================  |  98%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================|  99%  |                                                                              |======================================================================| 100%> summary(PLS)

Call:
two.b.pls(A1 = Y.gpa$coords, A2 = plethShapeFood$food, iter = 999) 



r-PLS: 0.759

Effect Size (Z): 3.8842

P-value: 0.001

Based on 1000 random permutations
> P <- plot(PLS)
>  
>  # Visualize shape at minimum and maximum PLS scores.
>  # This is the challenging way
>  
>  # Block 1 (shape)
>  minx <- min(P$plot.args$x)
>  maxx <- max(P$plot.args$x)
>  preds <- shape.predictor(P$A1, 
+  x = P$plot.args$x,
+  min = minx, max = maxx)
>  plotRefToTarget(mshape(P$A1), preds$min)
>  plotRefToTarget(mshape(P$A1), preds$max)
>  
>  ### Visualize shape variation using picknplot.shape Because picknplot  
>  ### requires user decisions, the following example
>  ### is not run (but can be with removal of #).
>  ### For detailed options, see the picknplot help file
>  # picknplot.shape(P)
>  
> 
> 
> 
> 
> cleanEx()
> nameEx("two.d.array")
> ### * two.d.array
> 
> flush(stderr()); flush(stdout())
> 
> ### Name: two.d.array
> ### Title: Convert (p x k x n) data array into 2D data matrix
> ### Aliases: two.d.array
> ### Keywords: utilities
> 
> ### ** Examples
> 
> data(plethodon) 
> plethodon$land    #original data in the form of 3D array
, , 1

          [,1]     [,2]
 [1,]  8.89372 53.77644
 [2,]  9.26840 52.77072
 [3,]  5.56104 54.21028
 [4,]  1.87340 52.75100
 [5,]  1.28180 53.18484
 [6,]  1.24236 53.32288
 [7,]  0.84796 54.70328
 [8,]  3.35240 55.76816
 [9,]  6.29068 55.70900
[10,]  8.87400 55.25544
[11,] 10.74740 55.43292
[12,] 14.39560 52.75100

, , 2

           [,1]     [,2]
 [1,]  8.679762 54.57819
 [2,]  8.935628 53.83027
 [3,]  5.451914 54.65691
 [4,]  1.987882 52.68871
 [5,]  1.515514 53.02331
 [6,]  1.338376 53.22013
 [7,]  1.239966 54.44041
 [8,]  3.247530 55.85752
 [9,]  6.219512 55.99529
[10,]  8.758490 56.01497
[11,] 10.903828 55.83783
[12,] 14.033266 53.86963

, , 3

           [,1]     [,2]
 [1,]  9.805328 56.06903
 [2,] 10.137712 55.27961
 [3,]  6.647680 55.73664
 [4,]  3.448484 53.86698
 [5,]  3.012230 54.34478
 [6,]  2.825264 54.57330
 [7,]  2.721394 55.73664
 [8,]  4.549506 56.79612
 [9,]  7.520188 57.35701
[10,]  9.846876 57.25314
[11,] 11.986598 57.23237
[12,] 14.749540 55.11342

, , 4

           [,1]     [,2]
 [1,]  9.637164 58.03294
 [2,]  9.952104 56.77318
 [3,]  6.109836 57.94896
 [4,]  2.645496 55.89135
 [5,]  2.015616 56.62621
 [6,]  1.721672 57.21410
 [7,]  1.868644 58.51585
 [8,]  3.632308 59.48167
 [9,]  6.865692 59.92258
[10,]  9.763140 59.56565
[11,] 11.883736 59.46067
[12,] 15.369072 56.56322

, , 5

           [,1]     [,2]
 [1,] 11.035692 58.75009
 [2,] 11.335110 57.85184
 [3,]  8.255382 58.92119
 [4,]  4.555431 57.46687
 [5,]  3.956595 58.08709
 [6,]  3.871047 58.40790
 [7,]  3.871047 59.58418
 [8,]  5.795877 60.22579
 [9,]  9.068088 60.24718
[10,] 11.420658 59.94776
[11,] 12.768039 59.88360
[12,] 15.847767 57.46687

, , 6

           [,1]     [,2]
 [1,]  7.946625 55.71114
 [2,]  8.476400 54.82112
 [3,]  4.979885 54.90588
 [4,]  2.479347 52.85035
 [5,]  2.076718 53.10465
 [6,]  1.737662 53.14703
 [7,]  1.335033 54.20658
 [8,]  2.712448 55.54161
 [9,]  5.382514 56.60116
[10,]  7.861861 56.96141
[11,]  9.663096 57.49118
[12,] 13.138420 55.75352

, , 7

           [,1]     [,2]
 [1,]  8.849841 58.66961
 [2,]  9.396387 57.82877
 [3,]  5.990985 58.31225
 [4,]  2.501499 56.84078
 [5,]  2.102100 57.28223
 [6,]  1.933932 57.47141
 [7,]  1.975974 58.43838
 [8,]  3.741738 59.34228
 [9,]  6.642636 59.72066
[10,]  8.849841 59.82577
[11,] 10.951941 59.48943
[12,] 13.579566 57.89183

, , 8

           [,1]     [,2]
 [1,]  9.331504 56.36904
 [2,] 10.154872 55.31344
 [3,]  6.671392 56.62238
 [4,]  2.195648 55.08121
 [5,]  1.688960 55.79902
 [6,]  1.520064 56.28459
 [7,]  1.583400 57.34019
 [8,]  3.715712 58.22690
 [9,]  7.241416 58.26912
[10,]  9.774856 57.88910
[11,] 11.949392 57.59354
[12,] 15.432872 54.70119

, , 9

           [,1]     [,2]
 [1,]  9.840795 58.49453
 [2,] 10.179403 57.37289
 [3,]  6.031455 58.49453
 [4,]  2.624212 57.05545
 [5,]  2.137463 57.35173
 [6,]  1.566062 57.71150
 [7,]  1.693040 58.98128
 [8,]  3.745851 60.06059
 [9,]  7.110768 60.14525
[10,] 10.073588 60.12408
[11,] 11.787791 59.89129
[12,] 15.131545 57.41522

, , 10

           [,1]     [,2]
 [1,]  9.563510 56.51740
 [2,]  9.900550 55.50628
 [3,]  5.919265 56.36994
 [4,]  1.811590 54.45303
 [5,]  1.369225 55.02178
 [6,]  1.221770 55.54841
 [7,]  1.200705 56.87550
 [8,]  3.265075 57.88662
 [9,]  6.551215 58.05514
[10,]  9.437120 57.97088
[11,] 11.627880 57.52851
[12,] 15.419580 55.08498

, , 11

           [,1]     [,2]
 [1,]  8.211782 57.04143
 [2,]  8.337794 55.52929
 [3,]  4.830460 59.47766
 [4,]  0.336032 60.90580
 [5,]  0.462044 61.68287
 [6,]  0.378036 62.18692
 [7,]  1.176112 63.19502
 [8,]  4.053386 62.58596
 [9,]  6.993666 60.56977
[10,]  9.765930 58.61658
[11,] 11.803124 57.29346
[12,] 15.016430 53.55510

, , 12

           [,1]     [,2]
 [1,]  8.691998 54.71960
 [2,]  9.660114 53.56207
 [3,]  5.240454 55.43516
 [4,]  1.641588 54.76169
 [5,]  0.926024 55.37203
 [6,]  0.610334 55.85608
 [7,]  0.926024 57.09780
 [8,]  3.220038 57.72918
 [9,]  6.503214 57.11884
[10,]  9.533838 56.46642
[11,] 11.449024 56.48746
[12,] 15.889730 54.13031

, , 13

           [,1]     [,2]
 [1,] 10.707338 61.44578
 [2,] 11.724882 60.26636
 [3,]  7.030304 61.28390
 [4,]  2.890750 59.13318
 [5,]  2.220096 59.78071
 [6,]  2.058214 60.10447
 [7,]  2.127592 61.49203
 [8,]  4.393940 62.85647
 [9,]  7.932218 63.11085
[10,] 11.216110 63.29586
[11,] 13.228072 63.85089
[12,] 18.500800 63.06460

, , 14

           [,1]     [,2]
 [1,]  8.470779 53.32874
 [2,]  9.155484 52.66360
 [3,]  6.397101 53.21136
 [4,]  4.460364 52.42884
 [5,]  4.166919 52.76141
 [6,]  3.990852 53.21136
 [7,]  4.264734 54.07213
 [8,]  5.164632 54.50252
 [9,]  7.453503 54.32645
[10,]  8.842476 54.34601
[11,]  9.820626 54.26776
[12,] 12.735513 53.48524

, , 15

           [,1]     [,2]
 [1,] 11.532672 74.42845
 [2,] 12.226768 72.61312
 [3,]  7.635056 75.04246
 [4,]  2.776384 73.92122
 [5,]  2.322552 74.32166
 [6,]  1.681848 74.82889
 [7,]  2.215768 76.40395
 [8,]  4.965456 77.36501
 [9,]  9.396992 76.99126
[10,] 12.280160 76.59082
[11,] 14.389144 76.27047
[12,] 19.488080 73.89453

, , 16

           [,1]     [,2]
 [1,]  8.919900 55.17745
 [2,]  9.675468 53.01569
 [3,]  5.561820 55.57622
 [4,]  0.797544 54.17003
 [5,]  0.482724 54.98856
 [6,]  0.272844 55.49227
 [7,]  0.524700 56.81452
 [8,]  3.022272 57.63305
 [9,]  6.737148 57.27625
[10,]  9.864360 56.98242
[11,] 11.984148 56.45772
[12,] 16.454592 54.75769

, , 17

           [,1]     [,2]
 [1,]  9.914553 55.94491
 [2,] 10.459539 55.16935
 [3,]  7.524999 55.94491
 [4,]  5.009679 55.10647
 [5,]  4.716225 55.48377
 [6,]  4.527576 55.86107
 [7,]  4.527576 56.55278
 [8,]  5.743314 57.43314
 [9,]  8.405361 57.34930
[10,] 10.124163 57.22353
[11,] 11.738160 57.22353
[12,] 14.484051 56.04971

, , 18

           [,1]     [,2]
 [1,] 10.661782 62.89986
 [2,] 11.616221 61.66607
 [3,]  6.867305 63.76118
 [4,]  2.677085 62.24805
 [5,]  2.025273 62.80674
 [6,]  1.489856 63.36544
 [7,]  1.839041 64.78546
 [8,]  4.283336 65.83301
 [9,]  8.566672 65.55366
[10,] 11.616221 64.92513
[11,] 13.874284 64.76218
[12,] 18.623200 62.87658

, , 19

           [,1]     [,2]
 [1,]  8.313908 51.34480
 [2,]  9.735764 50.02168
 [3,]  4.838260 51.38430
 [4,]  1.303368 49.98219
 [5,]  0.710928 50.57463
 [6,]  0.572692 51.04858
 [7,]  0.829416 52.23346
 [8,]  2.784468 53.28010
 [9,]  6.516840 53.35910
[10,]  9.419796 53.26036
[11,] 11.098376 53.14187
[12,] 15.818148 51.44354

, , 20

           [,1]     [,2]
 [1,]  8.506270 57.07500
 [2,]  9.813331 55.99615
 [3,]  5.912895 57.30321
 [4,]  1.514531 56.24512
 [5,]  1.161832 56.84678
 [6,]  0.871374 57.19948
 [7,]  1.286314 58.36131
 [8,]  3.651472 59.00447
 [9,]  6.929498 59.08746
[10,]  9.979307 58.65177
[11,] 11.888031 58.77625
[12,] 16.556106 56.95052

, , 21

           [,1]     [,2]
 [1,] 10.310018 55.68670
 [2,] 11.086944 54.67879
 [3,]  7.895248 55.77069
 [4,]  4.388582 54.51081
 [5,]  3.884630 54.80478
 [6,]  3.569660 55.09875
 [7,]  3.548662 56.10666
 [8,]  5.291496 57.15656
 [9,]  8.294210 57.40853
[10,] 10.519998 57.34554
[11,] 13.732692 57.51352
[12,] 15.958480 55.93867

, , 22

           [,1]     [,2]
 [1,]  8.168564 57.41153
 [2,]  8.189617 56.04309
 [3,]  5.579045 59.41157
 [4,]  0.694749 60.42211
 [5,]  0.421060 61.11686
 [6,]  0.336848 61.58002
 [7,]  1.305286 62.52741
 [8,]  3.957964 62.61162
 [9,]  7.494868 60.90633
[10,] 10.084387 59.05366
[11,] 13.810768 56.90626
[12,] 15.052895 53.24304

, , 23

           [,1]     [,2]
 [1,]  8.514847 55.94275
 [2,]  9.163398 54.83394
 [3,]  5.732354 55.92183
 [4,]  2.238547 54.66657
 [5,]  1.882890 55.00131
 [6,]  1.694601 55.41973
 [7,]  1.799206 56.25657
 [8,]  3.640254 57.34446
 [9,]  6.673799 57.59551
[10,]  9.016951 57.51183
[11,] 11.883128 57.34446
[12,] 14.100754 55.37789

, , 24

          [,1]     [,2]
 [1,]  7.52874 58.00074
 [2,]  7.90728 57.24366
 [3,]  5.23647 58.12692
 [4,]  1.95579 56.94924
 [5,]  1.55622 57.26469
 [6,]  1.36695 57.79044
 [7,]  1.53519 58.73679
 [8,]  3.13347 59.49387
 [9,]  5.59398 59.51490
[10,]  7.90728 59.22048
[11,] 10.53603 59.17842
[12,] 12.38667 57.43293

, , 25

           [,1]     [,2]
 [1,]  9.660255 58.00344
 [2,] 10.498455 57.16524
 [3,]  7.543800 58.17108
 [4,]  4.253865 56.80901
 [5,]  3.876675 57.27002
 [6,]  3.583305 57.60530
 [7,]  3.604260 58.50636
 [8,]  5.196840 59.55411
 [9,]  7.858125 59.70080
[10,] 10.142220 59.61698
[11,] 12.824460 59.38647
[12,] 15.108555 57.66816

, , 26

           [,1]     [,2]
 [1,]  8.374318 56.47404
 [2,]  8.837220 55.10638
 [3,]  5.554824 57.02111
 [4,]  1.346624 55.94802
 [5,]  0.967886 56.74758
 [6,]  0.799558 57.33673
 [7,]  0.904763 58.51502
 [8,]  3.008863 59.20937
 [9,]  6.312300 58.97792
[10,]  9.110753 58.28357
[11,] 12.498354 57.84171
[12,] 15.465135 55.56928

, , 27

           [,1]     [,2]
 [1,]  8.634288 57.98208
 [2,]  9.663680 56.13338
 [3,]  5.945264 58.54930
 [4,]  1.491568 56.53253
 [5,]  0.924352 57.41486
 [6,]  0.630240 58.27619
 [7,]  0.861328 59.83078
 [8,]  3.361280 60.90219
 [9,]  7.016672 60.86018
[10,]  9.936784 59.95683
[11,] 14.180400 59.43163
[12,] 17.016480 57.01571

, , 28

          [,1]     [,2]
 [1,]  9.99570 57.01410
 [2,] 10.63920 55.74855
 [3,]  6.73530 57.70050
 [4,]  1.26555 55.83435
 [5,]  0.64350 56.49930
 [6,]  0.49335 56.99265
 [7,]  0.66495 58.25820
 [8,]  3.81810 59.56665
 [9,]  7.61475 59.48085
[10,] 10.85370 58.92315
[11,] 14.43585 58.53705
[12,] 17.54610 56.11320

, , 29

           [,1]     [,2]
 [1,]  9.293050 56.80955
 [2,]  9.860725 55.37985
 [3,]  6.664925 57.29312
 [4,]  2.733250 55.90547
 [5,]  2.291725 56.15777
 [6,]  2.018400 56.62032
 [7,]  2.060450 57.83977
 [8,]  4.205000 59.08025
 [9,]  7.758225 59.01717
[10,] 10.449425 58.40745
[11,] 13.645225 57.96592
[12,] 15.831825 56.15777

, , 30

           [,1]     [,2]
 [1,]  8.395014 57.54170
 [2,]  9.238734 56.52924
 [3,]  6.243528 57.96356
 [4,]  2.425695 57.01438
 [5,]  1.792905 57.26750
 [6,]  1.455417 57.49952
 [7,]  1.413231 58.51198
 [8,]  3.417066 59.65100
 [9,]  6.686481 59.54554
[10,]  9.133269 58.80728
[11,] 11.790987 58.51198
[12,] 14.090124 56.74017

, , 31

           [,1]     [,2]
 [1,]  9.536103 56.41668
 [2,] 10.188684 55.53254
 [3,]  6.862626 56.83770
 [4,]  2.778732 55.72200
 [5,]  2.315610 56.16407
 [6,]  1.978794 56.45878
 [7,]  2.084049 57.49028
 [8,]  4.189149 58.39547
 [9,]  7.431003 58.62703
[10,] 10.314990 58.35337
[11,] 13.809456 57.99551
[12,] 15.935607 56.03776

, , 32

          [,1]     [,2]
 [1,]  9.28998 57.66999
 [2,]  9.43845 56.39739
 [3,]  6.15090 60.06672
 [4,]  0.91203 61.10601
 [5,]  0.67872 61.63626
 [6,]  0.57267 62.16651
 [7,]  1.16655 63.16338
 [8,]  4.43289 63.26943
 [9,]  7.86891 61.44537
[10,] 10.90194 59.30316
[11,] 14.23191 57.26700
[12,] 15.84387 53.95824

, , 33

          [,1]     [,2]
 [1,]  9.45411 57.01684
 [2,] 10.10108 56.05682
 [3,]  6.63666 57.28815
 [4,]  2.69223 55.86899
 [5,]  2.35831 56.36987
 [6,]  2.02439 56.72466
 [7,]  2.08700 57.72642
 [8,]  3.88182 58.85340
 [9,]  7.57581 58.89514
[10,] 10.20543 58.39426
[11,] 13.44028 58.20643
[12,] 16.13251 56.32813

, , 34

           [,1]     [,2]
 [1,]  7.130627 56.33819
 [2,]  7.546407 55.63136
 [3,]  5.238828 56.50450
 [4,]  1.683909 55.36111
 [5,]  1.476019 55.67294
 [6,]  1.247340 55.75610
 [7,]  1.164184 56.75397
 [8,]  2.577836 57.81421
 [9,]  5.488296 57.98052
[10,]  7.691930 57.54395
[11,] 10.165821 57.39843
[12,] 12.847602 55.79768

, , 35

           [,1]     [,2]
 [1,]  9.093168 58.07419
 [2,]  9.745687 56.79020
 [3,]  6.209455 58.36888
 [4,]  1.852312 57.00069
 [5,]  1.283989 57.48482
 [6,]  1.094548 57.90580
 [7,]  1.305038 59.00035
 [8,]  3.388889 59.96860
 [9,]  7.114562 60.32643
[10,]  9.787785 59.71601
[11,] 12.945135 59.16874
[12,] 15.239476 57.50587

, , 36

           [,1]     [,2]
 [1,]  8.076244 58.16164
 [2,]  8.837356 57.21025
 [3,]  5.412352 58.26735
 [4,]  1.945064 56.51257
 [5,]  1.458798 56.93541
 [6,]  1.205094 57.29482
 [7,]  1.374230 58.20393
 [8,]  3.065590 59.45130
 [9,]  5.835192 59.85300
[10,]  8.625936 59.64158
[11,] 11.691526 59.76843
[12,] 14.672548 57.88680

, , 37

          [,1]     [,2]
 [1,]  8.46210 56.89815
 [2,]  9.28305 55.97195
 [3,]  6.44130 56.77185
 [4,]  2.31550 55.29835
 [5,]  1.91555 55.57200
 [6,]  1.78925 56.05615
 [7,]  1.76820 57.08760
 [8,]  3.17855 57.99275
 [9,]  6.31500 58.45585
[10,]  8.77785 58.37165
[11,] 11.97745 58.35060
[12,] 14.46135 57.08760

, , 38

          [,1]     [,2]
 [1,]  8.58024 57.72735
 [2,]  9.65277 56.27628
 [3,]  6.07767 58.31619
 [4,]  1.21974 57.41190
 [5,]  0.79914 58.27413
 [6,]  0.65193 58.77885
 [7,]  1.07253 60.12477
 [8,]  3.36480 60.73464
 [9,]  6.98196 60.27198
[10,] 10.01028 59.28357
[11,] 13.83774 58.88400
[12,] 16.71885 56.08701

, , 39

           [,1]     [,2]
 [1,]  9.389055 56.73521
 [2,] 10.000926 55.84905
 [3,]  6.751680 56.94620
 [4,]  2.869464 55.57477
 [5,]  2.363088 56.06004
 [6,]  2.088801 56.62972
 [7,]  2.236494 57.62137
 [8,]  4.198701 58.50753
 [9,]  7.532343 58.38093
[10,]  9.916530 58.21214
[11,] 12.638301 58.29654
[12,] 15.338973 56.27103

, , 40

           [,1]     [,2]
 [1,]  9.494001 56.66929
 [2,] 10.125531 55.57464
 [3,]  6.694218 57.25872
 [4,]  1.494621 56.47983
 [5,]  0.968346 56.77455
 [6,]  0.842040 57.34292
 [7,]  0.989397 58.33232
 [8,]  3.410262 59.30067
 [9,]  7.473105 58.92175
[10,]  9.957123 58.26917
[11,] 13.514742 57.72184
[12,] 15.956658 55.59569

> 
> two.d.array(plethodon$land)   # Convert to a 2D data matrix
           [,1]     [,2]      [,3]     [,4]     [,5]     [,6]     [,7]     [,8]
 [1,]  8.893720 53.77644  9.268400 52.77072 5.561040 54.21028 1.873400 52.75100
 [2,]  8.679762 54.57819  8.935628 53.83027 5.451914 54.65691 1.987882 52.68871
 [3,]  9.805328 56.06903 10.137712 55.27961 6.647680 55.73664 3.448484 53.86698
 [4,]  9.637164 58.03294  9.952104 56.77318 6.109836 57.94896 2.645496 55.89135
 [5,] 11.035692 58.75009 11.335110 57.85184 8.255382 58.92119 4.555431 57.46687
 [6,]  7.946625 55.71114  8.476400 54.82112 4.979885 54.90588 2.479347 52.85035
 [7,]  8.849841 58.66961  9.396387 57.82877 5.990985 58.31225 2.501499 56.84078
 [8,]  9.331504 56.36904 10.154872 55.31344 6.671392 56.62238 2.195648 55.08121
 [9,]  9.840795 58.49453 10.179403 57.37289 6.031455 58.49453 2.624212 57.05545
[10,]  9.563510 56.51740  9.900550 55.50628 5.919265 56.36994 1.811590 54.45303
[11,]  8.211782 57.04143  8.337794 55.52929 4.830460 59.47766 0.336032 60.90580
[12,]  8.691998 54.71960  9.660114 53.56207 5.240454 55.43516 1.641588 54.76169
[13,] 10.707338 61.44578 11.724882 60.26636 7.030304 61.28390 2.890750 59.13318
[14,]  8.470779 53.32874  9.155484 52.66360 6.397101 53.21136 4.460364 52.42884
[15,] 11.532672 74.42845 12.226768 72.61312 7.635056 75.04246 2.776384 73.92122
[16,]  8.919900 55.17745  9.675468 53.01569 5.561820 55.57622 0.797544 54.17003
[17,]  9.914553 55.94491 10.459539 55.16935 7.524999 55.94491 5.009679 55.10647
[18,] 10.661782 62.89986 11.616221 61.66607 6.867305 63.76118 2.677085 62.24805
[19,]  8.313908 51.34480  9.735764 50.02168 4.838260 51.38430 1.303368 49.98219
[20,]  8.506270 57.07500  9.813331 55.99615 5.912895 57.30321 1.514531 56.24512
[21,] 10.310018 55.68670 11.086944 54.67879 7.895248 55.77069 4.388582 54.51081
[22,]  8.168564 57.41153  8.189617 56.04309 5.579045 59.41157 0.694749 60.42211
[23,]  8.514847 55.94275  9.163398 54.83394 5.732354 55.92183 2.238547 54.66657
[24,]  7.528740 58.00074  7.907280 57.24366 5.236470 58.12692 1.955790 56.94924
[25,]  9.660255 58.00344 10.498455 57.16524 7.543800 58.17108 4.253865 56.80901
[26,]  8.374318 56.47404  8.837220 55.10638 5.554824 57.02111 1.346624 55.94802
[27,]  8.634288 57.98208  9.663680 56.13338 5.945264 58.54930 1.491568 56.53253
[28,]  9.995700 57.01410 10.639200 55.74855 6.735300 57.70050 1.265550 55.83435
[29,]  9.293050 56.80955  9.860725 55.37985 6.664925 57.29312 2.733250 55.90547
[30,]  8.395014 57.54170  9.238734 56.52924 6.243528 57.96356 2.425695 57.01438
[31,]  9.536103 56.41668 10.188684 55.53254 6.862626 56.83770 2.778732 55.72200
[32,]  9.289980 57.66999  9.438450 56.39739 6.150900 60.06672 0.912030 61.10601
[33,]  9.454110 57.01684 10.101080 56.05682 6.636660 57.28815 2.692230 55.86899
[34,]  7.130627 56.33819  7.546407 55.63136 5.238828 56.50450 1.683909 55.36111
[35,]  9.093168 58.07419  9.745687 56.79020 6.209455 58.36888 1.852312 57.00069
[36,]  8.076244 58.16164  8.837356 57.21025 5.412352 58.26735 1.945064 56.51257
[37,]  8.462100 56.89815  9.283050 55.97195 6.441300 56.77185 2.315500 55.29835
[38,]  8.580240 57.72735  9.652770 56.27628 6.077670 58.31619 1.219740 57.41190
[39,]  9.389055 56.73521 10.000926 55.84905 6.751680 56.94620 2.869464 55.57477
[40,]  9.494001 56.66929 10.125531 55.57464 6.694218 57.25872 1.494621 56.47983
          [,9]    [,10]    [,11]    [,12]    [,13]    [,14]    [,15]    [,16]
 [1,] 1.281800 53.18484 1.242360 53.32288 0.847960 54.70328 3.352400 55.76816
 [2,] 1.515514 53.02331 1.338376 53.22013 1.239966 54.44041 3.247530 55.85752
 [3,] 3.012230 54.34478 2.825264 54.57330 2.721394 55.73664 4.549506 56.79612
 [4,] 2.015616 56.62621 1.721672 57.21410 1.868644 58.51585 3.632308 59.48167
 [5,] 3.956595 58.08709 3.871047 58.40790 3.871047 59.58418 5.795877 60.22579
 [6,] 2.076718 53.10465 1.737662 53.14703 1.335033 54.20658 2.712448 55.54161
 [7,] 2.102100 57.28223 1.933932 57.47141 1.975974 58.43838 3.741738 59.34228
 [8,] 1.688960 55.79902 1.520064 56.28459 1.583400 57.34019 3.715712 58.22690
 [9,] 2.137463 57.35173 1.566062 57.71150 1.693040 58.98128 3.745851 60.06059
[10,] 1.369225 55.02178 1.221770 55.54841 1.200705 56.87550 3.265075 57.88662
[11,] 0.462044 61.68287 0.378036 62.18692 1.176112 63.19502 4.053386 62.58596
[12,] 0.926024 55.37203 0.610334 55.85608 0.926024 57.09780 3.220038 57.72918
[13,] 2.220096 59.78071 2.058214 60.10447 2.127592 61.49203 4.393940 62.85647
[14,] 4.166919 52.76141 3.990852 53.21136 4.264734 54.07213 5.164632 54.50252
[15,] 2.322552 74.32166 1.681848 74.82889 2.215768 76.40395 4.965456 77.36501
[16,] 0.482724 54.98856 0.272844 55.49227 0.524700 56.81452 3.022272 57.63305
[17,] 4.716225 55.48377 4.527576 55.86107 4.527576 56.55278 5.743314 57.43314
[18,] 2.025273 62.80674 1.489856 63.36544 1.839041 64.78546 4.283336 65.83301
[19,] 0.710928 50.57463 0.572692 51.04858 0.829416 52.23346 2.784468 53.28010
[20,] 1.161832 56.84678 0.871374 57.19948 1.286314 58.36131 3.651472 59.00447
[21,] 3.884630 54.80478 3.569660 55.09875 3.548662 56.10666 5.291496 57.15656
[22,] 0.421060 61.11686 0.336848 61.58002 1.305286 62.52741 3.957964 62.61162
[23,] 1.882890 55.00131 1.694601 55.41973 1.799206 56.25657 3.640254 57.34446
[24,] 1.556220 57.26469 1.366950 57.79044 1.535190 58.73679 3.133470 59.49387
[25,] 3.876675 57.27002 3.583305 57.60530 3.604260 58.50636 5.196840 59.55411
[26,] 0.967886 56.74758 0.799558 57.33673 0.904763 58.51502 3.008863 59.20937
[27,] 0.924352 57.41486 0.630240 58.27619 0.861328 59.83078 3.361280 60.90219
[28,] 0.643500 56.49930 0.493350 56.99265 0.664950 58.25820 3.818100 59.56665
[29,] 2.291725 56.15777 2.018400 56.62032 2.060450 57.83977 4.205000 59.08025
[30,] 1.792905 57.26750 1.455417 57.49952 1.413231 58.51198 3.417066 59.65100
[31,] 2.315610 56.16407 1.978794 56.45878 2.084049 57.49028 4.189149 58.39547
[32,] 0.678720 61.63626 0.572670 62.16651 1.166550 63.16338 4.432890 63.26943
[33,] 2.358310 56.36987 2.024390 56.72466 2.087000 57.72642 3.881820 58.85340
[34,] 1.476019 55.67294 1.247340 55.75610 1.164184 56.75397 2.577836 57.81421
[35,] 1.283989 57.48482 1.094548 57.90580 1.305038 59.00035 3.388889 59.96860
[36,] 1.458798 56.93541 1.205094 57.29482 1.374230 58.20393 3.065590 59.45130
[37,] 1.915550 55.57200 1.789250 56.05615 1.768200 57.08760 3.178550 57.99275
[38,] 0.799140 58.27413 0.651930 58.77885 1.072530 60.12477 3.364800 60.73464
[39,] 2.363088 56.06004 2.088801 56.62972 2.236494 57.62137 4.198701 58.50753
[40,] 0.968346 56.77455 0.842040 57.34292 0.989397 58.33232 3.410262 59.30067
         [,17]    [,18]     [,19]    [,20]     [,21]    [,22]    [,23]    [,24]
 [1,] 6.290680 55.70900  8.874000 55.25544 10.747400 55.43292 14.39560 52.75100
 [2,] 6.219512 55.99529  8.758490 56.01497 10.903828 55.83783 14.03327 53.86963
 [3,] 7.520188 57.35701  9.846876 57.25314 11.986598 57.23237 14.74954 55.11342
 [4,] 6.865692 59.92258  9.763140 59.56565 11.883736 59.46067 15.36907 56.56322
 [5,] 9.068088 60.24718 11.420658 59.94776 12.768039 59.88360 15.84777 57.46687
 [6,] 5.382514 56.60116  7.861861 56.96141  9.663096 57.49118 13.13842 55.75352
 [7,] 6.642636 59.72066  8.849841 59.82577 10.951941 59.48943 13.57957 57.89183
 [8,] 7.241416 58.26912  9.774856 57.88910 11.949392 57.59354 15.43287 54.70119
 [9,] 7.110768 60.14525 10.073588 60.12408 11.787791 59.89129 15.13155 57.41522
[10,] 6.551215 58.05514  9.437120 57.97088 11.627880 57.52851 15.41958 55.08498
[11,] 6.993666 60.56977  9.765930 58.61658 11.803124 57.29346 15.01643 53.55510
[12,] 6.503214 57.11884  9.533838 56.46642 11.449024 56.48746 15.88973 54.13031
[13,] 7.932218 63.11085 11.216110 63.29586 13.228072 63.85089 18.50080 63.06460
[14,] 7.453503 54.32645  8.842476 54.34601  9.820626 54.26776 12.73551 53.48524
[15,] 9.396992 76.99126 12.280160 76.59082 14.389144 76.27047 19.48808 73.89453
[16,] 6.737148 57.27625  9.864360 56.98242 11.984148 56.45772 16.45459 54.75769
[17,] 8.405361 57.34930 10.124163 57.22353 11.738160 57.22353 14.48405 56.04971
[18,] 8.566672 65.55366 11.616221 64.92513 13.874284 64.76218 18.62320 62.87658
[19,] 6.516840 53.35910  9.419796 53.26036 11.098376 53.14187 15.81815 51.44354
[20,] 6.929498 59.08746  9.979307 58.65177 11.888031 58.77625 16.55611 56.95052
[21,] 8.294210 57.40853 10.519998 57.34554 13.732692 57.51352 15.95848 55.93867
[22,] 7.494868 60.90633 10.084387 59.05366 13.810768 56.90626 15.05289 53.24304
[23,] 6.673799 57.59551  9.016951 57.51183 11.883128 57.34446 14.10075 55.37789
[24,] 5.593980 59.51490  7.907280 59.22048 10.536030 59.17842 12.38667 57.43293
[25,] 7.858125 59.70080 10.142220 59.61698 12.824460 59.38647 15.10856 57.66816
[26,] 6.312300 58.97792  9.110753 58.28357 12.498354 57.84171 15.46514 55.56928
[27,] 7.016672 60.86018  9.936784 59.95683 14.180400 59.43163 17.01648 57.01571
[28,] 7.614750 59.48085 10.853700 58.92315 14.435850 58.53705 17.54610 56.11320
[29,] 7.758225 59.01717 10.449425 58.40745 13.645225 57.96592 15.83182 56.15777
[30,] 6.686481 59.54554  9.133269 58.80728 11.790987 58.51198 14.09012 56.74017
[31,] 7.431003 58.62703 10.314990 58.35337 13.809456 57.99551 15.93561 56.03776
[32,] 7.868910 61.44537 10.901940 59.30316 14.231910 57.26700 15.84387 53.95824
[33,] 7.575810 58.89514 10.205430 58.39426 13.440280 58.20643 16.13251 56.32813
[34,] 5.488296 57.98052  7.691930 57.54395 10.165821 57.39843 12.84760 55.79768
[35,] 7.114562 60.32643  9.787785 59.71601 12.945135 59.16874 15.23948 57.50587
[36,] 5.835192 59.85300  8.625936 59.64158 11.691526 59.76843 14.67255 57.88680
[37,] 6.315000 58.45585  8.777850 58.37165 11.977450 58.35060 14.46135 57.08760
[38,] 6.981960 60.27198 10.010280 59.28357 13.837740 58.88400 16.71885 56.08701
[39,] 7.532343 58.38093  9.916530 58.21214 12.638301 58.29654 15.33897 56.27103
[40,] 7.473105 58.92175  9.957123 58.26917 13.514742 57.72184 15.95666 55.59569
> 
> 
> 
> ### * <FOOTER>
> ###
> cleanEx()
> options(digits = 7L)
> base::cat("Time elapsed: ", proc.time() - base::get("ptime", pos = 'CheckExEnv'),"\n")
Time elapsed:  2.839 0.144 3.083 0.018 0.035 
> grDevices::dev.off()
null device 
          1 
> ###
> ### Local variables: ***
> ### mode: outline-minor ***
> ### outline-regexp: "\\(> \\)?### [*]+" ***
> ### End: ***
> quit('no')
